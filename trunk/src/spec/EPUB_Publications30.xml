<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="../../util/docbook/schema/docbookspec.rng" type="xml"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbookspec.sch"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbook.sch"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1b2">
    <title>EPUB Publications 3.0</title>

    <info>
        <releaseinfo>Editors Draft</releaseinfo>
        <pubdate>12 November 2010</pubdate>
        <printhistory>
            <formalpara>
                <title>This version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
            <formalpara>
                <title>Diffs to previous version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
        </printhistory>
        <copyright>
            <year>2010</year>
            <year>2011</year>
            <holder>International Digital Publishing Forumâ„¢</holder>
        </copyright>
        <legalnotice>
            <para>All rights reserved. This work is protected under Title 17 of the United States
                Code. Reproduction and dissemination of this work with changes is prohibited except
                with the written permission of the International Digital Publishing Forum.</para>
        </legalnotice>
        <authorgroup>
            <editor>
                <personname>Garth Conboy</personname>
                <affiliation>
                    <org>
                        <orgname>eBook Technologies</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>DAISY Consortium</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>William McCoy</personname>
                <affiliation>
                    <org>
                        <orgname>WebPaper LLC</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>
                    <remark role="todo">TBD - additional editors</remark>
                </personname>
            </editor>
        </authorgroup>
        <abstract>
            <title>EPUB Publications 3.0</title>
            <para>EPUB is an interchange and delivery format for digital publications based on XML
                and Web Standards. EPUB3, the third major revision of EPUB, is defined by <link
                    linkend="refEPUB3Overview">a set of specification documents</link> including
                this document, which defines publication-level semantics and conformance
                requirements for EPUB3.</para>
        </abstract>
    </info>

    <chapter xml:id="sec-overview">
        <title>Overview</title>
        <section xml:id="sec-overview-purpose-and-scope">
            <title>Purpose and Scope</title>
            <para>This document, EPUB Publications 3.0, defines publication-level semantics and
                conformance requirements for EPUB3, the third major revision of EPUB, an interchange
                and delivery format based on XML and Web Standards.</para>
            <para>This document is meant to be read and understood in concert with the other
                documents that make up EPUB3. The EPUB3 Overview <xref linkend="refEPUB3Overview"/>,
                which provides an informative overview of EPUB and a roadmap to the rest of the
                EPUB3 documents, should be read first.</para>
        </section>

        <section xml:id="sec-overview-relationships">
            <title>Relationship to Other Specifications</title>
            <para>This specification depends on other sibling specifications, as described in <xref
                    linkend="refEPUB3Overview"/>. Sibling specifications include EPUB Content
                Documents 3.0 <xref linkend="refContentDocs3"/>, Open Container Format 3.0 <xref
                    linkend="refOCF3"/>, and EPUB Media Overlays 3.0 <xref linkend="refOverlays3"/>. </para>

            <para>This specification defines constructs based on XML <xref linkend="refXML"/>, and
                by default all terminology used in this specification has the same meaning as its
                use in <xref linkend="refXML"/>. This specification also relies on XML Namespaces
                    <xref linkend="refXMLNamespaces"/>, and in this specification the term "XML
                namespace" (or just "namespace") has the meaning defined in that
                specification.</para>

            <para>EPUB Publications 3.0 is a revision to, and supersedes, Open Package Format 2.0.1
                    <xref linkend="refOPF2"/>.</para>

            <para>
                <remark role="todo">
                    <remark role="todo"> TBD: enumerate other dependent specs </remark>
                </remark>
            </para>
        </section>

        <section xml:id="sec-overview-terminology">
            <title>Terminology</title>
            <glosslist>

                <glossentry xml:id="gloss-epub-publication" xreflabel="EPUB Publication">
                    <glossterm>EPUB Publication (or Publication)</glossterm>
                    <glossdef>
                        <para>A logical document entity consisting of a set of interrelated
                            resources, as defined by this specification and its <link
                                linkend="refEPUB3Overview">sibling specifications</link>.</para>
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-epub-file" xreflabel="EPUB File">
                    <glossterm>EPUB File</glossterm>
                    <glossdef>
                        <para>An EPUB Publication packaged in a container, as defined in <xref
                                linkend="refOCF3"/>.</para>
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-package-document" xreflabel="Package Document">
                    <glossterm>Package Document</glossterm>
                    <glossdef>
                        <para>A document carrying bibliographical and structural metadata about the
                            EPUB Publication, as defined in <xref linkend="sec-package-documents"
                            />.</para>
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-content-document" xreflabel="EPUB Content Document">
                    <glossterm>EPUB Content Document (or Content Document)</glossterm>
                    <glossdef>
                        <para>A document carrying all or parts of the Publication content, as
                            defined in <xref linkend="refContentDocs3"/>.</para>
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-extended-content-document-reference"
                    xreflabel="Extended Content Document Reference">
                    <!-- TODO this is perhaps too detailed for a high level glossary -->
                    <glossterm>Extended Content Document Reference</glossterm>
                    <glossdef>
                        <para>An item in the Package File manifest that either a) refers to an <xref
                                linkend="gloss-content-document"/>, or b) includes an <xref
                                linkend="gloss-content-document"/> in its fallback chain.</para>
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-publication-resource" xreflabel="Publication Resource">
                    <glossterm>Publication Resource (or Resource)</glossterm>
                    <glossdef>
                        <para>A resource that is a logical part of the EPUB Publication. In the
                            absence of this resource, the Publication can not be rendered as
                            intended by the author.
                            <!-- Publication resources
                            are listed in the <xref linkend="sec-manifest-elem"/>.--></para>
                        <!-- <glossseealso otherterm="gloss-external-resource"/> -->
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-external-resource" xreflabel="External Resource">
                    <glossterm>External Resource</glossterm>
                    <glossdef>
                        <para>A resource that is referenced from within an EPUB Publication, but not
                            considered a logical part of the Publication.
                            <!-- External resources
                            are not listed in the <xref linkend="sec-manifest-elem"/>.--></para>
                        <!-- <glossseealso otherterm="gloss-publication-resource"/> -->
                    </glossdef>
                </glossentry>

                <glossentry xml:id="gloss-epub-reading-system" xreflabel="EPUB Reading System">
                    <glossterm>EPUB Reading System (or Reading System)</glossterm>
                    <glossdef>
                        <para>A system that processes <xref linkend="gloss-epub-publication"/>s for
                            presentation to end users in a manner conformant with this specification
                            and its <link linkend="refEPUB3Overview">sibling
                            specifications</link>.</para>
                        <para> A conforming Reading System is not necessarily a single dedicated
                            program or device, but may exist as a distributed system. A wide variety
                            of legitimate presentations of Publications by Reading Systems are
                            contemplated by the EPUB3 specification suite.</para>
                    </glossdef>
                </glossentry>



            </glosslist>
        </section>

        <section xml:id="sec-overview-conformance">
            <title>Conformance</title>
            <xi:include href="./share/conformancestatements.xml"/>
        </section>

    </chapter>

    <chapter xml:id="sec-epub-introduction" conformance="informative">
        <title>Introduction</title>

        <para>EPUB is an interchange and delivery format for digital publications, based on XML and
            Web Standards. An EPUB Publication can be thought of as a a reliable packaging of Web
            content that represents a digital book, magazine, or other type of publication, with a
            declarative means to navigate through the content, and the ability to be distributed
            reliably for online and offline consumption. </para>

        <para>This specification defines the semantics and conformance requirements for EPUB at the
            publication level. It defines the formats of the <link linkend="sec-package-documents"
                >Package</link> and <link linkend="sec-ncx">NCX</link> documents, as well as rules
            for how these documents and other Publication resources are associated to create a
            conforming EPUB Publication. This specification also defines rules for how EPUB
            Publications are processed by conforming Reading Systems.</para>

        <!-- TODO
The individual resources that constitute an EPUB Publication
are defined by other specifications. -->

        <!--
        <para>; a fully-packaged EPUB Publication consists of at minimum four files (e.g.,
                <filename>container.xml</filename>, <filename>manifest.opf</filename>,
                <filename>nav.ncx</filename>, and <filename>content.xhtml</filename>), defined
            according to the rules of this and other specifications (including <xref
                linkend="refOCF3"/>, and <xref linkend="refContentDocs3"/>). This specification
            defines the formats of the OPF and NCX files, as well as additional rules for how these
            files and other optional files are tied together to create valid and conforming EPUB
            Publications, and for how such Publications are processed by conforming Reading
            Systems.</para>
-->
    </chapter>

    <chapter xml:id="sec-epub-publications-overview">
        <title>EPUB Publications</title>
        <para>This section describes the high-level content and Reading System conformance
            requirements for EPUB Publications. The sections following this one describe more
            specifically the requirements for Package Documents, NCX Documents, and Core Media
            Types.</para>
        <section xml:id="sec-epub-content-conformance">
            <title>Publication Content Conformance</title>

            <para>A EPUB Publication minimally consists of the following Publication
                Resources:</para>

            <itemizedlist>
                <listitem>
                    <para>Exactly one Package Document, conformant to the requirements defined in
                            <xref linkend="sec-package-content-conf"/></para>
                </listitem>
                <listitem>
                    <para>Exactly one NCX Document, conformant to the requirements defined in <xref
                            linkend="sec-ncx-content-conf"/></para>
                </listitem>
                <listitem>
                    <para>One or more EPUB Content Documents, conformant to the requirements defined
                        for EPUB Content Documents in <xref linkend="refContentDocs3"/></para>
                </listitem>
                <listitem>
                    <para>Zero or more EPUB Style Sheets, conformant to the content conformance
                        requirements defined for EPUB Style Sheets in <xref
                            linkend="refContentDocs3"/></para>
                </listitem>
                <listitem>
                    <para>Zero or more Media Overlay Documents, conformant to the content
                        conformance requirements defined in <xref linkend="refOverlays3"/></para>
                </listitem>
                <listitem>
                    <para>Zero or more additional resources, with content conformance requirements
                        inferred from their media type unless explicitly specified differently by
                        this specification or one of its <link linkend="refEPUB3Overview">sibling
                            specifications</link>.</para>
                </listitem>
            </itemizedlist>
            <!--
            <para>As defined in <xref linkend="sec-manifest-elem"/>, all Publication Resources
                as listed above, except the Package Document itself, must be referenced from the Package
                Document <code>manifest</code>, unless the resource type is explicitly declared to
                be <link linkend="list-external-resources">external</link>.</para>

            <para>When a Publication Resource is not a <link linkend="sec-core-media-types">Core
                    Media Type</link>, a fallback must be provided for it, as defined in <xref
                    linkend="sec-fallbacks"/>.</para>
-->
            <para>An EPUB Publication is instantiated as an EPUB File, i.e. in a ZIP container
                conformant with the requirements in <xref linkend="refOCF3"/>.</para>

        </section>

        <section xml:id="sec-epub-reading-system-conformance">
            <title>Publication Reading System Conformance</title>
            <para><remark role="TODO">TODO this needs work - explicit links</remark></para>

            <para>In addition to conforming with the requirements specific to this specification, an
                EPUB Reading System must necessarily also be a conforming User Agent according to
                    <xref linkend="refContentDocs3"/> and a conforming OCF Processor according to
                    <xref linkend="refOCF3"/>. An EPUB Reading System must also, if it supports
                Media Overlays, be a confoming Media Overlay Processor according to <xref
                    linkend="refOverlays3"/>.</para>

            <para role="rsconf">EPUB Reading Systems conformant with this Publications 3.0
                specification should also be conformant processors of EPUB version 2 publications,
                as defined by <xref linkend="refOPF2"/>, <xref linkend="refOPS2"/>, and <xref
                    linkend="refOCF2"/>, and must at a minimum attempt to process any publication
                whose Package Document designates a version other than "3.0" or which omits the
                version attribute, as if such publication had designated a version "3.0"; provided,
                however, that Reading Systems must in this situation ignore the presence of removed
                constructs including <code>ops:switch</code> in Content Documents and
                    <code>@fallback-style</code> in manifest items.</para>

            <para><remark role="todo">TODO add link to W3C XML Processors draft
                    (http://www.w3.org/TR/xml-proc-profiles/#profiles), alternatively extract and
                    echo the relevant items.</remark></para>
        </section>
    </chapter>

    <chapter xml:id="sec-package-documents">
        <title>Package Documents</title>
        <section xml:id="sec-opf-intro" conformance="informative">
            <title>Introduction</title>
            <para>The fundamental publication-level construct of an EPUB Publication is the Package
                Document. The Package Document provides central information about the publication as
                a whole, and about the individual resources that comprise the publication:</para>
            <itemizedlist>
                <listitem>
                    <para>Publication <link linkend="sec-metadata-elem">metadata</link> - mechanisms
                        for including and/or referencing metadata applicable to the entire
                        Publication and particular resources within it.</para>
                </listitem>
                <listitem>
                    <para>A <link linkend="sec-manifest-elem">Publication manifest</link>, which
                        identifies (via URI) and describes (via MIME type) the set of resources that
                        collectively comprise the Publication.</para>
                </listitem>
                <listitem>
                    <para>A <link linkend="sec-spine-elem">spine</link> - an ordered sequence of id
                        references to top-level resources in the manifest, from which all other
                        resources in the set can be reached or utilized. The spine defines the
                        default "reading order" of the publication.</para>
                </listitem>
                <listitem>
                    <para>Navigation - a publication-wide <link linkend="sec-ncx">declarative
                            navigation</link> layer.</para>
                </listitem>
                <listitem>
                    <para><link linkend="sec-fallbacks">Fallback chains</link> - an optional means
                        for publications to define an ordered list of items that can be considered
                        informational equivalents, that a Reading System can choose between in
                        rendering content</para>
                </listitem>
                <listitem>
                    <para><link linkend="sec-bindings-elem">Bindings</link> - an optional means of
                        associating script-based implementations with custom media types.</para>
                </listitem>
            </itemizedlist>
            <!--
            <example>
                <title>Package Logic Overview</title>
                <remark role="todo">TODO DIAGRAM: show visual graph of abstract "hedge" here, inc
                    fallback chains and sharing resources between roots.</remark>
            </example>
            -->
        </section>
        <section xml:id="sec-package-content-conf">
            <title>Package Document Content Conformance</title>

            <simplelist role="conformance-list">
                <member role="conformance-item">A Package Document must be a well-formed XML
                    Document <xref linkend="refXML"/>.</member>
                <member role="conformance-item">A Package Document must be encoded in UTF-8 or
                    UTF-16 <xref linkend="refUnicode5"/>.</member>
                <member role="conformance-item">A Package Document must be valid to the Package
                    Document schema as defined in <xref linkend="app-package-schema"/>, and in
                    addition must conform to all content conformance constraints expressed in <xref
                        linkend="sec-package-def"/>.</member>
                <member role="conformance-item">The Package Document filename should use the file
                    extension <filename>.opf</filename>. Any document fragments (included via
                    external entities <xref linkend="refXML"/> or XInclude <xref
                        linkend="refXInclude"/>) should not use the <filename>.opf</filename>
                    extension. <remark role="todo">TODO check this - are RSs required to support
                        external entites and/or XInclude?</remark>
                </member>
            </simplelist>

        </section>

        <section xml:id="sec-package-def">
            <title>Package Document Definition</title>

            <para>In the following section and its subsections, all elements defined are in the
                    <literal>http://www.idpf.org/2007/opf</literal> namespace unless otherwise
                specified.</para>

            <section xml:id="sec-package-elem">
                <title>The <literal>package</literal> Element</title>

                <variablelist xreflabel="package" role="elem-synopsis" xml:id="elemdef-opf-package">
                    <varlistentry>
                        <term>Element Name</term>
                        <listitem>
                            <para><literal>package</literal></para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>The <literal>package</literal> element is the root element of the
                                Package Document.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <variablelist role="elem-synopsis-attlist">
                                <varlistentry xml:id="attrdef-version-package" xreflabel="version">
                                    <term><literal>version</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>Specifies the EPUB specification version to which the
                                            publication adheres.</para>
                                        <para>In this version of this specification, this attribute
                                            must have the value <literal>3.0</literal>.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry xml:id="attrdef-unique-identifier"
                                    xreflabel="unique-identifier">
                                    <term><literal>unique-identifier</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>Identifies via an IDREF <xref linkend="refXML"/> the
                                                  <literal><xref linkend="sec-opf-dcidentifier"
                                                /></literal> element that provides the package's
                                            preferred, or primary, identifier.</para>
                                        <para>Refer to <xref linkend="sec-metadata-identifiers"/>
                                            for details.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry xml:id="attrdef-package-profile" xreflabel="profile">
                                    <term><literal>profile</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>Specifies the URI of the metadata profile <xref
                                                linkend="refRDFa11Core"/> for the Package Document. </para>
                                        <para>In this version of this specification, the value of
                                            this attribute must have the value
                                                <literal>http://www.idpf.org/TODO</literal>.</para>
                                        <para>Refer to <xref linkend="sec-metadata-elem"/> for
                                            details.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry xml:id="attrdef-package-prefix" xreflabel="prefix">
                                    <term><literal>prefix</literal>
                                        <option>[optional]</option></term>
                                    <listitem>
                                        <para>Specifies metadata prefix values additional to those
                                            defined via the <code>package</code> element <xref
                                                linkend="attrdef-package-profile"/> attribute <xref
                                                linkend="refRDFa11Core"/>.</para>
                                        <para>Refer to <xref linkend="sec-metadata-elem"/> for
                                            details.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><literal>xml:lang</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <xi:include href="./share/xmllang-prose-para.xml"/>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><literal>dir</literal>
                                        <option>[optional]</option></term>
                                    <xi:include href="./share/dir-prose-listitem.xml"/>
                                </varlistentry>
                                <varlistentry>
                                    <term><literal>id</literal>
                                        <option>[optional]</option></term>
                                    <listitem>
                                        <xi:include href="./share/id-prose-para.xml"/>
                                    </listitem>
                                </varlistentry>
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>In this order: <literal><xref linkend="elemdef-opf-metadata"
                                    /></literal>
                                <option>[required]</option>, <literal><xref
                                        linkend="elemdef-opf-manifest"/></literal>
                                <option>[required]</option>, <literal><xref
                                        linkend="elemdef-opf-spine"/></literal>
                                <option>[required]</option>, <literal><xref
                                        linkend="elemdef-opf-guide"/></literal>
                                <option>[optional/deprecated]</option>, <literal><xref
                                        linkend="elemdef-opf-bindings"/></literal>
                                <option>[optional]</option></para>
                        </listitem>
                    </varlistentry>

                </variablelist>

            </section>

            <xi:include href="./sections/EPUB_Publications30-metadata.xml"/>

            <section xml:id="sec-manifest-elem">
                <title>The <literal>manifest</literal> Element</title>

                <para>The <literal>manifest</literal> element, through its <code><link
                            linkend="sec-item-elem">item</link></code> element children, provides an
                    exhaustive list of the <link linkend="gloss-publication-resource">Publication
                        Resources</link> that constitute the Publication.</para>

                <variablelist xreflabel="manifest" role="elem-synopsis"
                    xml:id="elemdef-opf-manifest">
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Required second child of <xref linkend="elemdef-opf-package"/>,
                                following <xref linkend="elemdef-opf-metadata"/>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <variablelist role="elem-synopsis-attlist">
                                <varlistentry xml:id="attrdef-manifest-id" xreflabel="id">
                                    <term><literal>id</literal>
                                        <option>[optional]</option></term>
                                    <listitem>
                                        <xi:include href="./share/id-prose-para.xml"/>
                                    </listitem>
                                </varlistentry>
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>Multiple <literal><xref linkend="elemdef-opf-item"/></literal>
                                <option>[required]</option></para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <para>Any given resource is a Publication Resource if it contains content or
                    instructions that contribute, directly or indirectly, to the rendering of the
                    Publication (e.g. Content Documents, Style Sheets, audio, video, images,
                    embedded fonts, scripts).</para>

                <para>All Publication Resources must be referenced from the <code>manifest</code>
                    regardless of their physical location, i.e. regardless of whether they are
                    available in the <link linkend="refOCF3">container</link> or remotely. Refer to
                        <xref linkend="sec-resource-locations"/> for media type specific
                    requirements regarding resource locations.</para>
                <!--
                <para>The following list defines the resource types that constitute a Publication
                    and therefore must be referenced from the manifest:</para>

                <itemizedlist xml:id="sec-manifest-reqd-items">
                    <listitem>
                        <para>All <xref linkend="gloss-content-document"/>s and/or <xref
                                linkend="gloss-extended-content-document-reference"/>s that are part
                            of the publication; minimally one.</para>
                    </listitem>
                    <listitem>
                        <para>All embedded resources (such as images, audio, video, stylesheets,
                            fonts, document fragments) referenced from within <xref
                                linkend="gloss-content-document"/>s and/or <xref
                                linkend="gloss-extended-content-document-reference"/>s,
                            recursively.</para>
                    </listitem>
                    <listitem>
                        <para>In the context of an <xref
                                linkend="gloss-extended-content-document-reference"/>, any DTDs and
                            DTD fragments, recursively. <remark role="todo">TODO revisit - are RSs
                                required to support DTDs?</remark></para>
                    </listitem>
                    <listitem>
                        <para>The <link linkend="sec-ncx">NCX.</link></para>
                    </listitem>
                    <listitem>
                        <para>If <link linkend="refOverlays3">Media Overlays</link> are used, all
                            Media Overlay Documents and the media resources referenced from
                            them.</para>
                    </listitem>
                    <listitem>
                        <para>For each <literal>item</literal> that is not a <link
                                linkend="sec-core-media-types">Core Media Type</link>, <link
                                linkend="sec-fallbacks">fallback items</link>. <remark role="todo"
                                >TODO needs to integrate with <xref
                                    linkend="sec-fallback-processing-flow"/></remark></para>
                    </listitem>
                </itemizedlist>
-->

                <para>This specification and its sibling specifications may explicitly define
                    certain resource types to be <link linkend="gloss-external-resource"
                        >external</link>, thereby declaring that the resource is not a Publication
                    Resource. Examples of such external resources include resources referenced from
                    the Package Document metadata <xref linkend="sec-opf-link"/> element.</para>

                <para>The manifest is not self-referencing: it must not include
                        <literal>item</literal> elements referring to the resource or resources that
                    make up the Package Document itself.</para>

                <para>The order of <literal>item</literal> elements in the manifest is not
                    significant. The presentation sequence of Content Documents is provided in <link
                        linkend="sec-spine-elem"><literal>spine</literal></link>.</para>

                <section xml:id="sec-item-elem" xreflabel="item">
                    <title>The <literal>item</literal> element</title>
                    <variablelist xreflabel="item" role="elem-synopsis" xml:id="elemdef-opf-item">
                        <varlistentry>
                            <term>Element Name</term>
                            <listitem>
                                <para><literal>item</literal></para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Occurrence</term>
                            <listitem>
                                <para>As a child of <xref linkend="elemdef-opf-manifest"/>.
                                    Repeatable.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attributes</term>
                            <listitem>
                                <variablelist role="elem-synopsis-attlist">
                                    <varlistentry xml:id="attrdef-item-id" xreflabel="id">
                                        <term><literal>id</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <xi:include href="share/id-prose-para.xml"/>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-item-href" xreflabel="href">
                                        <term><literal>href</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>Specifies the URI of the resource described by
                                                this <literal>item</literal> element.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-item-media-type"
                                        xreflabel="media-type">
                                        <term><literal>media-type</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>Identifies the MIME media type <remark role="todo"
                                                  >TODO MIME ref</remark> of the resource described
                                                by this <literal>item</literal> element.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-item-fallback"
                                        xreflabel="fallback">
                                        <term><literal>fallback</literal>
                                            <option>[conditionally required]</option></term>
                                        <listitem>
                                            <para>Specifies via IDREF <xref linkend="refXML"/> a
                                                fallback for a non-Core Media Type. Refer to <xref
                                                  linkend="sec-fallbacks"/> for details.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xreflabel="property">
                                        <term><literal>property</literal>
                                            <option>[optional]</option></term>
                                        <listitem>
                                            <para>Specifies metadata for the given
                                                  <literal>item</literal>. Refer to <xref
                                                  linkend="elemdef-opf-item-property-values"
                                                />.</para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>Empty.</para>
                            </listitem>
                        </varlistentry>

                    </variablelist>

                    <para>The URI provided in the <literal>item</literal> element
                            <literal>href</literal> attribute may be relative, and is in this case
                        resolved to an absolute URI using the URI of the Package Document as the
                        base. The resulting absolute URI must be unique within the
                            <literal>manifest</literal> scope.</para>

                    <para>The resource identified by an item must conform to the applicable
                        specification(s) as inferred from the MIME Type provided in the
                            <literal>item</literal> element <literal>media-type</literal>
                        attribute.</para>

                    <section xml:id="sec-fallbacks">
                        <title>Item Fallbacks</title>


                        <para>Each item in the manifest whose <xref
                                linkend="attrdef-item-media-type"/> value is not one of the <link
                                linkend="sec-core-media-types">EPUB3 Core Media Types</link> must
                            use the <xref linkend="attrdef-item-fallback"/> attribute to specify a
                            fallback chain that includes at least one <xref
                                linkend="elemdef-opf-item"/> whose <xref
                                linkend="attrdef-item-media-type"/> is an EPUB3 Core Media
                            Type.</para>

                        <para>The <literal>fallback</literal> attribute IDREF <xref linkend="refXML"
                            /> value must resolve to another <literal>item</literal> in the
                                <literal>manifest</literal>. The ordered list of all ID references
                            that can be reached starting from a given item's
                                <literal>fallback</literal> attribute is considered to be the
                            "fallback chain" for that item. There must not be any circular
                            references in fallback chains.</para>
                        <para>The general rule for processing manifest-level fallbacks is that a
                            Reading System that does not support the Media Type of a given item must
                            traverse the fallback chain until it encounters a supported Media Type.
                            The resource identified by the fallback item is then used in place of
                            the unsupported item. It is legal to have a fallback attribute on an
                            item of a Core Media Type and a Reading System may choose to "fall over"
                            such references in order to find the optimal version of a resource to
                            render in a given context. </para>

                        <para>However, Reading Systems process fallbacks differently depending on
                            the context where a reference to a resources occurs in Content
                            Documents, in conjunction with the intrinstic fallback mechanisms
                            defined in <xref linkend="refHTML5"/> and <xref linkend="refSVG"/> .
                                <xref linkend="sec-fallback-processing-flow"/> defines the overall
                            processing flow for handling fallbacks.</para>

                        <!--
                        
-->

                        <!-- TODO, reintroduce perhaps, but where? NOte that "all external resources must be
                            referenced by absolute URIs" is not true: <link meta records can be relative
                            
                            As well, in EPUB Publications there must not be
                            any relative URI references of any kind to external files from any item
                            (nor via any URI referencing mechanism, including script, in any Content
                            Document or other content files): i.e. the manifest must include all
                            resources that are considered part of the publication itself and
                            referenced in a relative manner, and all external resources must be
                            referenced by absolute URIs. 
                        -->
                    </section>
                    <section xml:id="elemdef-opf-item-property-values">
                        <title>Recognized values for the <literal>item</literal> element
                                <literal>property</literal> attribute</title>
                        <para><remark role="todo">TODO complete as per <link
                                    xlink:href="http://code.google.com/p/epub-revision/wiki/ImplementationProposalsMetadata"
                                    >ImplementationProposalsMetadata</link></remark></para>
                        <para><remark role="todo">TODO This might better live in <xref
                                    linkend="sec-content-definitions"/></remark>?</para>

                    </section>
                </section>

                <section xml:id="sec-resource-locations">
                    <title>Publication Resource Locations</title>

                    <para>All <link linkend="gloss-publication-resource">Publication
                            Resources</link> must be located in the <link linkend="refOCF3"
                            >container</link>, with the exceptions listed below.</para>

                    <para><remark role="todo">TODO below, reference media types table (which would
                            ideally be a categorized table)</remark></para>
                    <itemizedlist>
                        <listitem>
                            <para>Audio resources, as referenced from Content Documents or Media
                                Overlay documents, may be located in the container or
                                remotely</para>
                        </listitem>
                        <listitem>
                            <para>Video resources, as referenced from Content Documents, may be
                                located in the container or remotely</para>
                        </listitem>
                    </itemizedlist>

                    <para>When remote audio and video resources are included in the publication, the
                            <literal>online</literal> metadata property must be used... <remark
                            role="todo">TODO @DanH add link to the <literal>online</literal> meta
                            property here when it has been added, and describe that it must be set
                            on any content doc or media overlay that contains online resources as
                            per the list above.</remark></para>

                    <para>Content providers should prefer locating audio and video resorces in the
                        container to allow the user access to the entire presentation regardless of
                        connectivity status.</para>

                </section>
                <section xml:id="examples-manifest">
                    <title>The <literal>manifest</literal> Element: Examples</title>
                    <informalexample xml:id="example-manifest-1">
                        <para>The following example shows a <literal>manifest</literal> that only
                            contain <literal>item</literal>s that are Core Media Types.</para>
                        <synopsis>
<xi:include href="./examples/publications/manifest-1.xml" parse="text"/></synopsis>
                    </informalexample>
                    <informalexample>
                        <para>The following example shows a <literal>manifest</literal> that
                            contains two <literal>item</literal>s that are not Core Media Types, and
                            therefore uses the <link linkend="sec-fallbacks">fallback chain
                                mechanism</link> to supply content alternatives. The fallback chain
                            terminates with a Core Media Type. </para>
                        <synopsis>
<xi:include href="./examples/publications/manifest-2.xml" parse="text"/></synopsis>
                    </informalexample>
                </section>

            </section>
            <section xml:id="sec-spine-elem">
                <title>The <literal>spine</literal> element</title>

                <para>The <literal>spine</literal> element defines the default reading order of the
                    Publication content.</para>

                <variablelist xreflabel="spine" role="elem-synopsis" xml:id="elemdef-opf-spine">
                    <varlistentry>
                        <term>Element name</term>
                        <listitem>
                            <para><literal>spine</literal></para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Third child of <xref linkend="elemdef-opf-package"/>, following
                                    <xref linkend="elemdef-opf-manifest"/>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <variablelist role="elem-synopsis-attlist">
                                <varlistentry xml:id="attrdef-spine-id">
                                    <term><literal>id</literal>
                                        <option>[optional]</option></term>
                                    <listitem>
                                        <xi:include href="./share/id-prose-para.xml"/>
                                    </listitem>
                                </varlistentry>
                                <varlistentry xml:id="attrdef-spine-toc">
                                    <term><literal>toc</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>An IDREF <xref linkend="refXML"/> to the manifest
                                                <xref linkend="elemdef-opf-item"/> that represents
                                            the <link linkend="sec-ncx">NCX</link></para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para><literal><xref linkend="elemdef-spine-itemref"/></literal>
                                <option>[required]</option></para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <para>The <literal>spine</literal> elements <xref linkend="elemdef-spine-itemref"/>
                    children is a list of <xref linkend="gloss-extended-content-document-reference"
                    />s. The order in which the <literal>itemref</literal> elements appear defines
                    the default reading order of the Publication.</para>

                <section xml:id="sec-itemref-elem" xreflabel="itemref">
                    <title>The <literal>itemref</literal> element</title>
                    <variablelist xreflabel="itemref" role="elem-synopsis"
                        xml:id="elemdef-spine-itemref">
                        <varlistentry>
                            <term>Element Name</term>
                            <listitem>
                                <para><literal>itemref</literal></para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Occurrence</term>
                            <listitem>
                                <para>As a child of <xref linkend="elemdef-opf-spine"/>.
                                    Repeatable.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attributes</term>
                            <listitem>
                                <variablelist role="elem-synopsis-attlist">
                                    <varlistentry xml:id="attrdef-itemref-idref" xreflabel="idref">
                                        <term><literal>idref</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>Identifies via an IDREF <xref linkend="refXML"/> a
                                                manifest <xref linkend="elemdef-opf-item"/>
                                                element.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-itemref-linear">
                                        <term><literal>linear</literal>
                                            <option>[optional]</option></term>
                                        <listitem>
                                            <para>Specifies whether the referenced content is
                                                primary. Value must be <literal>yes</literal> or
                                                  <literal>no</literal>.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-itemref-id">
                                        <term><literal>id</literal>
                                            <option>[optional]</option></term>
                                        <listitem>
                                            <xi:include href="./share/id-prose-para.xml"/>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry>
                                        <term><literal>property</literal>
                                            <option>[optional]</option></term>
                                        <listitem>
                                            <para>
                                                <remark role="todo">TODO</remark>
                                            </para>

                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>Empty.</para>
                            </listitem>
                        </varlistentry>

                    </variablelist>

                    <para>Each <literal>itemref</literal> element must (via the <xref
                            linkend="attrdef-itemref-idref"/> attribute) reference an item in the
                        manifest. Consequently, the <literal>spine</literal> represents an ordered
                        list of a subset of the <literal>item</literal>s in the manifest, with
                        content items not being referenced from the <literal>spine</literal> being
                        ancillary to those that do appear there. </para>

                    <para>Each <literal>item</literal> referenced via <literal>itemref</literal>
                        must be an <xref linkend="gloss-extended-content-document-reference"/>. Note
                        that in general such references should resolve to XHTML Content Documents
                        rather than SVG Content Documents, unless a) such use is within a
                        Publication that is packaged together with, and as an alternative
                        non-default representation of, another Publication that represents
                        effectively the same content utilizing XHTML Content Documents or b) the
                        nature of the content being represented via SVG is inherently unsuitable to
                        representation in XHTML.</para>

                    <para>The <literal>itemref</literal> element's <literal>linear</literal>
                        attribute indicates whether a spine item is considered primary
                            (<literal>linear='yes'</literal>) or auxiliary
                            (<literal>linear='no'</literal>).The default value of
                            <literal>linear</literal> is <literal>yes</literal>. This may be used to
                        enable Reading Systems to distinguish presentation of "body" content from
                        ancillary content which might be, for example, presented in a popup window,
                        or omitted from an aural rendition. </para>

                    <para>Reading Systems must provide a means to render a Publication in the order
                        defined by the <literal>spine</literal>. Reading Systems must as part of
                        this means a) recognize the first primary (<literal>linear='yes'</literal>)
                        item in spine to be the beginning of the main reading order of the
                        publication, and b) render successive primary items in the order given in
                        spine.</para>
                    <para>The vocabulary defined for the <literal>property</literal> attribute of
                        the <literal>itemref</literal> element includes the values
                            <literal>left</literal> and <literal>right</literal> which specify the
                        desired placement of a single-page rendering of that item. This is intended
                        to facilitate representation of two-page "spreads". <remark role="todo"
                            >TODO: this can be listed with the rest of the defined vocabulary;
                            describe interaction with page-progression-direction; finalize
                            names</remark></para>
                </section>
                <section xml:id="examples-spine">
                    <title>The <literal>spine</literal> Element: Examples</title>
                    <informalexample>
                        <para>The following example shows a <literal>spine</literal> element
                            corresponding to <link linkend="example-manifest-1">the manifest example
                                above</link>.</para>
                        <synopsis>
<xi:include href="./examples/publications/spine-1.xml" parse="text"/></synopsis>
                    </informalexample>
                </section>
            </section>
            <section xml:id="sec-guide-elem">
                <title>The <literal>guide</literal> element [DEPRECATED]</title>
                <para><remark role="todo">TODO point to the NCX section that provides the new
                        approach to this</remark></para>
                <variablelist xreflabel="guide" role="elem-synopsis" xml:id="elemdef-opf-guide">
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Fourth child of <xref linkend="elemdef-opf-package"/>, following
                                    <xref linkend="elemdef-opf-spine"/>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <para>None.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>One or more <literal><xref linkend="elemdef-reference"/></literal>
                                <option>[required]</option></para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <para role="contentconf">The package element may contain one
                        <literal>guide</literal> element, which if present must contain one or more
                        <literal>reference</literal> elements. Each reference must have an
                        <literal>href</literal> attribute, which may include a fragment identifier
                    as defined in section 4.1 of <xref linkend="refRFC2396"/>. Each reference must
                    further have <literal>type</literal> and <literal>title</literal> attributes
                    whose values must be strings. </para>
                <para role="epubconf">In the context of EPUB, the href attribute of each reference
                    element must resolve to or within a resource that is represented by an Extended
                    Content Document Reference, with each type atttribute conforming to the
                    requirements of <xref linkend="sec-structural-semantics-vocab"/> of this
                    document . </para>
                <para role="rsconf">Reading Systems may provide a means to navigate a Publication
                    based on the information in its optional Guide.</para>
                <para>Note that <code>guide</code> has been deprecated, as the required NCX provides
                    a superset of its functionality. The primary use case for a publication to
                    include a guide would be to support older version Reading Systems that may not
                    support NCX.</para>
                <para>
                    <remark role="todo">TODO: Guide example from OPF2</remark></para>
                <section xml:id="sec-guide-reference" xreflabel="reference">
                    <title>The <literal>reference</literal> element</title>
                    <variablelist xreflabel="item" role="elem-synopsis" xml:id="elemdef-reference">
                        <varlistentry>
                            <term>Element Name</term>
                            <listitem>
                                <para><literal>reference</literal></para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Occurrence</term>
                            <listitem>
                                <para>As a child of <xref linkend="elemdef-opf-guide"/>.
                                    Repeatable.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attributes</term>
                            <listitem>
                                <variablelist role="elem-synopsis-attlist">
                                    <varlistentry xml:id="attrdef-reference-href" xreflabel="href">
                                        <term><literal>href</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>Specifies the URI of the destination of the
                                                reference. May contain a fragment identifier.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-reference-type" xreflabel="type">
                                        <term><literal>type</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>Text string describing the type of the reference,
                                                as further detailed in <xref
                                                  linkend="sec-structural-semantics-vocab"/>.
                                            </para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry>
                                        <term><literal>title</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para> Text string title for the reference. </para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>Empty.</para>
                            </listitem>
                        </varlistentry>

                    </variablelist>

                </section>

            </section>
            <section xml:id="sec-bindings-elem">
                <title>The <literal>bindings</literal> element</title>
                <variablelist xreflabel="bindings" role="elem-synopsis"
                    xml:id="elemdef-opf-bindings">
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Fourth or fifth child of <xref linkend="elemdef-opf-package"/>,
                                following <xref linkend="elemdef-opf-spine"/> or <xref
                                    linkend="elemdef-opf-guide"/>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <para>None.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>One or several <literal><xref linkend="elemdef-mediaType"
                                    /></literal>
                                <option>[required]</option></para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <para role="contentconf">The package element may contain at most one
                        <literal>bindings</literal> element, which contains one or more
                        <literal>mediaType</literal> elements, each of which associates a custom
                    media type with a "handler" that provides a default script-based implementation
                    for items of that media type when they are referenced from <code>object</code>
                    elements in XHTML Content Documents. </para>
                <para role="contentconf"> Each <literal>mediaType</literal> element must uniquely
                    designate, via its required <literal>media-type</literal> attribute, a unique
                    content type, which must not be a Core Media Type, and must reference, via its
                    required <code>handler</code> attribute, the id in the manifest of the default
                    implementation for this media type, which must be an XHTML Content Document. </para>
                <para role="rsconf">Reading Systems that support scripting must utilize the bindings
                    element, if present in a Publication, to handle object element references whose
                    MIME media type is not natively supported by the Reading System. The processing
                    model is to instantiate for such references the designated XHTML Content
                    Document handler (which would typically include scripting) as if it had been
                    referenced from the object element's <code>data</code> attribute, but with URL
                    parameters (which go after '?' in a URL) of <itemizedlist>
                        <listitem>
                            <para><code>src</code> - URI to the resource (value of the data
                                attribute in the object element) </para>
                        </listitem>
                        <listitem>
                            <para><code>type</code> - resource media type (value of the type
                                attribute in the object element)</para>
                        </listitem>
                    </itemizedlist></para>
                <para>Any <code>param</code> children of the object element are encoded as URL
                    parameters in the same manner; e.g. for:</para>
                <para>
                    <synopsis>
&lt;object data="horse.ogg" media-type="audio/ogg"/>
&lt;param name="autoplay" value="false">
&lt;/object></synopsis></para>
                <para>a Reading System would instantiate the designated handler Content Document as
                    if its URI query string parameters were:</para>
                <para>
                    <synopsis>
src=horse.ogg&amp;type=audio/ogg&amp;autoplay=false        </synopsis></para>

                <para role="rsconf">Non-ASCII and non-URL-safe characters (e.g. '=') should be
                    escaped in the usual manner for these parameters (UTF-8 encoding and using %XX
                    escapes). </para>
                <para role="rsconferr">The following partial example illustrates how bindings can be
                    used to provide a default implementation:</para>
                <para><informalexample>
                        <synopsis>
&lt;manifest>
  &lt;item id="pict1" href="images/Pict1.jpg" media-type="image/jpeg"/>
  ...
  &lt;item id="content" href="content.xhtml" media-type="application/xhtml+xml"/>
  &lt;item id="impl" href="impl.xhtml" media-type="application/xhtml+xml"/>
  &lt;item id="slideshow" href="slideshow.xml" media-type="application/x-demo-slideshow"/>
 &lt;/manifest>
 &lt;bindings>
   &lt;mediaType media-type="application/x-demo-slideshow" handler="impl"/>
 &lt;/bindings>

<emphasis role="italic">in content.xhtml:</emphasis>

...
&lt;object data="slideshow.xml" type="application/x-demo-slideshow">
&lt;!-- if scripting is not available, just show them inline -->
&lt;img src="images/Pict1.jpg"/>
&lt;img src="images/Pict2.jpg"/>
&lt;img src="images/Pict3.jpg"/>
&lt;img src="images/Pict4.jpg"/>
&lt;/object>
...

<emphasis role="italic">in slideshow.xml:</emphasis>
&lt;slides>
  &lt;slide src="images/Pict1.jpg" dur="3"/>
  &lt;slide src="images/Pict2.jpg" dur="3"/>
  &lt;slide src="images/Pict3.jpg" dur="3"/>
  &lt;slide src="images/Pict4.jpg" dur="3"/>
&lt;/slides>    
                           
            </synopsis>
                    </informalexample></para>

                <section xml:id="sec-mediaType" xreflabel="mediaType">
                    <title>The <literal>mediaType</literal> element</title>
                    <variablelist xreflabel="item" role="elem-synopsis" xml:id="elemdef-mediaType">
                        <varlistentry>
                            <term>Element Name</term>
                            <listitem>
                                <para><literal>mediaType</literal></para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Occurrence</term>
                            <listitem>
                                <para>As a child of <xref linkend="elemdef-opf-bindings"/>.
                                    Repeatable.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attributes</term>
                            <listitem>
                                <variablelist role="elem-synopsis-attlist">

                                    <varlistentry xml:id="attrdef-mediaType-media-type"
                                        xreflabel="media-type">
                                        <term><literal>media-type</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>MIME media type.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-mediaaType-handler"
                                        xreflabel="handler">
                                        <term><literal>handler</literal>
                                            <option>[required]</option></term>
                                        <listitem>
                                            <para>Identifies via an IDREF <xref linkend="refXML"/>
                                                the manifest XHTML Content Document to be invoked to
                                                handle content of the type specified in this
                                                element</para>
                                        </listitem>
                                    </varlistentry>

                                    <varlistentry>
                                        <term><literal>Common Package Attributes</literal>
                                            [TODO]</term>
                                        <listitem>
                                            <para/>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>Empty.</para>
                            </listitem>
                        </varlistentry>

                    </variablelist>

                </section>
            </section>
            <!--
            <section xml:id="sec-common-package-attrs">
                <title>Common Package Document Attributes</title>
                <para>The following list defines the semantics of attributes that occur on multiple
                    elements in the Package Document. These attributes are optional unless locally
                    specified to be required. Refer to the element definitions in <xref
                        linkend="sec-package-def"/> for details on the occurence of these
                    attributes.</para>
                <variablelist role="elem-synopsis-attlist">
                    <varlistentry xml:id="attrdef-common-xmllang" xreflabel="xml:lang">
                        <term><literal>xml:lang</literal></term>
                        <listitem>
                            <xi:include href="./share/xmllang-prose-para.xml"/>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="attrdef-common-dir" xreflabel="dir">
                        <term><literal>dir</literal></term>
                        <xi:include href="./share/dir-prose-listitem.xml"/>
                    </varlistentry>
                    <varlistentry xml:id="attrdef-common-id" xreflabel="id">
                        <term><literal>id</literal></term>
                        <listitem>
                            <xi:include href="./share/id-prose-para.xml"/>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>
            -->
        </section>

    </chapter>

    <xi:include href="./sections/EPUB_Publications30-ncx.xml"/>

    <chapter xml:id="sec-content-definitions">
        <title>EPUB Content Definitions and Processing Flow</title>
        <para>This section includes information about specific values required or allowable in
            different portions of an EPUB Publication in EPUB3 including Core Media Types, Guide
            reference types, and <remark role="todo">TODO: NCX . </remark>, as well as a section on
            processing flow for fallbacks (alternatives to Core Media Types).</para>
        <section xml:id="sec-core-media-types">
            <title>Core Media Types</title>
            <para>The following table lists the EPUB Core Media Types by MIME type.</para>
            <para>Reading Systems must support rendering of these media types.</para>
            <para>Note that Publications may optionally reference items of additional media types.
                In this case, a fallback chain is required to be supplied, as detailed in <xref
                    linkend="sec-fallbacks"/>. </para>
            <para>
                <table xml:id="ex.htmltable">
                    <caption>EPUB Core Media Types</caption>
                    <thead>
                        <tr>
                            <td>MIME Media Type</td>
                            <td>Reference</td>
                            <td>Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>image/gif</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.w3.org/Graphics/GIF/spec-gif89a.txt"
                                    >http://www.w3.org/Graphics/GIF/spec-gif89a.txt</link>
                            </td>
                            <td> Used for raster graphics </td>
                        </tr>

                        <tr>
                            <td>
                                <code>image/jpeg</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.w3.org/Graphics/JPEG/"
                                    >http://www.w3.org/Graphics/JPEG/</link>
                            </td>
                            <td> Used for raster graphics </td>
                        </tr>

                        <tr>
                            <td>
                                <code>image/png</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.ietf.org/rfc/rfc2083.txt">RFC
                                    2083</link>
                            </td>
                            <td> Used for raster graphics </td>
                        </tr>

                        <tr>
                            <td>
                                <code>image/svg+xml</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.w3.org/TR/SVG11/"
                                    >[ContentDocs30]</link>
                            </td>
                            <td> Used for vector graphics for images and SVG Content Documents </td>
                        </tr>

                        <tr>
                            <td>
                                <code>application/xhtml+xml</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.w3.org/TR/xhtml11/"
                                    >[ContentDocs30]</link>
                            </td>
                            <td> Used for XHTML Content Documents </td>
                        </tr>

                        <tr>
                            <td>
                                <code>text/css</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.w3.org/TR/REC-CSS2/"
                                    >[ContentDocs30]</link>> </td>
                            <td> CSS style sheets </td>
                        </tr>

                        <tr>
                            <td>
                                <code>application/x-dtbncx+xml</code>
                            </td>
                            <td>
                                <link
                                    xlink:href="http://www.niso.org/standards/resources/Z39-86-2005.html"
                                    >[Publications30]</link>
                            </td>
                            <td> NCX </td>
                        </tr>
                        <tr>
                            <td>
                                <code>application/pls+xml</code>
                            </td>
                            <td>
                                <link xlink:href="http://www.w3.org/TR/pronunciation-lexicon/">
                                    Pronunciation Lexicon Specification 1.0 (PLS)</link>
                            </td>
                            <td> Used for pronunciation lexicons to assist text-to-speech
                                rendering</td>
                        </tr>
                        <tr>
                            <td>
                                <code>audio/mpeg</code>
                            </td>
                            <td>
                                <link xlink:href="http://tools.ietf.org/html/rfc3003">RFC3003</link>
                            </td>
                            <td> Used for MP3 audio</td>
                        </tr>
                        <tr>
                            <td>
                                <code>video/mp4</code> (in video element 'type' attribute:
                                    <code>"video/mp4; codecs='avc1.42E01E, mp4a.40.2'"</code>)</td>
                            <td>
                                <link xlink:href="http://www.rfc-editor.org/rfc/rfc4337.txt"
                                    >RFC4337</link>
                                <link xlink:href="http://www.itu.int/rec/T-REC-H.264-201003-I/en"
                                    >H.264</link>
                                <link
                                    xlink:href="http://www.iso.org/iso/iso_catalogue/catalogue_ics/catalogue_detail_ics.htm?csnumber=53943"
                                    >MPEG-4 Advanced Audio Coding - Low Complexity (AAC-LC)</link>
                            </td>
                            <td> Used for MPEG-4 video with H.264 Basic Profile video and AAC
                                audio.</td>
                        </tr>
                        <tr>
                            <td>
                                <code>NONE!!</code><remark role="todo">TODO: no MIME types defined
                                    for font formats!?</remark>
                            </td>
                            <td>
                                <link xlink:href="http://tools.ietf.org/html/rfc3003"
                                    >OpenType</link>
                            </td>
                            <td> Used for OpenType fonts</td>
                        </tr>
                        <tr>
                            <td>
                                <code>NONE!!</code>
                            </td>
                            <td>
                                <link xlink:href="http://tools.ietf.org/html/rfc3003">WOFF</link>
                            </td>
                            <td> Used for WOFF fonts</td>
                        </tr>
                    </tbody>
                </table>
            </para>
        </section>
        <section xml:id="sec-fallback-processing-flow">
            <title>Fallback Requirements and Processing Flow </title>
            <para>This section defines in detail the requirements for including fallback content in
                a Publication, and the process by which Reading Systems must process fallback
                information. The rules for fallback processing depend on both the type of item, and
                how is referenced by a Content Document or other resource.</para>
            <para>This specification defines a set of Core Media Types that all conforming Reading
                Systems must support in addition to Content Documents (e.g. PNG, SVG, OpenType
                fonts). Publications may optionally reference items of additional media types. In
                order to ensure that all conforming Publications can be successfully rendered by all
                conforming Reading Systems, alternative "fallback" items must be provided for each
                such item. Fallbacks may be provided either via inherent mechanisms defined for
                Content Documents, or via the manifest-level fallback mechanism defined in this
                specification. </para>
            <para>Any Reading System that supports video playback must support video files that
                utilize the MPEG-4 container with H.264/MPEG-4 AVC baseline profile format (H.264)
                video codec and MPEG-4 Advanced Audio Coding - Low Complexity (AAC-LC) audio codec,
                and this format is a Core Media Type.</para>
            <para>Any Reading System that supports audio playback must support MPEG-1 Layer 3 (MP3)
                audio, and this format is a Core Media Type. Any Reading System that supports video
                playback must also support standalone AAC-LC audio playback, but AAC-LC is NOT a
                Core Media Type.</para>
            <para>For every item that is not a Core Media Type, suitable fallback(s) of a Core Media
                Type must be provided via one of these mechanisms, as detailed below:</para>
            <para>For <emphasis role="bold">resources referenced in Content Documents via
                        <literal>object</literal> elements,</emphasis> legitimate fallback(s) must
                be provided via that elementâ€™s inherent replacement capabilities. </para>
            <para role="rsconf">Reading Systems must ignore manifest-level fallbacks in resolving
                such references (the <code>bindings</code> element described below could be
                considered to enable a type of fallback, but not in the sense meant here of ensuring
                that content can be rendered on all Reading Systems, whether or not they support
                scripting).</para>
            <para role="contentconf"> For <emphasis role="bold">resources referenced in Content
                    Documents via <literal>img</literal> elements,</emphasis> the text value of the
                alt or title attributes provide a legitimate fallback and should be included.
                Additional manifest-level fallbacks may be provided. </para>
            <para role="rsconf">Reading Systems should process manifest-level fallbacks in resolving
                such references. </para>


            <para role="contentconf">For <emphasis role="bold">fonts embedded in Content Documents
                    or EPUB Style Sheets using the <literal>@font-face</literal>
                    mechanism,</emphasis> the basic rules of CSS must be used to provide a
                legitimate fallback. </para>
            <para role="rsconf">Reading Systems must ignore manifest-level fallbacks in resolving
                CSS font references. </para>
            <para role="contentconf">For <emphasis role="bold">resources referenced in Content
                    Documents via <literal>iframe</literal> elements,</emphasis> only XHTML Content
                Documents may be referenced; fallback processing is inapplicable.</para>
            <para role="contentconf">For <emphasis role="bold">all other resource referencing
                    situations</emphasis> in EPUB Publications, a legitimate fallback must be
                provided via the manifest fallback mechanism. </para>
            <para role="rsconf">Reading Systems must process manifest-level fallbacks in resolving
                such resource references. </para>
        </section>
        <section xml:id="sec-structural-semantics-vocab">
            <title>Structural Semantics Vocabulary</title>
            <para><remark role="todo">TODO: this vocab is intended to be used by NCX, Overlay, @role
                    in Content Docs and guide but at present this is simply the table for guide
                    references from OPF 2.0.1 and its associated prose</remark></para>
            <para role="contentconf">Each Guide reference item's required type attribute must be
                selected from the list defined below when applicable. Other types may be used when
                none of the predefined types are applicable; their names must begin with the string
                other.. The value for the type attribute is case-sensitive. The following list of
                type values is derived from the 13th edition of the Chicago Manual of Style: <table
                    xml:id="ex2.htmltable">
                    <caption>Guide Reference Types</caption>
                    <tr>
                        <td class="MarcName"> cover </td>
                        <td class="MarcValue"> the book cover(s), jacket information, etc. </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> title-page </td>
                        <td class="MarcValue"> page with possibly title, author, publisher, and
                            other metadata </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> toc </td>
                        <td class="MarcValue"> table of contents </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> index </td>
                        <td class="MarcValue"> back-of-book style index </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> glossary </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> acknowledgements </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> bibliography </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> colophon </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> copyright-page </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> dedication </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> epigraph </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> foreword </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> loi </td>
                        <td class="MarcValue"> list of illustrations </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> lot </td>
                        <td class="MarcValue"> list of tables </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> notes </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> preface </td>
                        <td class="MarcValue"> </td>
                    </tr>

                    <tr>
                        <td class="MarcName"> text </td>
                        <td class="MarcValue"> First "real" page of content (e.g. "Chapter 1") </td>
                    </tr>
                </table>
            </para>
        </section>
        <section xml:id="sec-ncx-epub-semantics">
            <title>NCX reference types</title>
            <para role="contentconf"><remark role="todo">TODO: EPUB-specific requirements for
                    NCX</remark></para>
        </section>

    </chapter>

    <appendix xml:id="app-package-schema">
        <title>Package Document Schema</title>
        <para>The schema for Package Documents is available at <link
                xlink:href="./schema/opf30.nvdl">./schema/opf30.nvdl</link>.</para>
        <para>This schema is normative. In case of conflicts between the specification prose and
            this schema, the schema shall be considered definitive.</para>

        <section conformance="informative">
            <title>Using the Package Document Schema</title>
            <para>Validation of Package Documents using this schema will require a processor that
                supports <xref linkend="refNVDL"/>, <xref linkend="refRelaxNG"/> and <xref
                    linkend="refISOSchematron"/>.</para>
            <para>Note however that the NVDL schema layer can be substituted by a two-pass
                validation using the embedded RELAX NG and ISO Schematron schemas alone.</para>
        </section>

    </appendix>

    <appendix xml:id="app-ncx-schema">
        <title>NCX Document Schema</title>
        <para>The schema for NCX Documents is available at <link xlink:href="./schema/ncx30.nvdl"
                >./schema/ncx30.nvdl</link>.</para>
        <para>This schema is normative. In case of conflicts between the specification prose and
            this schema, the schema shall be considered definitive.</para>

        <section conformance="informative">
            <title>Using the NCX Document Schema</title>
            <para>Validation of NCX Documents using this schema will require a processor that
                supports <xref linkend="refNVDL"/>, <xref linkend="refRelaxNG"/> and <xref
                    linkend="refISOSchematron"/>.</para>
            <para>Note however that the NVDL schema layer can be substituted by a two-pass
                validation using the embedded RELAX NG and ISO Schematron schemas alone.</para>
        </section>

    </appendix>

    <appendix xml:id="acknowledgements" role="acknowledgements" conformance="informative">
        <title>Contributors</title>
        <xi:include href="./share/contributors.xml"/>
    </appendix>

    <xi:include href="./share/references.xml"/>
</book>
