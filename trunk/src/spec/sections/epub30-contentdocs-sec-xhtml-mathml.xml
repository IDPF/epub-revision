<section xml:id="sec-xhtml-mathml" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:epub="http://www.idpf.org/2011/epub" xmlns:xi="http://www.w3.org/2001/XInclude"
    version="5.1">
    <title>MathML Support</title>
    <para><remark role="todo">TODO review this, as there have been changes in the
        HTML5 spec recently wrt mathml</remark></para>
    
    <para>XHTML Content Documents may include, and Reading Systems must support,
        MathML content as defined in <xref linkend="refHTML5"/>, subject to the
        further restrictions specified in this section.</para>
    <para>XHTML Content Documents are required to limit usage of MathML to a
        restricted subset of the support defined in <xref linkend="refHTML5"/>, as
        defined in the following subsections. This subset is designed to ease the
        implementation burden on Reading Systems and promote accessibility, while
        retaining compatibility with HTML5 User Agents. These restrictions limit the
        MathML to presentation MathML except inside of a semantics element. They
        also provide guidelines on how fall back images and alternative text should
        be given.</para>
    <section xml:id="sec-xhtml-mathml-content">
        <title>Content MathML</title>
        <para>All content MathML elements shall be inside of an
            <literal>annotation-xml</literal> element. The
            <code>annotation-xml</code> element shall be the second child of a
            semantics element whose first child is presentation MathML. The
            <code>annotation-xml</code> element shall set the encoding attribute
            to <code>"MathML-Content"</code> or to
            <code>"application/mathml-content+xml"</code>. These two values are
            equivalent. The value of the name attribute shall be
            <code>"contentequiv"</code>. </para>
    </section>
    <section xml:id="sec-annot-types">
        <title>Annotation Types</title>
        <para>Legal <literal>annotation</literal> and
            <literal>annotation-xml</literal> attributes and content are
            restricted in the following ways:</para>
        <itemizedlist>
            <listitem>
                <para>The value for the content dictionary must be
                    <literal>mathmlkeys</literal></para>
            </listitem>
            <listitem>
                <para>The values for <literal>name</literal> must be
                    <literal>alternate-representation</literal> or
                    <literal>contentequiv</literal></para>
            </listitem>
            <listitem>
                <para>The values for <literal>encoding</literal> for
                    <literal>annotation-xml</literal> should be
                    <literal>MathML-Content/application/mathml-content+xml</literal>
                    or <literal>application/xhtml+xml</literal> When the latter is
                    specified, the content must be conformant with this XHTML
                    Content Document specification content, with the further
                    restrictions that it must have the same flow model (block or
                    inline) as the parent MathML, and must not itself contain MathML
                    content</para>
            </listitem>
        </itemizedlist>
        
    </section>
    <section xml:id="sec-fallback-images">
        <title>Fallback Images</title>
        <para>Fallback images should be provided on the math element or on
            annotation. Preference order for fallback is: annotation, math
            (altimg).</para>
        <para>In the context of EPUB, content conformance and fallback processing
            rules for such fallback images in MathML content are defined as the same
            as defined for the <code>&lt;img></code> element, as more specifically
            described in [Publication3].</para>
    </section>
</section>