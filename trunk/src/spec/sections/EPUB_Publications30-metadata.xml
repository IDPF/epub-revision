<section xmlns="http://docbook.org/ns/docbook" xml:id="sec-metadata-elem"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1b2"
    xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>The <literal>metadata</literal> Element</title>
    <para>The <literal>metadata</literal> element contains information about the publication as a
        whole. This includes metadata that applies to the publication package, as well as the
        abstract content contained within the package. Information within the metadata element is
        expressed by a combination of three required Dublin Core Metadata Element Set [DCMES]
        properties, optional properties from DCMI Metadata Terms [DCTERMS], as well as optional
        ancillary properties defined in this specification.</para>

    
    <para>The <literal>metadata</literal> element no longer requires <xref
            linkend="refXMLNamespaces"/> declarations. This is a change from previous versions, in
        which the <literal>metadata</literal> element required declarations to qualify child
        elements and attributes. This is now achieved via the <xref
            linkend="sec-metadata-extensibility"/> introduced in this specification.</para>

    <variablelist xreflabel="metadata" role="elem-synopsis" xml:id="elemdef-opf-metadata">
        <varlistentry>
            <term>Element Name</term>
            <listitem>
                <para><literal>metadata</literal></para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Occurrence</term>
            <listitem>
                <para>Required first child of <xref linkend="elemdef-opf-package"/>.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Attributes</term>
            <listitem>
                <para>The <literal>metadata</literal> element has no attributes defined in this
                    specification.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Content Model</term>
            <listitem>
                <para>In any order: <literal><xref linkend="elemdef-opf-dcidentifier"/></literal>
                    <option>[required]</option>, <literal><xref linkend="elemdef-opf-dctitle"
                        /></literal>
                    <option>[required]</option>, <literal><xref linkend="elemdef-opf-dclanguage"
                        /></literal>
                    <option>[required]</option>, <literal><xref linkend="elemdef-opf-meta"
                        /></literal>
                    <option>[optional]</option>, <literal><xref linkend="elemdef-opf-link"
                        /></literal>
                    <option>[optional]</option></para>
            </listitem>
        </varlistentry>
    </variablelist>
    
    
    <section xml:id="sec-opf-metadata-dcmi-transition">
        <title>Dublin Core Metadata Vocabulary Transition</title>
    <para>To enhance the ability of metadata to be expressed in a well-understood and
            semantically-rich form, this specification introduces Dublin Core Metadata Terms
            [DCTERMS] as the prefered vocabulary for standardized metadata expression. Previous
            versions of this specification used the Dublin Core Metadata Element Set 1.1 [DCMES]  as
            a vocabulary for expressing standardized metadata. This specification deprecates these
            legacy <xref linkend="sec-opf-metadata-dcmes"/> elements in favor of elements from
            [DCTERMS], with the following notable exceptions: <literal>dc:identifier</literal>,
                <literal>dc:title</literal>, <literal>dc:language</literal>. These three elements
            are not deprecated in order to maintain the highest level of backwards compatibility
            while transitioning to [DCTERMS]. These three DCMES elements will be deprecated in a
            future version of this specification.</para>
        <para/>
    </section>
    <section xml:id="sec-opf-metadata-dcmes">
        <title>Legacy Dublin Core Metadata (DCMES)</title>
    

        <section xml:id="sec-opf-dcidentifier" xreflabel="dc:identifier">
            <title>The DCMES <literal>identifier</literal> Element</title>
            <para>A an alphanumeric string provided for the purposes of identification and
                differentiation. A minimum of one <literal>dc:identifier</literal> must is required
                to be present and must have an <literal>id</literal> assigned, and
                    <literal>id</literal> must be the exact value of the <literal>package</literal>
                element <literal>unique-identifier</literal> attribute.</para>
            <para>Multiple <literal>dc:identifier</literal> elements may occur as children of the
                    <literal>metadata</literal> element in any order.</para>
            <para>The <literal>dc:identifier</literal> element may be extended by the the
                    <literal>override</literal> attribute mechanism introduced in this
                specification. When used, the <literal>override</literal> attribute must refer to a
                meta element with a property value of <literal>dcterms:identifier</literal>.</para>
            
            <variablelist xreflabel="dc:identifier" role="elem-synopsis"
                xml:id="elemdef-opf-dcidentifier">
                <varlistentry>
                    <term>Element Name</term>
                    <listitem>
                        <para>
                            <literal>dc:identifier</literal>
                        </para>
                    </listitem>
                </varlistentry>

                    <varlistentry>
                    <term>Namespace</term>
                    <listitem>
                        <para><literal>http://purl.org/dc/elements/1.1/</literal></para>
                    </listitem>
                    </varlistentry>

                <varlistentry>
                    <term>Occurrence</term>
                    <listitem>
                        <para>Required child of <xref linkend="elemdef-opf-metadata"/>.
                            Repeatable.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Attributes</term>
                    <listitem>
                        
                        <variablelist role="elem-synopsis-attlist">
                   
                            <varlistentry xml:id="attrdef-dcidentifier-id">
                                <term>
                                    <literal>id</literal>
                                    <option>[required]</option>
                                </term>
                                <listitem>
                                    <para></para>
                                </listitem>
                            </varlistentry>
                                        
                            <varlistentry xml:id="attrdef-dcidentifier-override">
                                            <term>
                                                <literal>override</literal>
                                                <option>[optional]</option>
                                            </term>
                                            <listitem>
                                                <para></para>
                                            </listitem>
                            </varlistentry>
                        </variablelist>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Content Model</term>
                    <listitem>
                        <para>Text</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>

        <section xml:id="elemdef-opf-dctitle" xreflabel="dc:title">
            <title>The DCMES <literal>title</literal> Element</title>
            <para> The required <literal>dc:title</literal> provides a title for the publication.
                    Multiple<literal> dc:title</literal> elements may appear in the
                    <literal>metadata</literal> element. When multiple <literal>dc:title</literal>
                elements are present, and no <literal>override</literal> property refers to an
                equivalent <literal>dcterms:title</literal>, the first <literal>dc:title</literal>
                element should be considered primary title of the publication.</para>
            
            <variablelist xreflabel="dc:title" role="elem-synopsis">
                <varlistentry>
                    <term>Element Name</term>
                    <listitem>
                        <para>
                            <literal>dc:title</literal>
                        </para>
                    </listitem>
                </varlistentry>
                
                <varlistentry>
                    <term>Namespace</term>
                    <listitem>
                        <para><literal>http://purl.org/dc/elements/1.1/</literal></para>
                    </listitem>
                </varlistentry>
                
                <varlistentry>
                    <term>Occurrence</term>
                    <listitem>
                        <para>Required child of <xref linkend="elemdef-opf-metadata"/>.
                            Repeatable.</para>
                    </listitem>
                </varlistentry>
                
                <varlistentry>
                    <term>Attributes</term>
                    <listitem>
                        <variablelist role="elem-synopsis-attlist">
                            
                            <varlistentry xml:id="attrdef-dctitle-id">
                                <term>
                                    <literal>id</literal> [optional]</term>
                                <listitem><para></para></listitem>
                            </varlistentry>
                            
                            <varlistentry xml:id="attrdef-dctitle-override">
                                            <term>
                                                <literal>override</literal>
                                                <option>[optional]</option>
                                            </term>
                                            <listitem><para></para></listitem>
                            </varlistentry>
                            
                                    </variablelist>
                                </listitem>
                </varlistentry>
                

                <varlistentry>
                    <term>Content Model</term>
                    <listitem>
                        <para>Text</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>

        <section xml:id="elemdef-opf-dclanguage" xreflabel="dc:language">
            <title>The DCMES <literal>language</literal> Element</title>
            <para> The required <literal>dc:language</literal> element indicates the default
                language of the publication content, and must contain a value that is either a
                2-letter language code as defined in [ISO 639-1] or a 3-letter language code as
                defined in [ISO 639-2T], and may include an optional dash-separated country code as
                defined in [ISO 3166].</para>
            
            <variablelist xreflabel="dc:language" role="elem-synopsis">
                <varlistentry>
                    <term>Element Name</term>
                    <listitem>
                        <para>
                            <literal>dc:language</literal>
                        </para>
                    </listitem>
                </varlistentry>
                
                <varlistentry>
                    <term>Namespace</term>
                    <listitem>
                        <para><literal>http://purl.org/dc/elements/1.1/</literal></para>
                    </listitem>
                </varlistentry>
                
                <varlistentry>
                    <term>Occurrence</term>
                    <listitem>
                        <para>Required child of <xref linkend="elemdef-opf-metadata"/>.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Attributes</term>
                    <listitem>
                        <variablelist role="elem-synopsis-attlist">
                            <varlistentry xml:id="attrdef-dclanguage-override">
                                <term>
                                    <literal>override</literal>
                                    <option>[optional]</option>
                                </term>
                                <listitem>
                                    <para/>
                                </listitem>
                            </varlistentry>
                        </variablelist>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Content Model</term>
                    <listitem>
                        <para>Text</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>

    </section>
   
    <section xml:id="sec-opf-meta" xreflabel="meta">
        <title>The <literal>meta</literal> element</title>
        <para>The meta element is a generic placeholder to express metadata, or further describe
            other metadata. This is accomplished by means of an RDFa 1.1 mechanism utilizing the
            required <literal>property</literal> attribute, and the optional
                <literal>about</literal> attribute. </para>
        
        <variablelist xreflabel="Meta Element" role="elem-synopsis" xml:id="elemdef-opf-meta">
            <varlistentry>
                <term>Element Name</term>
                <listitem>
                    <para>
                        <literal>meta</literal>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Occurrence</term>
                <listitem>
                    <para>As child of the <xref linkend="elemdef-opf-metadata"/> element.
                        Repeatable.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Attributes</term>
                <listitem>
                    <variablelist role="elem-synopsis-attlist">
                        <varlistentry xml:id="attrdef-meta-property">
                            <term>
                                <literal>property</literal>
                                <option>[required]</option>
                            </term>
                            <listitem>
                                <para>Specifies the by name a DCTERMS or ancillary metadata property
                                being expressed.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>                        
                        <term>
                                <literal>about</literal>
                                <option>[optional unless required]</option>
                            </term>
                            <listitem>
                                <para>A reference by id to the subject of the <literal>meta</literal> element property
                                    being expressed. Optional only when a <literal>meta</literal> element contains a
                                    non-empty child text node. When the <literal>meta</literal> element contains an
                                    empty child text-node, the about attribute is required and must
                                    contain a valid id of another meta element.</para>
                            </listitem>                            
                        </varlistentry>
                        
                    </variablelist>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Model</term>
                <listitem>
                    <para>Text or Empty.</para>
                </listitem>
            </varlistentry>
        </variablelist>


        <section xml:id="elemdef-opf-meta-property-values-dcterms">
            <title>Recognized DCTERMS values for the <literal>meta</literal> element
                    <literal>property</literal> attribute</title>
            <para>The <literal>meta</literal> element <literal>property</literal> attribute may
                contain any DCMI Metadata Terms values <xref linkend="refDCTERMS"
                />.</para>
                
             <para>[DCTERMS] properties can be further described by other [DCTERMS] properties and
                ancillary properties defined elsewhere in this specification.</para>            
        </section>
        
        <section xml:id="elemdef-opf-meta-property-values-ancillary">
            <title>Recognized ancillary values for the <literal>meta</literal> element
                    <literal>property</literal> attribute</title>
            
            <para>This table lists <literal>meta</literal> element <literal>property</literal>
                attribute values that are defined in this specification. The metadata expressed by
                these properties describes other properties in the metadata element. These include
                properties from [DCTERMS] as well as other ancillary properties. </para>
            
            <para>As with other metadata properties in this specification, ancillary properties
                defined in this specification can be further described by other ancillary properties
                defined elsewhere in this specification and by [DCTERMS] properties.</para>

            <informaltable xml:id="tbl-opf-meta-property-values-ancillary" title="Table of @property
                Ancillary values">
                <thead>
                    <tr>
                        <th>property name</th>
                        <th>definition</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><literal>alternate-script</literal></td>
                        <td>Used to provide an alternate expression of metadata in another language
                            or character set.</td>
                    </tr>
                    <tr>
                        <td><literal>authority</literal></td>
                        <td>Relates a responsible party that provided or updated information
                            expressed in package metadata.</td>
                    </tr>
                    <tr>
                        <td><literal>date-ref</literal></td>
                        <td>Relates one metadata property to <literal>dcterms:date</literal>
                            property</td>
                    </tr>
                    <tr>
                        <td><literal>display-seq</literal></td>
                        <td>Denotes the order in which title, creator, or contributor metadata
                            should be displayed relative to other title, creator, or contributor
                            metadata.</td>
                    </tr>
                    <tr>
                        <td><literal>event</literal></td>
                        <td>Describes a <literal>dcterms:date</literal> property.</td>
                    </tr>
                    <tr>
                        <td><literal>file-as</literal></td>
                        <td>Describes the form in which title, creator, or contributor metadata
                            should be used for systemic sorting.</td>
                    </tr>
                    <tr>
                        <td><literal>meta-auth</literal></td>
                        <td>Used to provide the name of the responsible party for metadata creation
                            or updates</td>
                    </tr>
                    <tr>
                        <td><literal>override</literal></td>
                        <td>Used to provide an extension mechanism for the required DCMES
                            properties; must refer by id to a DCTERMS equivalent when used.</td>
                    </tr>
                    <tr>
                        <td><literal>role</literal></td>
                        <td>Describes the nature of work performed by a creator or contributor </td>
                    </tr>
                    <tr>
                        <td><literal>scheme</literal></td>
                        <td>Describes identifier or subject metadata as being derived from a formal
                            system.</td>
                    </tr>
                    <tr>
                        <td><literal>signature</literal></td>
                        <td>Relates a metadata authority responsible for creating or updating
                            package metadata to an [XML Signature] contained in the
                                <literal>Signatures.xml</literal> file.</td>
                    </tr>
                    <tr>
                        <td><literal>sort-order</literal></td>
                        <td>Denotes the order in which title metadata should be sorted relative to
                            other title meta</td>
                    </tr>
                    <tr>
                        <td><literal>title-type</literal></td>
                        <td>Describes the type of title metadata being expressed in a <literal>dc:title</literal> or
                            <literal>dcterms:title</literal> property.</td>
                    </tr>
                </tbody>                
            </informaltable>

        </section>
        

    
    <section xml:id="elemdef-opf-meta-property-values-package">
        <title>Recognized package level values for the <literal>meta</literal> element
            <literal>property</literal> attribute</title>
        <para>This table lists <literal>meta</literal> element <literal>property</literal>
            attribute values that describe the package.</para>
        <informaltable xml:id="tbl-opf-meta-property-values-package" title="Table of Package
            @property Values">
            <thead>
                <tr>
                    <th>property name</th>
                    <th>definition</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><literal>content-version</literal></td>
                    <td>A string to indicate the version of the package.</td>
                </tr>
                <tr>
                     <td><literal>page-progression-direction</literal></td>
                    <td>Descibes the direction that content flows within the package. Allowed values
                        are <literal>ltr</literal> or <literal>rtl</literal>.</td>
                </tr>
                <tr>
                    <td><literal>publication-type</literal></td>
                    <td>Describes a package as a specialized type of EPUB Package. Allowed values
                            are <literal>dictionary</literal> or <literal>annotation</literal>.</td>
                </tr>
                <tr>
                    <td><literal>source-identifier</literal></td>
                    <td>Describes a single <literal>dc:identifier</literal> or
                        <literal>dcterms:identifier</literal> property that is the source of
                        the NCX pageList.</td>
                </tr>
            </tbody>
          </informaltable>
    </section>
    </section>

    <section xml:id="sec-opf-link" xreflabel="link">
        <title>The <literal>link</literal> element</title>

        <para>The <literal>link</literal> element is used to associate external metadata resources
            with the publication.</para>

        <variablelist xreflabel="link" role="elem-synopsis" xml:id="elemdef-opf-link">
            <varlistentry>
                <term>Element Name</term>
                <listitem>
                    <para>
                        <literal>link</literal>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Occurrence</term>
                <listitem>
                    <para>As a child of <xref linkend="elemdef-opf-metadata"/>. Repeatable.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Attributes</term>
                <listitem>
                    <variablelist role="elem-synopsis-attlist">
                        <varlistentry xml:id="attrdef-link-href">
                            <term>
                                <literal>href</literal>
                                <option>[required]</option>
                            </term>
                            <listitem>
                                <para>A valid URL [TODO RFC link] to an external metadata
                                    resource.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="attrdef-link-rel">
                            <term>
                                <literal>rel</literal>
                                <option>[required]</option>
                            </term>
                            <listitem>
                                <para>A token that describes the nature of the external resource
                                    (its relation to the publication). See further <xref
                                        linkend="elemdef-opf-link-rel-values"/>.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="attrdef-link-id">
                            <term>
                                <literal>id</literal>
                                <option>[optional]</option>
                            </term>
                            <listitem>                                
                                <xi:include href="../share/id-prose-para.xml"/>                                
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Model</term>
                <listitem>
                    <para>Empty.</para>
                </listitem>
            </varlistentry>
        </variablelist>

        <para>The resources identified by the <literal>link</literal> element <literal>href</literal> attribute are considered <glossterm
                linkend="gloss-external-resource">external resources</glossterm>, and must therefore not be identified as items in the
            <link linkend="sec-manifest-elem">manifest</link>.</para>
        
        <para>If metadata provided in an external record conflicts with metadata given inline in the
            Package Document metadata element, then the external metadata should be given
            precedence.</para>
        
        <para>Reading Systems are not required to dereference the resources identified through the <literal>link</literal> element.</para>
        
        <!-- There is no provision for specifying the version of the record (this assumes that version information is available inline in the referenced resources) -->

        <section xml:id="elemdef-opf-link-rel-values">
            <title>Recognized values for the <literal>link</literal> element <literal>rel</literal>
            attribute</title>
            
            <informaltable>
                <thead>
                    <tr>
                        <th>value</th>
                        <th>definition</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><literal>onix-record</literal></td>
                        <td>The referenced resource is a record of the ONIX type <xref linkend="refONIX"/></td>
                    </tr>
                    <tr>
                        <td><literal>mods-record</literal></td>
                        <td>The referenced resource is a record of the MODS type <xref linkend="refMODS"/></td>
                    </tr>
                    <tr>
                        <td><literal>xmp-record</literal></td>
                        <td>The referenced resource is a record of the XMP type <xref linkend="refXMP"/></td>
                    </tr>
                    <tr>
                        <td><literal>marc21xml-record</literal></td>
                        <td>The referenced resource is a record of the MARC21 XML type <xref linkend="refMARC21XML"/></td>
                    </tr>
                </tbody>                
            </informaltable>
                                    
            <para>The <literal>link</literal> element <literal>rel</literal> attribute may include additional tokens than the ones
                enumerated above. Such additional tokens must comply to the restrictions defined in
                    <xref linkend="sec-metadata-extensibility"/>.</para>
        </section>

        <section xml:id="sec-opf-link-examples">
            <title>The <literal>link</literal> Element: Examples</title>

            <informalexample>
                <para>The following example shows the <literal>link</literal> element used to
                    associate an ONIX record with the publication.</para>
                <synopsis>
<xi:include parse="text" href="../examples/publications/link-1.xml"/></synopsis>
            </informalexample>

            <informalexample>
                <para>The following example shows the <literal>link</literal> element used to
                    associate two external resources with the publication: an XMP record, and a link
                    to an informational web page. Note that as the <literal>foaf:homepage</literal>
                    token is <link linkend="elemdef-opf-link-rel-values">not defined by this
                        specification</link>, the <link linkend="sec-metadata-extensibility"
                        >metadata extensibility mechanism</link> is employed.</para>
                <synopsis>
<xi:include parse="text" href="../examples/publications/link-2.xml"/></synopsis>
            </informalexample>

        </section>
    </section>

    <section xml:id="sec-metadata-identifiers">
        <title>Publication Identifiers</title>
        <para><remark role="todo">TODO pending finalization of WG discussion</remark></para>
        <!-- TODO reenable
            <para>The Package Document's author is responsible for choosing a
            primary identifier that is unique to one and only one particular package (i.e.,
            the set of resources referenced from the package document's manifest).</para> 
            <para role="rsconferr">Reading Systems must not fail catastrophically if they
            encounter two distinct EPUB Publications with the same purportedly unique
            primary identifier. </para>
        -->
    </section>

    <section xml:id="sec-metadata-extensibility" xreflabel="Metadata Extensibility Mechanism">
        <title>Metadata extensibility</title>
        <para>This specification introduces a mechanism for metadata extensibility that is modeled
            on the RDFa 1.1 profile mechanism.</para>
        <para>By utilizing the <literal>package</literal> element <literal>profile</literal>
            attribute, content authors can incorporate non-prefered metadata vocabularies as needed,
            and have access to the properties of the non-prefered vocabulary available for use
            globally in the publication package.</para>

    </section>

    <section>
        <title>Scripted Content Documents</title>
        <para role="epubconf">In EPUB Publications, Content Documents must not contain any
                <literal>script</literal> elements unless the manifest item corresponding to that
            Content Document contains the <literal>property</literal> value
                <literal>scripted</literal> (thus indicating a <emphasis role="bold">Scripted
                Content Document).</emphasis>Since scripted content may be processed differently,
            with features such as pagination potentially disabled, content items that set the
            property value of "scripted" should not be spine items unless absolutely required by a
            publication (i.e. scripted content should if possible be nested, contained within
            top-level content via "object" or "iframe").</para>

        <para role="rsconf">Reading Systems may render Scripted Content Documents as an interactive,
            scripted HTML User Agent according to <xref linkend="refHTML5"/> rather than according
            to the simplified processing model defined for EPUB User Agents in <xref
                linkend="refContentDocs3"/>, i.e. with scripting enabled. Reading Systems should not
            enable scripting for any resources other than Scripted Content Documents.</para>

        <para role="rsconf">Reading Systems may implement support for Scripted Content Documents in
            a manner that disables other EPUB capabilities and/or provides a different rendering
            such as, for example, disabling pagination.</para>
    </section>

    <section xml:id="sec-metadata-examples">
        <title>Metadata Examples</title>
        <para><remark role="todo">DPH TODO</remark></para>
    </section>

</section>
