<chapter xml:id="sec-contentdocs-xhtml-nav" xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1"
    xmlns:xi="http://www.w3.org/2001/XInclude">

    <title>XHTML Navigation Documents</title>

    <!-- TODOs 
        make sure Publications say 
         * that a Publication must include exactly one of these 
         * that it may be included in spine, 
         * how to identify it with meta
         * what mime type to use        
         * how to include a 2.0 NCX as well          
         * that it may have a media overlay associated with it regardless of whether it is in the spine or not (this may go to media overlays instead)    
        note in the schema appendix that the given schema replaces the generic one, no need to validate against both
    -->

    <section xml:id="sec-contentdocs-xhtml-nav-intro">
        <title>Introduction</title>

        <!-- TODO olink "required component" to the defining sec in Publications -->
        <para>The XHTML Navigation Document is a required component of <xref
                linkend="gloss-epub-publication"/>s. It provides the Author with a mechanism to
            include a human- and machine readable global navigation layer in the Publication,
            thereby ensuring increased usability and accessibility for the User. </para>

        <para>The XHTML Navigation Document is an adaptation of <xref
                linkend="gloss-content-document-xhtml"/>, and is <link
                linkend="nav-content-conf-parent">by definition</link> a valid XHTML Content
            Document instance. The navigation features of this adaptation are expressed through
            specializations of the HTML5 <code>nav</code> element. </para>

        <para>Each <code>nav</code> element in an XHTML Navigation Document is, while remaining
            human readable, a "data island" from which Reading Systems retrieve navigational
            information. To facilitate machine readability, the content model of the
                <code>nav</code> elements in an XHTML Navigation Document is restricted as compared
            to what is allowed in general XHTML Content Documents.</para>

        <para>As defined in <remark role="todo">TODO olink</remark>, the XHTML Navigation Document
            may be included in the Publication <xref linkend="gloss-spine"/>, but may also be
            provided independently of the Publication content. </para>

        <!-- TODO blurb on reading system reqs and freedoms -->

        <note>
            <para><remark role="todo">TODO olink</remark> contains information on how the XHTML
                Navigation Document is identified through metadata in the <xref
                    linkend="gloss-package-document"/>.</para>
        </note>

        <note>
            <para>The XHTML Navigation Document supersedes the NCX document type as defined in <xref
                    linkend="refOPF2"/>.</para>
            <para><remark role="todo">TODO olink</remark> contains information on how EPUB 3
                Publications may include an NCX document for Reading System forwards compatibility
                purposes.</para>
        </note>

    </section>

    <section xml:id="sec-contentdocs-xhtml-nav-content-conf">
        <title>XHTML Navigation Documents Content Conformance</title>

        <para>A conformant <xref linkend="gloss-content-document-xhtml-nav"/> must meet all of the
            following criteria:</para>

        <orderedlist role="conformance-list">
            <listitem role="conformance-item" xml:id="nav-content-conf-parent">
                <para>It must conform to all content conformance constraints for <xref
                        linkend="gloss-content-document-xhtml"/>s as defined in <xref
                        linkend="sec-contentdocs-xhtml-content-conf"/>.</para>
            </listitem>
            <listitem role="conformance-item">
                <para>It must be valid to the XHTML Navigation Document schema as defined in <xref
                        linkend="app-xhtml-nav-schema"/>.</para>
            </listitem>

            <listitem role="conformance-item">
                <para>It must conform to all content conformance constraints specific for XHTML
                    Navigation Documents expressed in <xref linkend="sec-contentdocs-xhtml-nav-def"
                    />.</para>
            </listitem>

            <listitem>
                <para>The URI provided in the <code>href</code> attribute of the <code>a</code>
                    element descendants of any <code>nav</code> element must resolve to <xref
                        linkend="gloss-content-document"/>s or fragments therein.</para>
            </listitem>

        </orderedlist>
    </section>

    <section xml:id="sec-contentdocs-xhtml-nav-rs-conf">
        <title>XHTML Navigation Documents Reading System Conformance</title>
        <orderedlist role="conformance-list">
            <listitem role="conformance-item">
                <para>Reading Systems must have the ability to, at User request, provide access to
                    the links and link labels in <link linkend="sec-contentdocs-xhtml-nav-def-types"
                        >the <code>nav</code> elements of the XHTML Navigation Document</link> in a
                    fashion that allows the user to activate the links provided, thus relocating the
                    application's current reading position to the destination described by the
                    activated link.</para>
            </listitem>
            <listitem role="conformance-item">
                <para>Reading Systems must honor the above requirement irrespective of whether the
                    XHTML Navigation Document provided in a Publication is part of the <xref
                        linkend="gloss-spine"/>.</para>
            </listitem>
        </orderedlist>
    </section>

    <section xml:id="sec-contentdocs-xhtml-nav-def">
        <title>XHTML Navigation Document Definition</title>

        <!--
            can hopefully skip this
        <section xml:id="sec-contentdocs-xhtml-nav-def-model">
            <title>The <code>nav</code> element: restrictions</title>
            <para>As enforced by the <xref linkend="app-xhtml-nav-schema"/>, the content model of
                the <code>nav</code> element and its descendants in <xref
                    linkend="gloss-content-document-nav"/>s is restricted as follows:</para>

            <itemizedlist>
                <listitem>
                    <para>Each <code>nav</code> element must contain an optional heading followed by
                        a required ordered list.</para>
                </listitem>
                <listitem>
                    <para>The URI provided in the <code>href</code> attribute of the <code>a</code>
                        element descendants of the <code>nav</code> element must resolve to EPUB
                        Content Documents or fragments therein.</para>
                </listitem>
            </itemizedlist>
        </section> 
-->

        <section xml:id="sec-contentdocs-xhtml-nav-def-types">
            <title>The <code>nav</code> element: types</title>

            <para>The <code>nav</code> elements within the XHTML Navigation Document are
                distinguished semantically through the value of their <code>epub:type</code>
                attribute. By default (and as inferred from the value of the <code>html</code>
                element <code>profile</code> attribute), values of <code>epub:type</code> are drawn
                from the EPUB3 Structural Semantics Vocabulary <xref linkend="refEPUBStructureVocab"
                />. Refer to <xref linkend="sec-xhtml-content-type-attribute"/> for further
                information. </para>

            <section xml:id="sec-contentdocs-xhtml-nav-def-types-toc">
                <title>The <property>toc</property>
                    <code>nav</code> element</title>

                <para>The <literal>toc</literal><code>nav</code> element is a container for primary
                    structural navigational information. It conceptually corresponds to a table of
                    contents in a printed work (i.e. it provides navigation to the structural
                    sections of the Publication).</para>

                <para>For usability and accessibility reasons, Authors should provide an exhaustive
                        <property>toc</property>
                    <code>nav</code> element; it should not exclude references below a certain
                    section depth, as the "reduced" table of contents often appearing in printed
                    works do.</para>

                <note>
                    <para>Authors who desire to mimic the "reduced" table of contents of a printed
                        source should utilize CSS Style Sheets to hide sections below a certain
                        depth visually, while still providing an exhaustive section hierarchy for
                        machine consumption.</para>
                </note>

                <informalexample>
                    <para>The following example shows a partial <literal>toc</literal>
                        <code>nav</code> element. Note how the author has elected to use CSS style
                        information to hide sections below a certain depth visually.</para>
                    <synopsis>
<xi:include href="../examples/contentdocs-nav/toc.xml" parse="text"/></synopsis>
                </informalexample>

                <para>The <property>toc</property>
                    <code>nav</code> element must occur exactly once in XHTML Navigation
                    Documents.</para>

                <note>
                    <para>The <property>toc</property>
                        <code>nav</code> element corresponds to the <code>navMap</code> element in
                        the superseded NCX. <xref linkend="refOPF2"/></para>
                </note>

            </section>

            <section xml:id="sec-contentdocs-xhtml-nav-def-types-pagelist">
                <title>The <property>page-list</property>
                    <code>nav</code> element</title>

                <para>The <literal>page-list</literal>
                    <code>nav</code> element is a container for pagination information. It provides
                    navigation to positions in the Publication content that correspond to the
                    locations of page boundaries present in a print source being represented by this
                    EPUB Publication.</para>

                <note>
                    <para>The <remark role="todo">TODO olink</remark> property provides a means to
                        identify the print work to which the given pagination information
                        applies.</para>
                </note>

                <informalexample>
                    <para>The following example shows a partial <literal>page-list</literal>
                        <code>nav</code> element. Note how the author has elected to use CSS style
                        information to hide the element visually.</para>
                    <synopsis>
<xi:include href="../examples/contentdocs-nav/page-list.xml" parse="text"/></synopsis>
                </informalexample>

                <para>The <property>page-list</property>
                    <code>nav</code> element is optional in XHTML Navigation Documents, and must not
                    occur more than once. </para>

                <note>
                    <para>The <property>page-list</property>
                        <code>nav</code> element corresponds to the <code>pageList</code> element in
                        the superseded NCX. <xref linkend="refOPF2"/></para>
                </note>
            </section>

            <section xml:id="sec-contentdocs-xhtml-nav-def-types-landmarks">
                <title>The <property>landmarks</property>
                    <code>nav</code> element</title>

                <para>The <literal>landmarks</literal>
                    <code>nav</code> element identifies fundamental structural components of the
                    publication, in order to enable Reading Systems to provide the user effective
                    access to them.</para>

                <para>The structural semantics of each link target within the
                        <literal>landmarks</literal>
                    <code>nav</code> element is determined through the value of the <link
                        linkend="sec-xhtml-content-type-attribute">epub:type</link> attribute on the
                        <code>a</code> element descendants. The <code>epub:type</code> attribute is
                    required on <code>a</code> descendants of the <literal>landmarks</literal>
                    <code>nav</code> element.</para>

                <informalexample>
                    <para>The following example shows a <literal>landmarks</literal>
                        <code>nav</code> element with structural semantics drawn from the <link
                            linkend="refEPUBStructureVocab">EPUB Structural Semantics
                            Vocabulary</link>:</para>
                    <synopsis>
<xi:include href="../examples/contentdocs-nav/landmarks.xml" parse="text"/></synopsis>
                </informalexample>

                <para>The <property>landmarks</property>
                    <code>nav</code> element is optional in XHTML Navigation Documents, and must not
                    occur more than once. </para>

                <note>
                    <para>The <property>landmarks</property>
                        <code>nav</code> element corresponds to the deprecated OPF
                            <code>guide</code> element. <xref linkend="refOPF2"/></para>
                </note>
            </section>

            <section xml:id="sec-contentdocs-xhtml-nav-def-types-other">
                <title>Any other <code>nav</code> elements</title>

                <para>XHTML Navigation Documents may include zero or many <code>nav</code> elements
                    additional to the the <literal>toc</literal>, <literal>page-list</literal> and
                        <literal>landmarks</literal>
                    <code>nav</code> elements defined above. Such additional <code>nav</code>
                    elements should have an <code>epub:type</code> attribute to provide a machine-readable
                    semantic, and must have a human-readable heading as their first child.</para>

                <para>This specification imposes no restrictions on the usage of such additional
                        <code>nav</code> elements; they may be used to represent constructs with
                    homogenous semantics (such as list of illustrations, or all quotes of a certain
                    author in an anthology) or with heterogenous semantics (such as the <link
                        linkend="sec-contentdocs-xhtml-nav-def-types-landmarks">landmarks</link>
                    <code>nav</code>) element.</para>

            </section>

        </section>

    </section>

    <!--
    <section xml:id="sec-contentdocs-xhtml-nav-ex">
        <title>XHTML Navigation Documents Examples</title>
    </section>
    -->
</chapter>
