<section xmlns="http://docbook.org/ns/docbook" xml:id="sec-metadata-elem"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1b2"
    xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>The <literal>metadata</literal> Element</title>
    
    <section xml:id="sec-opf-metadata-definition">
        <title>Definition</title>
        
        <para>The <literal>metadata</literal> element encapsulates information about the publication as a
            whole, including metadata that applies to the publication package and to the abstract content 
            contained within the package. Metadata is expressed through a combination of three required 
            Dublin Core Metadata Element Set (<xref linkend="refDCMES"/>) properties &#8212; title, identifier
            and language &#8212; coupled with optional properties from DCMI Metadata Terms 
            (<xref linkend="refDCTERMS"/>). These metadata terms can be
            further enhanced and extended by a set of optional properties also defined in this specification.</para>
        
        <variablelist xreflabel="metadata" role="elem-synopsis" xml:id="elemdef-opf-metadata">
            <varlistentry>
                <term>Element Name</term>
                <listitem>
                    <para><literal>metadata</literal></para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Occurrence</term>
                <listitem>
                    <para>Required first child of <xref linkend="elemdef-opf-package"/>.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Attributes</term>
                <listitem>
                    <para>The <literal>metadata</literal> element has no attributes defined in this
                        specification.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Model</term>
                <listitem>
                    <para>In any order: <literal><xref linkend="elemdef-opf-dcidentifier"/></literal>
                        <option>[required]</option>, <literal><xref linkend="elemdef-opf-dctitle"
                        /></literal>
                        <option>[required]</option>, <literal><xref linkend="elemdef-opf-dclanguage"
                        /></literal>
                        <option>[required]</option>, <literal><xref linkend="elemdef-opf-meta"
                        /></literal>
                        <option>[optional]</option>, <literal><xref linkend="elemdef-opf-link"
                        /></literal>
                        <option>[optional]</option></para>
                </listitem>
            </varlistentry>
        </variablelist>
    </section>
    
    <section xml:id="sec-opf-metadata-dublin-core">
        <title>Package metadata</title>
        
        <section xml:id="sec-opf-metadata-dcmi-transition">
            <title>Dublin Core Metadata Vocabulary Transition</title>
            
            <para>
                This specification represents the beginning of a shift from traditional XML-based grammars to 
                RDFa vocabularies for expressing metadata. Unlike XML grammars, which intrude
                into host grammars and require specific accommodations to work, RDFa is a more natural and
                fluid means of expressing metadata, working within existing attributes to a greater degree of
                semantic richness than would otherwise be possible.
            </para>
            
            <para>
                The addition of RDFa support for the expression of metadata now allows properties from a wide 
                variety of vocabularies to be easily incorporated for expressing and refining information about the 
                package and its contents.
                RDFa properties also do not require the importing of new grammars, but allow properties to 
                be expressed via <code>meta</code> elements. (For more information, refer to the <xref
                    linkend="sec-metadata-extensibility"/>.)</para>
            
            <para>Although the requirement to include the core title, identifier and language <xref linkend="refDCMES"/>
                elements has not changed with this release, their inclusion is focused on 
                maintaining backwards compatibility during this period of transition, and their deprecation is 
                expected in a future version. Content authors are instead encouraged to begin using the new properties
                from the Dublin Core Metadata Terms (<xref linkend="refDCTERMS"/>) vocabulary, including
                the properties that supersede the required DCMES elements (see <remark role="todo">add link to override</remark>).
            </para>
        </section>
        
        <section xml:id="sec-opf-metadata-dcmes">
            <title>Legacy Dublin Core Metadata (DCMES)</title>
            
            <section xml:id="sec-opf-metadata-dcmes-intro">
                <title>Overview</title>
                <para></para>
            </section>
            
            <section xml:id="sec-opf-dcidentifier" xreflabel="dc:identifier">
                <title>The DCMES <literal>identifier</literal> Element</title>
                
                <para>Every package file must contain at least one <literal>identifier</literal> element
                    that provides an unambiguous identifier for the package, whether a string or number.
                    Multiple <literal>identifier</literal> elements are permitted, but only one can be marked as 
                    the primary identifier for the package via the <code>package</code> element's 
                    <link linkend="attrdef-unique-identifier">unique-identifier</link> attribute.
                </para>
                
                <para>The <literal>dc:identifier</literal> element may be extended by the
                    <literal>prefer</literal> attribute mechanism introduced in this
                    specification. When used, the <literal>override</literal> attribute must refer to a
                    meta element with a property value of <literal>dcterms:identifier</literal>.</para>
                
                <variablelist xreflabel="dc:identifier" role="elem-synopsis"
                    xml:id="elemdef-opf-dcidentifier">
                    <varlistentry>
                        <term>Element Name</term>
                        <listitem>
                            <para>
                                <literal>dc:identifier</literal>
                            </para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Namespace</term>
                        <listitem>
                            <para><literal>http://purl.org/dc/elements/1.1/</literal></para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Required child of <xref linkend="elemdef-opf-metadata"/>.
                                Repeatable.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            
                            <variablelist role="elem-synopsis-attlist">
                                
                                <varlistentry xml:id="attrdef-dcidentifier-id">
                                    <term>
                                        <literal>id</literal>
                                        <option>[required]</option>
                                    </term>
                                    <listitem>
                                        <para></para>
                                    </listitem>
                                </varlistentry>
                                
                                <varlistentry xml:id="attrdef-dcidentifier-override">
                                    <term>
                                        <literal>override</literal>
                                        <option>[optional]</option>
                                    </term>
                                    <listitem>
                                        <para></para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>Text</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>
            
            <section xml:id="elemdef-opf-dctitle" xreflabel="dc:title">
                <title>The DCMES <literal>title</literal> Element</title>
                <para> The required <literal>dc:title</literal> provides a title for the publication.
                    Multiple<literal> dc:title</literal> elements may appear in the
                    <literal>metadata</literal> element. When multiple <literal>dc:title</literal>
                    elements are present, and no <literal>override</literal> property refers to an
                    equivalent <literal>dcterms:title</literal>, the first <literal>dc:title</literal>
                    element should be considered primary title of the publication.</para>
                
                <variablelist xreflabel="dc:title" role="elem-synopsis">
                    <varlistentry>
                        <term>Element Name</term>
                        <listitem>
                            <para>
                                <literal>dc:title</literal>
                            </para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Namespace</term>
                        <listitem>
                            <para><literal>http://purl.org/dc/elements/1.1/</literal></para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Required child of <xref linkend="elemdef-opf-metadata"/>.
                                Repeatable.</para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <variablelist role="elem-synopsis-attlist">
                                
                                <varlistentry xml:id="attrdef-dctitle-id">
                                    <term>
                                        <literal>id</literal> [optional]</term>
                                    <listitem><para></para></listitem>
                                </varlistentry>
                                
                                <varlistentry xml:id="attrdef-dctitle-override">
                                    <term>
                                        <literal>override</literal>
                                        <option>[optional]</option>
                                    </term>
                                    <listitem><para></para></listitem>
                                </varlistentry>
                                
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    
                    
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>Text</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>
            
            <section xml:id="elemdef-opf-dclanguage" xreflabel="dc:language">
                <title>The DCMES <literal>language</literal> Element</title>
                <para> The required <literal>dc:language</literal> element indicates the default
                    language of the publication content, and must contain a value that is either a
                    2-letter language code as defined in [ISO 639-1] or a 3-letter language code as
                    defined in [ISO 639-2T], and may include an optional dash-separated country code as
                    defined in [ISO 3166].</para>
                
                <variablelist xreflabel="dc:language" role="elem-synopsis">
                    <varlistentry>
                        <term>Element Name</term>
                        <listitem>
                            <para>
                                <literal>dc:language</literal>
                            </para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Namespace</term>
                        <listitem>
                            <para><literal>http://purl.org/dc/elements/1.1/</literal></para>
                        </listitem>
                    </varlistentry>
                    
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Required child of <xref linkend="elemdef-opf-metadata"/>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <variablelist role="elem-synopsis-attlist">
                                <varlistentry xml:id="attrdef-dclanguage-override">
                                    <term>
                                        <literal>override</literal>
                                        <option>[optional]</option>
                                    </term>
                                    <listitem>
                                        <para/>
                                    </listitem>
                                </varlistentry>
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>Text</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>
            
        </section>
        
        <section xml:id="sec-metadata-extensibility" xreflabel="Metadata Extensibility Mechanism">
            <title>Metadata extensibility</title>
            <para>This specification introduces a mechanism for metadata extensibility that is modeled
                on the RDFa 1.1 profile mechanism.</para>
            <para>By utilizing the <literal>package</literal> element <literal>profile</literal>
                attribute, content authors can incorporate non-prefered metadata vocabularies as needed,
                and have access to the properties of the non-prefered vocabulary available for use
                globally in the publication package.</para>
            
        </section>
        
        <section xml:id="sec-metadata-identifiers">
            <title>Publication Identifiers</title>
            <para><remark role="todo">TODO pending finalization of WG discussion</remark></para>
            <!-- TODO reenable
                <para>The Package Document's author is responsible for choosing a
                primary identifier that is unique to one and only one particular package (i.e.,
                the set of resources referenced from the package document's manifest).</para> 
                <para role="rsconferr">Reading Systems must not fail catastrophically if they
                encounter two distinct EPUB Publications with the same purportedly unique
                primary identifier. </para>
            -->
        </section>
        
    </section>
    
    <section xml:id="sec-opf-meta" xreflabel="meta">
        <title>The <literal>meta</literal> element</title>
        
        <para>The meta element is a generic placeholder to express metadata, or further describe
            other metadata. This is accomplished by means of an RDFa 1.1 mechanism utilizing the
            required <literal>property</literal> attribute, and the optional
                <literal>about</literal> attribute. </para>
        
        <variablelist xreflabel="Meta Element" role="elem-synopsis" xml:id="elemdef-opf-meta">
            <varlistentry>
                <term>Element Name</term>
                <listitem>
                    <para>
                        <literal>meta</literal>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Occurrence</term>
                <listitem>
                    <para>As child of the <xref linkend="elemdef-opf-metadata"/> element.
                        Repeatable.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Attributes</term>
                <listitem>
                    <variablelist role="elem-synopsis-attlist">
                        <varlistentry xml:id="attrdef-meta-property">
                            <term>
                                <literal>property</literal>
                                <option>[required]</option>
                            </term>
                            <listitem>
                                <para>Specifies the by name a DCTERMS or ancillary metadata property
                                being expressed.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>                        
                        <term>
                                <literal>about</literal>
                                <option>[optional unless required]</option>
                            </term>
                            <listitem>
                                <para>A reference by id to the subject of the <literal>meta</literal> element property
                                    being expressed. Optional only when a <literal>meta</literal> element contains a
                                    non-empty child text node. When the <literal>meta</literal> element contains an
                                    empty child text-node, the about attribute is required and must
                                    contain a valid id of another meta element.</para>
                            </listitem>                            
                        </varlistentry>
                        
                    </variablelist>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Model</term>
                <listitem>
                    <para>Text or Empty.</para>
                </listitem>
            </varlistentry>
        </variablelist>


        <section xml:id="elemdef-opf-meta-property-values-dcterms">
            <title>Recognized DCTERMS values for the <literal>meta</literal> element
                    <literal>property</literal> attribute</title>
            <para>The <literal>meta</literal> element <literal>property</literal> attribute may
                contain any DCMI Metadata Terms values <xref linkend="refDCTERMS"
                />.</para>
                
             <para><xref linkend="refDCTERMS"/> properties can be further described by other <xref linkend="refDCTERMS"/> properties and
                ancillary properties defined elsewhere in this specification.</para>            
        </section>
        
        <section xml:id="elemdef-opf-meta-property-values-ancillary">
            <title>Recognized ancillary values for the <literal>meta</literal> element
                    <literal>property</literal> attribute</title>
            
            <para>This table lists <literal>meta</literal> element <literal>property</literal>
                attribute values that are defined in this specification. The metadata expressed by
                these properties describes other properties in the metadata element. These include
                properties from <xref linkend="refDCTERMS"/> as well as other ancillary properties. </para>
            
            <para>As with other metadata properties in this specification, ancillary properties
                defined in this specification can be further described by other ancillary properties
                defined elsewhere in this specification and by <xref linkend="refDCTERMS"/> properties.</para>
            
            <?insert-package-vocab-properties ancillary-props?>
            
            <remark role="todo">Where do these properties fit in in relation to the above?</remark>
            
            <?insert-package-vocab-properties meta-auth-props?>
            
        </section>
        

    
    <section xml:id="elemdef-opf-meta-property-values-package">
        <title>Recognized package level values for the <literal>meta</literal> element
            <literal>property</literal> attribute</title>
        <para>This table lists <literal>meta</literal> element <literal>property</literal>
        attribute values that describe the package.</para>
        
        <?insert-package-vocab-properties package-props?>
        
    </section>
    </section>

    <section xml:id="sec-opf-link" xreflabel="link">
        <title>The <literal>link</literal> element</title>

        <para>The <literal>link</literal> element is used to associate external metadata resources
            with the publication.</para>

        <variablelist xreflabel="link" role="elem-synopsis" xml:id="elemdef-opf-link">
            <varlistentry>
                <term>Element Name</term>
                <listitem>
                    <para>
                        <literal>link</literal>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Occurrence</term>
                <listitem>
                    <para>As a child of <xref linkend="elemdef-opf-metadata"/>. Repeatable.</para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Attributes</term>
                <listitem>
                    <variablelist role="elem-synopsis-attlist">
                        <varlistentry xml:id="attrdef-link-href">
                            <term>
                                <literal>href</literal>
                                <option>[required]</option>
                            </term>
                            <listitem>
                                <para>A valid URL [TODO RFC link] to an external metadata
                                    resource.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="attrdef-link-rel">
                            <term>
                                <literal>rel</literal>
                                <option>[required]</option>
                            </term>
                            <listitem>
                                <para>A token that describes the nature of the external resource
                                    (its relation to the publication). See further <xref
                                        linkend="elemdef-opf-link-rel-values"/>.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="attrdef-link-id">
                            <term>
                                <literal>id</literal>
                                <option>[optional]</option>
                            </term>
                            <listitem>                                
                                <xi:include href="../share/id-prose-para.xml"/>                                
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Model</term>
                <listitem>
                    <para>Empty.</para>
                </listitem>
            </varlistentry>
        </variablelist>

        <para>The resources identified by the <literal>link</literal> element <literal>href</literal> attribute are considered <glossterm
                linkend="gloss-external-resource">external resources</glossterm>, and must therefore not be identified as items in the
            <link linkend="sec-manifest-elem">manifest</link>.</para>
        
        <para>If metadata provided in an external record conflicts with metadata given inline in the
            Package Document metadata element, then the external metadata should be given
            precedence.</para>
        
        <para>Reading Systems are not required to dereference the resources identified through the <literal>link</literal> element.</para>
        
        <!-- There is no provision for specifying the version of the record (this assumes that version information is available inline in the referenced resources) -->

        <section xml:id="elemdef-opf-link-rel-values">
            <title>Recognized values for the <literal>link</literal> element <literal>rel</literal>
            attribute</title>
            
            <?insert-package-vocab-values metarec-props?>
            
            <para>The <literal>link</literal> element <literal>rel</literal> attribute may include additional tokens than the ones
                enumerated above. Such additional tokens must comply to the restrictions defined in
                    <xref linkend="sec-metadata-extensibility"/>.</para>
        </section>

        <section xml:id="sec-opf-link-examples">
            <title>The <literal>link</literal> Element: Examples</title>

            <informalexample>
                <para>The following example shows the <literal>link</literal> element used to
                    associate an ONIX record with the publication.</para>
                <synopsis>
<xi:include parse="text" href="../examples/publications/link-1.xml"/></synopsis>
            </informalexample>

            <informalexample>
                <para>The following example shows the <literal>link</literal> element used to
                    associate two external resources with the publication: an XMP record, and a link
                    to an informational web page. Note that as the <literal>foaf:homepage</literal>
                    token is <link linkend="elemdef-opf-link-rel-values">not defined by this
                        specification</link>, the <link linkend="sec-metadata-extensibility"
                        >metadata extensibility mechanism</link> is employed.</para>
                <synopsis>
<xi:include parse="text" href="../examples/publications/link-2.xml"/></synopsis>
            </informalexample>

        </section>
    </section>

    <section xml:id="sec-metadata-examples">
        <title>Metadata Examples</title>
        <para><remark role="todo">DPH TODO</remark></para>
    </section>

</section>
