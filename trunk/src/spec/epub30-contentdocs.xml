<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="../../util/docbook/schema/docbookspec.rng" type="xml"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbookspec.sch"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbook.sch"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:epub="http://www.idpf.org/2011/epub" xmlns:xi="http://www.w3.org/2001/XInclude"
    version="5.1b2">
    <title>EPUB Content Documents 3.0</title>

    <info>
        <releaseinfo>Editors Draft</releaseinfo>
        <pubdate>16 December 2010</pubdate>

        <printhistory>
            <formalpara>
                <title>This version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
            <formalpara>
                <title>Diffs to previous version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
        </printhistory>

        <copyright>
            <year>2010</year>
            <year>2011</year>
            <holder>International Digital Publishing Forumâ„¢</holder>
        </copyright>

        <legalnotice>
            <para>All rights reserved. This work is protected under Title 17 of the United States
                Code. Reproduction and dissemination of this work with changes is prohibited except
                with the written permission of the International Digital Publishing Forum.</para>
        </legalnotice>

        <authorgroup>
            <editor>
                <personname>Garth Conboy</personname>
                <affiliation>
                    <org>
                        <orgname>eBook Technologies</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>DAISY Consortium</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>William McCoy</personname>
                <affiliation>
                    <org>
                        <orgname>WebPaper LLC</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname><remark role="todo">TBD - additional editors</remark></personname>
            </editor>

        </authorgroup>

        <abstract>
            <title>Open Publication Structure 3.0</title>
            <para>EPUB Content Documents 3.0 specifies a usage of XHTML, SVG and CSS optimized for
                representation of structured, cmposable, and accessible documents. EPUB Content
                Documents 3.0 is one of a family of related specifications that comprise EPUB3. The
                EPUB3 Overview describes the overall state of EPUB3 and should be read before other
                EPUB3 documents. </para>
        </abstract>

    </info>

    <chapter xml:id="sec-overview">
        <title>Overview</title>
        <section xml:id="sec-overview-purpose-and-scope">
            <title>Purpose and Scope</title>
            <para>This specification, EPUB Content Documents 3.0, defines extension profiles of
                XHTML, SVG, and CSS optimized for representation of structured, composable, and
                accessible documents. This specification is one of a family of related
                specifications that comprise EPUB3, the third major revision of an interchange and
                delivery format for digital publications based on XML and Web Standards. </para>
            <para>This document is meant to be read and understood in concert with the other
                documents that make up EPUB3. The EPUB3 Overview <xref linkend="refEPUB3Overview"/>,
                which provides an informative overview of EPUB and a roadmap to the rest of the
                EPUB3 documents, should be read first.</para>
        </section>
        <section xml:id="sec-overview-relationship">
            <title>Relationship to Other Specifications</title>
            <para>This specification relies on several building-block specifications. The XHTML
                vocabulary is defined by HTML5 <xref linkend="refHTML5"/> , and by default all
                terminology used in this specification has the same meaning as its use therein. This
                specification also relies on XML Namespaces <xref linkend="refXMLNamespaces"/>, and
                in this specification the term "XML namespace" (or just "namespace") has the meaning
                defined in that specification. Additionally, this specification defines rules for
                CSS style sheets based on CSS 2.1 and certain CSS 3 modules.</para>
            <para>This specification supersedes </para>
            <para>
                <remark role="todo"><remark role="todo">TODO: enumerate other dependent specs
                    </remark>TODO: statement about layered use of terminology from other dependent
                    specs </remark>
                <remark role="todo">TODO: statement about conformance requirements based on
                    dependent specs<remark role="todo">TODO: make this a list not prose
                        paragraphs</remark></remark>
            </para>
        </section>

        <xi:include href="./share/terminology.xml"/>
        <!-- TODO lift over any terms below not in xinclude above -->
        <!-- <section xml:id="sec-overview-terminology">
            <title>Terminology</title>
            <glosslist>
                <glossentry xml:id="gloss-epub-publication">
                    <glossterm>EPUB Style Sheet (or Style Sheet)</glossterm>
                    <glossdef>
                        <xi:include href="./share/term-epub-style-sheet-prose-para.xml"/>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>XHTML Content Document</glossterm>
                    <glossdef>
                        <para>An XML Document conformant with the constraints of version 5 of the
                            XML serialization of HTML (XHTML5) <xref linkend="refHTML5"/>, which
                            adheres to additional restrictions and may contain additional constructs
                            as defined by this specification.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>SVG Content Document</glossterm>
                    <glossdef>
                        <para>An XML Document conformant with the constraints of Scalable Vector
                            Graphics 1.1 <xref linkend="refSVG"/>, which adheres to additional
                            restrictions and may contain additional constructs as defined by this
                            specification.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>EPUB Content Document (or Content Document)</glossterm>
                    <glossdef>
                        <xi:include href="./share/term-epub-content-doc-prose-para.xml"/>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>User Agent</glossterm>
                    <glossdef>
                        <xi:include href="./share/term-user-agent-prose-para.xml"/>
                    </glossdef>
                </glossentry>
            </glosslist>
        </section> -->

        <section xml:id="sec-overview-conformance">
            <title>Conformance</title>
            <xi:include href="./share/conformancestatements.xml"/>
        </section>

    </chapter>

    <chapter xml:id="sec-opf-introduction">
        <title>Introduction to Content Documents</title>
        <para>This specification defines extension profiles of XHTML5, SVG, and CSS, and an
            associated simplified User Agent procesing model, intended to facilitate representation
            of structured, accessible documents that may be composed together and presented to users
            in a variety of manners as part of an overall publication. <remark role="todo">TODO: a
                number of referenced specifications are still under development (e.g. CSS3 modules).
                We have a strategy to deal with this en route to finalizing EPUB3; meanwhile, we are
                for now being "profligate" with references to such unfinished
                specifications.</remark></para>
        <section xml:id="sec-ocf-overview-intro">
            <title>Relationship to HTML</title>


            <para>This specification defines upwardly compatible optional extensions to of <xref
                    linkend="refHTML5"/> and <xref linkend="refCSS"/>.. Because the extensions are
                optional, every conforming XHTML5 document is a conforming EPUB XHTML Content
                Document as defined herein, and every style sheet conformant with CSS 2.1 is a valid
                EPUB3 Style Sheet. Optionally, EPUB XHTML Content Documents and EPUB Style Sheets
                may utilize additional constructs as defined in this specification. (EPUB XHTML
                Content Documents are a subset of <xref linkend="refHTML5"/> only in the sense that
                use of the XHTML serialization is required).</para>
            <para>Since EPUB XHTML Content Documents are XHTML5 documents with optional namespaced
                extensions it is completely legitimate to process them according to the processing
                model defined for HTML5 (which is defined to require User Agents to ignore the
                additional namespaced elements and attributes). </para>
            <para>This specification defines a simplified processing model that does not require
                support for scripting or a DOM, further constraining the requirements given in the
                HTML5 specification. Any User Agent conformant with this specification must be able
                to process any conforming EPUB Content Document according to this specification, but
                it is not presumed that such User Agents will necessarily be in full conformance
                with HTML5, i.e. they may not implement the complete processing model of HTML5.
            </para>
        </section>
        <section xml:id="sec-overview-svg-relationship">
            <title>Relationship to SVG </title>
            <para>This specification does not define any extensions to <xref linkend="refSVG"/>, but
                imposes the restriction that in SVG Content Documents, embedded flow content is
                limited to XHTML5 (i.e. arbitrary XML is disallowed).</para>
        </section>
        <section xml:id="sec-overview-css-relationship">
            <title>Relationship to CSS </title>
            <para>Content Documents may reference style sheets or include inline style information.
                The style sheet language defined by this specification is based on CSS 2.1, and any
                style sheet content legitimate in CSS 2.1 may appear in a style sheet utilized by a
                Content Document. In addition, this specification incorporates several style
                capabilities defined by CSS3 Modules, and defines several additional vendor-specific
                CSS constructs </para>
        </section>
        <section xml:id="sec-example-doc">
            <title>Example Content Document</title>
            <para>This section is non-normative, showing an EPUB Content Document that utilizes
                ...</para>
            <itemizedlist>
                <listitem>
                    <para>Hello World</para>
                </listitem>
                <listitem>
                    <para>Another?</para>
                </listitem>
            </itemizedlist>
        </section>
    </chapter>
    <chapter xml:id="sec-contentdocs">
        <title>XHTML5 Content Documents</title>
        <para><remark role="todo">TODO: Format this sections like HTML5 spec</remark></para>
        <section xml:id="sec-additional_constructs">
            <title>Additional Language Constructs</title>
            <para>Any conformant XHTML5 document can be considered to be a conformant XHTML5 Content
                Document according to this specification, so long as its uses and references to
                styles conform to the EPUB Style Sheet rules described in the following chapter. In
                addition, a Content Document may utilize several additional constructs, these
                include: </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>type attribute</para>
                    </listitem>
                    <listitem>
                        <para>trigger elements</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>In the following section and its subsections, all elements and attributes defined
                are in the "http://www.idpf.org/2011/epub" namespace unless otherwise specified. For
                convenience the prefix "epub" is used as the namespace prefix for
                "http://www.idpf.org/2011/epub".</para>
            <para>Since these constructs are namespace-qualified, XHTML5 Content Documents should be
                successfully processed by XHTML User Agents, as they are required to ignore unknown
                namespace-qualified elements and attributes.</para>
            <para>The following sections specify these constructs in more detail.</para>
            <section xml:id="sec-contentdocs-semantic-inflection">
                <title>Semantic inflection: the <code>epub:type</code> and <code>rel</code>
                    attributes</title>
                <para>The <code>epub:type</code> and <code>rel</code> attributes are used for
                    semantic inflection of elements in the document structure, allowing the author
                    to annotate elements with machine-extractable information about their specific
                    purpose and/or nature.</para>
                <para>This specification uses a subset of the vocabulary association mechanism
                    defined by <xref linkend="refRDFa11Core"/> as the value provision mechanism for
                    the <code>epub:type</code> and <code>rel</code> attributes. </para>
                <section xml:id="sec-xhtml-content-type-attribute">
                    <title>The <code>epub:type</code> attribute</title>
                    <variablelist xreflabel="epub:type" role="elem-synopsis"
                        xml:id="attrdef-epub-type">
                        <varlistentry>
                            <term>Attribute Name</term>
                            <listitem>
                                <para><literal>type</literal></para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attribute Namespace</term>
                            <listitem>
                                <para><literal>http://www.idpf.org/2011/epub</literal></para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Occurrence</term>
                            <listitem>
                                <para>Common, may be specified on all <link
                                        xlink:href="http://www.w3.org/TR/html5/infrastructure.html#html-elements"
                                        >HTML elements</link>.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>CURIEs <xref linkend="refRDFa11Core"/> with restrictions given
                                    below</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                    <para>The <code>epub:type</code> attribute is intended to be functionally
                        equivalent to the W3C Role Attribute <xref linkend="refPFRoleAttribute"/>,
                        but with restrictions as specified in <xref
                            linkend="sec-contentdocs-vocab-association"/>. </para>
                    <para>
                        <remark role="todo">NOTE: pending finalization of discussions with the W3C,
                            the epub:type attribute may be replaced by a reference to the <link
                                xlink:href="http://www.w3.org/WAI/PF/role-attribute/">PF Role
                                Attribute</link>, although the restrictions below would be
                            retained.</remark>
                    </para>
                </section>
                <section xml:id="sec-contentdocs-vocab-association">
                    <title>Vocabulary association</title>
                    <para>The following restrictions apply to the prefix mapping mechanisms of
                            <code>epub:type</code> and <code>rel</code> as compared to their
                        definitons in <xref linkend="refPFRoleAttribute"/> and <xref
                            linkend="refRDFa11Core"/> respectively:</para>
                    <itemizedlist>
                        <listitem>
                            <para>The use of <code>xmlns</code> to establish prefix mappings is not
                                allowed; the <code>profile</code> and <code>prefix</code> attributes
                                    <xref linkend="refRDFa11Core"/> must be used instead</para>
                        </listitem>
                        <listitem>
                            <para>The <code>profile</code> and <code>prefix</code> attributes are
                                only allowed on the document root element</para>
                        </listitem>
                        <listitem>
                            <para>The <code>profile</code> attribute has the fixed value of
                                    <literal>http://www.idpf.org/TODO/profiles/structure/</literal></para>
                        </listitem>
                        <listitem>
                            <para>Prefix mappings established in the profile defined above must not
                                be overriden locally in document instances</para>
                        </listitem>
                        <listitem>
                            <para>The <code>epub:type</code> attribute value must conform to the
                                    <code>CURIEs</code> datatype. <xref linkend="refRDFa11Core"
                                /></para>
                        </listitem>
                    </itemizedlist>
                    <para>Given the restrictions above, all EPUB3 Publications will have the
                        following properties in common:</para>
                    <itemizedlist>
                        <listitem>
                            <para>All EPUB3 Publications (via the fixed URI in the
                                    <code>profile</code> attribute on the document root element)
                                refer to the same profile document</para>
                        </listitem>
                        <listitem>
                            <para>The profile document defines a default vocabulary (i.e. the
                                vocabulary whose properties are referred to without a prefix), which
                                is the vocabulary located at
                                    <literal>http://www.idpf.org/TODO/vocab/structure/</literal>.
                                The default vocabulary is fixed, and must not be overridden in
                                instances. </para>
                        </listitem>
                        <listitem>
                            <para>The profile document associates the prefix <code>xhv</code> to the
                                XHTML Vocabulary <xref linkend="refXHTMLVocab"/>. This prefix
                                mapping is fixed, and must not be overridden in instances</para>
                        </listitem>
                        <listitem>
                            <para>The establishment of prefix mappings additional to those in the
                                profile document is done exclusively using the root element
                                    <code>prefix</code> attribute</para>
                        </listitem>
                    </itemizedlist>
                </section>
                <section xml:id="sec-contentdocs-semantic-inflection-processing-reqs">
                    <title>The <code>epub:type</code> and <code>rel</code> attributes: processing
                        requirements</title>
                    <para>User agents must process the <code>epub:type</code> and <code>rel</code>
                        attributes as follows:</para>
                    <itemizedlist>
                        <listitem>
                            <para>A User Agent may associate specialized behaviors with none, some
                                or all of the properties given in the default vocabulary.</para>
                        </listitem>
                        <listitem>
                            <para>A User Agent may associate specialized behaviors with properties
                                given in vocabularies other than the default one.</para>
                        </listitem>
                        <listitem>
                            <para>A User Agent may support the dereferencing of unrecognized CURIEs
                                occurring in the <code>epub:type</code> and <code>rel</code>
                                attributes. If a User Agent successfully dereferences an
                                unrecognized CURIE, it may (depending on the information available
                                in the referenced vocabulary property) employ adaptive behaviors in
                                response to the change to the document structural semantics that
                                results from the CURIE dereferencing.</para>
                        </listitem>
                        <listitem>
                            <para>If the attempt to dereference an unrecognized CURIE fails, or if
                                the dereferencing of unrecognized CURIEs is not supported, then the
                                User Agent must ignore the given unrecognized CURIE and continue
                                processing the <code>epub:type</code> or <code>rel</code>
                                attribute.</para>
                        </listitem>
                        <listitem>
                            <para>When User Agent behavior associated with a given CURIE conflicts
                                with behavior associated with the carrying XHTML element, then the
                                behavior associated with the element must take precedence.</para>
                        </listitem>
                    </itemizedlist>
                </section>
                <section xml:id="examples-semantic-inflection">
                    <title>Semantic inflection: examples</title>
                    <informalexample>
                        <para>The following example shows the <code>rel</code> and
                                <code>epub:type</code> attributes used to inflect footnote and note
                            reference semantics. The property used is defined in the default
                            vocabulary. </para>
                        <synopsis>
<xi:include href="./examples/contentdocs/epub-type-1.xml" parse="text"/></synopsis>
                    </informalexample>
                </section>
            </section>
            <section xml:id="sec-spine-elem">
                <title>The <literal>epub:trigger</literal> element</title>
                <para>The <code>trigger</code> element associates an <code>event</code> from a
                    specified source object (<code>observer</code>) with a desired action to be
                    performed with a specified target object (<code>ref</code>), enabling
                    content-provided user interface for controlling multimedia objects such as audio
                    and video playback even in a non-scripted context.</para>
                <variablelist xreflabel="spine" role="elem-synopsis" xml:id="elemdef-opf-spine">
                    <varlistentry>
                        <term>Element name</term>
                        <listitem>
                            <para><literal>trigger</literal></para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Occurrence</term>
                        <listitem>
                            <para>Where metadata content is expected.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Attributes</term>
                        <listitem>
                            <variablelist role="elem-synopsis-attlist">
                                <varlistentry xml:id="attrdef-global">
                                    <term><literal>Global Attributes.</literal>
                                        <option>[optional]</option></term>
                                    <listitem>
                                        <para/>
                                    </listitem>
                                </varlistentry>
                                <varlistentry xml:id="attrdef-action">
                                    <term><literal>action</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>Legal values:
                                                <code>show</code>|<code>hide</code>|<code>play</code>|<code>pause</code>|<code>resume</code>|<code>mute</code>|<code>unmute</code>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><literal>ref</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>relative URL to the element which is an object of an
                                            action (#id form)</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><literal>ev:event</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>applicable event for this trigger as defined in [XML
                                            Events]</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><literal>ev:observer</literal>
                                        <option>[required]</option></term>
                                    <listitem>
                                        <para>source object for this trigger as defined in [XML
                                            Events]</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Model</term>
                        <listitem>
                            <para>Empty.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <para>The <code>trigger</code> element associates an <code>event</code> from a
                    specified source object (<code>observer</code>) with a desired action to be
                    performed with a specified target object (<code>ref</code>), enabling
                    content-provided user interface for controlling multimedia objects such as audio
                    and video playback even in a non-scripted context. The semantics of the defined
                        <code>action</code> values are: <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">show</emphasis> - element's visibility
                                property is set to visible</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">hide</emphasis>: element's visibility
                                property is set to hidden</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">play</emphasis>: play from the beginning
                                (only applicable to video or audio elements)</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">pause</emphasis>: pause playing (only
                                applicable to video or audio elements)</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">resume</emphasis>: resume playing (only
                                applicable to video or audio elements)</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">mute</emphasis> - mute sound (only
                                applicable to video or audio elements)</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">unmute</emphasis>: unmute sound (only
                                applicable to video or audio elements)</para>
                        </listitem>
                    </itemizedlist><remark role="todo">TODO: example - image button controlling
                        video pause/resume</remark>
                </para>
                <para>User Agents that support video or audio playback must support the
                        <code>epub:trigger</code> element.</para>
            </section>
        </section>
        <section xml:id="sec-xhtml-mathml">
            <title>MathML Support</title>
            <para>XHTML Content Documents may include, and User Agents must support, MathML content
                as defined in <xref linkend="refHTML5"/>, subject to the further restrictions
                specified in this section.</para>
            <para>XHTML Content Documents are required to limit usage of MathML to a restricted
                subset of the support defined in <xref linkend="refHTML5"/>, as defined in the
                following subsections. This subset is designed to ease the implementation burden on
                User Agents and promote accessibility, while retaining compatibility with HTML5 User
                Agents. These restrictions limit the MathML to presentation MathML except inside of
                a semantics element. They also provide guidelines on how fall back images and
                alternative text should be given.</para>
            <section xml:id="sec-xhtml-mathml-content">
                <title>Content MathML</title>
                <para>All content MathML elements shalll be inside of an
                        <literal>annotation-xml</literal> element. The <code>annotation-xml</code>
                    element shall be the second child of a semantics element whose first child is
                    presentation MathML. The <code>annotation-xml</code> element shall set the
                    encoding attribute to <code>"MathML-Content"</code> or to
                        <code>"application/mathml-content+xml"</code>. These two values are
                    equivalent. The value of the name attribute shall be
                    <code>"contentequiv"</code>. </para>
            </section>
            <section xml:id="sec-annot-types">
                <title>Annotation Types</title>
                <para>Legal <literal>annotation</literal> and <literal>annotation-xml</literal>
                    attributes and content are restricted in the following ways:</para>
                <itemizedlist>
                    <listitem>
                        <para>The value for the content dictionary must be
                                <literal>mathmlkeys</literal></para>
                    </listitem>
                    <listitem>
                        <para>The values for <literal>name</literal> must be
                                <literal>alternate-representation</literal> or
                                <literal>contentequiv</literal></para>
                    </listitem>
                    <listitem>
                        <para>The values for <literal>encoding</literal> for
                                <literal>annotation-xml</literal> should be
                                <literal>MathML-Content/application/mathml-content+xml</literal> or
                                <literal>application/xhtml+xml</literal> When the latter is
                            specified, the content must be conformant with this XHTML Content
                            Document specification content, with the further restrictions that it
                            must have the same flow model (block or inline) as the parent MathML,
                            and must not itself contain MathML content</para>
                    </listitem>
                </itemizedlist>

            </section>
            <section xml:id="sec-fallback-images">
                <title>Fallback Images</title>
                <para>Fallback images should be provided on the math element or on annotation.
                    Preference order for fallback is: annotation, math (altimg).</para>
                <para>In the context of EPUB, content conformance and fallback processing rules for
                    such fallback images in MathML content are defined as the same as defined for
                    the <code>&lt;img></code> element, as more specifically described in
                    [Publication3].</para>
            </section>
        </section>

        <section xml:id="sec-xhtml-overview-examples">
            <title>Restriction on Unicode Private Use Characters</title>
            <para>Any text characters in a Content Document (XHTML or SVG) that map to a code point
                within one of the Private Use Area (PUA) ranges as defined in [Unicode] must ocur
                within a string that is styled or attributed in a manner that includes a reference
                to an embedded font that contains an appropriate glyph for that code point. </para>
        </section>
        <section xml:id="sec-xhtml-alternate-style-tags">
            <title>Alternate Style Tags</title>
            <para>In accordance with <xref linkend="refAlternateStyleTags"/> , the
                    <literal>class</literal> attribute of the <literal>link</literal> element is
                considered to have four values with pre-assigned semantics as denoted in that
                specification: <literal>horizontal</literal>, <literal>vertical</literal>,
                    <literal>day</literal>, and <literal>night</literal>. </para>
            <para>User Agents should select and utilize such tagged style sets as appropriate, as
                further discussed in that specification.</para>
        </section>
        <section xml:id="sec-xhtml-resource-refs">
            <title>Resource References</title>
            <para>In the context of EPUB, relative references to resources including but not limited
                to <code>src</code> attributes of <code>img</code>, <code>object</code>, and
                    <code>iframe</code> elements must correspond to manifest items and otherwise
                follow the rules defined for Core Media Types and fallback processing in
                [Publications3]. The <code>src</code> atribute of any <code>iframe</code> element
                must reference an XHTML Content Document as defined herein.</para>
        </section>
        <section xml:id="sec-xhtml-discouraged">
            <title>Discouraged Constructs</title>
            <para>A number of elements and attributes defined in<xref linkend="refHTML5"/> are
                present primary for backwards-compatibility with User Agents compatible with HTML4
                or earlier versions. Use of the constructs detailed below in Content Documents is
                strongly discouraged. </para>
            <section xml:id="sec-xhtml-discouraged-rp">
                <title><code>rp</code> element</title>
                <para>The <code>rp</code> element is intended to provide for an optional parenthesis
                    display around ruby markup by older version User Agents that do not support
                    ruby. HTML5 User Agents would be expected to simply ignore occurances of
                        <code>rp</code>, so use in Content Documents is discouraged.</para>
            </section>
        </section>
        <section xml:id="sec-xhtml-scripting">
            <title>Scripting Support</title>
            <para>Any XHTML Content Document may contain script elements; however, it is expected
                that by default EPUB User Agents will not be script-enabled. In order to request
                scripting for an XHTML Content Document, the "scripted" property must be set on the
                corresponding manifest item. See <xref linkend="refPublications3"/> for more
                information</para>



        </section>
        <section xml:id="sec-xhtml-overview-conformance">
            <title>User Agent Conformance Requirements</title>
            <para><remark role="todo">TODO</remark></para>



        </section>
        <section xml:id="sec-xhtml-schema">
            <title>Schema Information</title>
            <para>An informative RelaxNG schema for XHTML Content Documents can be obtained at
                    <remark role="todo">TODO</remark>
            </para>

        </section>
    </chapter>

    <chapter xml:id="sec-svg">
        <title>SVG Content Documents</title>
        <para>SVG affords a means to represent final-form vector graphics and text. SVG may appear
            in XHTML Content Documents, either as the resource for an image or inline as defined by
                <xref linkend="refHTML5"/>. As well, SVG can be an alternative to XHTML in certain
            circumstances, such as when final-form page images are the only suitable representation
            of content (such as "manga" or comic books). </para>

        <section xml:id="sec-svg-embedded-content">
            <title>Embedded Content</title>
            <para><remark role="todo">TODO: similar requirement to MathML wrt embedded flow content
                    in SVG</remark></para>
        </section>

    </chapter>
    <chapter xml:id="sec-css">
        <title>EPUB3 CSS Profile</title>
        <!-- probably most <literal>s here should be <property> -->
        <para>This section defines a profile for Cascading Style Sheets (CSS) that may be included
            in or referenced by XHTML Content Documents. User Agents conformant with this
            specification should support these CSS features as defined below. XHTML Content
            Documents may utilize any CSS constructs defined in this section, with the proviso that
            User Agents conformant to this specification may ignore some or all style information,
            and are likely to render in a manner that differs from typical HTML5 User Agents (e.g.
            paginating content rather than providing a infinitely scrolling surface). <remark
                role="todo">TODO: Figure out correct interaction of this section with
            SVG.</remark></para>
        <para role="uaconf">The statement that an EPUB Style Sheet may include a feature implies,
            unless otherwise specified, that a Reading System must accept, and may support (process
            in rendering), the feature. In all cases the parsing of CSS files and ignoring of
            unsupported features must conform to the CSS specifications, e.g. <link
                xlink:href="http://www.w3.org/TR/CSS21/conform.html#ignore">as defined</link> in
                <xref linkend="refCSS"/>.</para>
        <para><remark role="note">EPUB3 references W3C specifications that are still works in
                progress and may change in incompatible ways. Authors should consider the risk of
                such changes and their potential impact on document longevity when choosing features
                from such specifications.</remark></para>
        <section xml:id="sec-css-2.1">
            <title>CSS 2.1</title>
            <para>The style baseline in EPUB3 is Cascading Style Sheets Level 2 Revision 1 ( <xref
                    linkend="refCSS"/> ). An EPUB Style Sheet may include, and a User Agent must
                accept, all style sheet constructs normatively defined in <xref linkend="refCSS"/>,
                with the following exceptions:</para>
            <itemizedlist>
                <listitem>
                    <para>The <literal>fixed</literal> value of the <literal>position</literal>
                        property is not included as part of EPUB3 and therefore must not be used
                        EPUB Style Sheets.</para>
                </listitem>
                <listitem>
                    <para>The <literal>direction</literal> and <literal>unicode-bidi</literal>
                        properties are not included in EPUB Style Sheets. It is non-conforming to
                        use these properties in an XHTML Content Document. Authors should use
                        appropriate XHTML markup, such as the <literal>dir</literal> attribute and
                        the <literal>bdo</literal> element, instead.</para>
                </listitem>
            </itemizedlist>
            <para>User Agents must support the <literal>font-family</literal> property.</para>
            <para>NOTE: The ability of User Agents to paginate absolutely positioned layouts is not
                guaranteed, and thus the reliance on absolutely positioned layouts is discouraged.
                    <remark role="todo">???</remark> User Agents may choose not to support these
                property values.</para>
        </section>
        <section xml:id="sec-css-voice-characteristics">
            <title>CSS Speech</title>
            <para>EPUB Style Sheets may include all features defined in the CSS Speech Module (
                    <xref linkend="refCSS3Speech"/>). Reading Systems that support text-to-speech
                should support in particular the following properties:</para>
            <itemizedlist>
                <listitem>
                    <para><literal>voice-family</literal></para>
                </listitem>
                <listitem>
                    <para><literal>pause</literal></para>
                </listitem>
                <listitem>
                    <para><literal>cue</literal></para>
                </listitem>
                <listitem>
                    <para><literal>rest</literal></para>
                </listitem>
                <listitem>
                    <para><literal>speak</literal></para>
                </listitem>
            </itemizedlist>
        </section>
        <section xml:id="sec-css-fonts">
            <title>CSS Fonts Level 3</title>
            <!-- jdaggett, editor of CSS3 Fonts, believes the below-referenced @font-face portion of
                 CSS3 Fonts to be stable. Other parts of the CSS3 Fonts spec are not yet stable.
                 2011-01-11 -->
            <para>EPUB Style Sheets may include <literal>@font-face</literal> rules as defined in
                the CSS Fonts Module Level 3 ( <xref linkend="refCSS3FontsModule"/> ) specification.
                Reading Systems must support the embedding of both WOFF and OpenType fonts with the
                    <literal>@font-face</literal> rule and must support at least the following
                    <literal>@font-face</literal> font descriptors:</para>
            <itemizedlist>
                <listitem>
                    <para><literal>font-family</literal></para>
                </listitem>
                <listitem>
                    <para><literal>src</literal></para>
                </listitem>
                <listitem>
                    <para><remark role="todo"><literal>unicode-range</literal>?</remark></para>
                </listitem>
                <listitem>
                    <para><literal>font-size</literal></para>
                </listitem>
                <listitem>
                    <para><literal>font-style</literal></para>
                </listitem>
                <listitem>
                    <para><literal>font-variant</literal> (<literal>normal</literal> and
                            <literal>small-caps</literal> values only)</para>
                </listitem>
                <listitem>
                    <para><literal>font-weight</literal></para>
                </listitem>
            </itemizedlist>
            <para>Reading Systems may additionally support the <literal>@font-face</literal>
                embedding of SVG Fonts.</para>
        </section>
        <section xml:id="sec-css-text">
            <title>CSS Text Level 3</title>
            <para>EPUB Style Sheets may include the following properties defined in the CSS Text
                Level 3 ( <xref linkend="refCSS3Text"/> ) specification:</para>
            <itemizedlist>
                <listitem>
                    <para><literal>line-break</literal></para>
                </listitem>
                <listitem>
                    <para><literal>punctuation-trim-start</literal></para>
                </listitem>
                <listitem>
                    <para><literal>text-align-last</literal></para>
                </listitem>
                <listitem>
                    <para><literal>text-emphasis</literal></para>
                </listitem>
                <listitem>
                    <para><literal>text-emphasis-style</literal></para>
                </listitem>
                <listitem>
                    <para><literal>text-emphasis-color</literal></para>
                </listitem>
                <listitem>
                    <para><literal>text-transform</literal></para>
                </listitem>
                <listitem>
                    <para><literal>word-break</literal></para>
                </listitem>
                <listitem>
                    <para><literal>hypenation-stuff</literal></para>
                </listitem>
            </itemizedlist>
        </section>
        <section xml:id="sec-css-writing-modes">
            <title>CSS Writing Modes</title>
            <para>EPUB Style Sheets may include all of the features defined in the CSS Writing Modes
                Module Level 3 ( <xref linkend="refCSS3WritingModesModule"/> ) specification except
                for the <literal>direction</literal> and <literal>unicode-bidi</literal> properties.
                It is non-conforming to use these properties in an XHTML Content Document. Authors
                should use appropriate XHTML markup, such as the <literal>dir</literal> attribute
                and the <literal>bdo</literal> element, instead.</para>
        </section>
        <section xml:id="sec-css-media-queries">
            <title>Media Queries</title>
            <para>EPUB Style Sheets may include <literal>@media</literal> rules with media queries
                as defined in the Media Queries ( <xref linkend="refMediaQueries"/> )
                specification.</para>
        </section>
        <section xml:id="sec-css-multi-column">
            <title>CSS Multi-Column Layout</title>
            <para>EPUB Style Sheets may include all of the features defined in the CSS Multi-column
                Layout Module ( <xref linkend="refCSS3Multicol"/> ) specification with the exception
                of the <literal>column-span</literal> property. </para>
            <para><remark role="note">Authors should not rely on column behavior in overflow
                    conditions as this behavior is unstable and may change.</remark></para>
            <para><remark role="note">Pagination algorithms are not fully defined in CSS. Therefore
                    authors should expect exact pagination poins to vary from Reading System to
                    Reading System.</remark></para>
            <para>Reading Systems must treat the <literal>oeb-column-number</literal> property as an
                alias for the <literal>column-count</literal> property. <remark role="note">NOTE:
                    Its use in content is deprecated and this conformance requirement will be
                    removed in the next version of EPUB).</remark></para>
        </section>
        <section xml:id="sec-css-ruby-position">
            <title>Ruby Positioning</title>
            <para>EPUB Style Sheets may include the <literal>-epub3-ruby-position</literal> property
                as defined below:</para>

            <informaltable>
                <thead>
                    <tr>
                        <td>Name:</td>
                        <td>-epub-ruby-position</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Value:</td>
                        <td>over | under | <remark role="todo">right</remark></td>
                    </tr>
                    <tr>
                        <td>Initial:</td>
                        <td>over</td>
                    </tr>
                    <tr>
                        <td>Applies to:</td>
                        <td>ruby text elements</td>
                    </tr>
                    <tr>
                        <td>Inherited:</td>
                        <td>yes</td>
                    </tr>
                    <tr>
                        <td>Percentages:</td>
                        <td>N/A</td>
                    </tr>
                    <tr>
                        <td>Media:</td>
                        <td>visual</td>
                    </tr>
                    <tr>
                        <td>Computed value:</td>
                        <td>as specified</td>
                    </tr>
                </tbody>
            </informaltable>
            
            <para>This property controls the placement of ruby text with respect to its base text.
                Values have the following meanings:</para>

            <variablelist>
                <varlistentry>
                    <term><literal>over</literal></term>
                    <listitem><para>Ruby text is positioned on the
                        <link xlink:href="http://www.w3.org/TR/css3-writing-modes/#over">over</link>
                        side of the ruby base.</para></listitem>
                </varlistentry>
                <varlistentry>
                    <term><literal>under</literal></term>
                    <listitem><para>Ruby text is positioned on the
                        <link xlink:href="http://www.w3.org/TR/css3-writing-modes/#under">under</link>
                        side of the ruby base.</para></listitem>
                </varlistentry>
                <varlistentry>
                    <term><literal>right</literal></term>
                    <listitem><para>Ruby text is positioned on the right side of the base text.
                        (This value is typically used for Zhuyin Fuhao (Bopomofo) ruby.)</para>
                        <para><remark role="todo">Need a name that avoids misuse in vertical text
                            when <literal>over</literal> is intended.</remark></para></listitem>
                </varlistentry>
            </variablelist>

            <para><remark role="note">NOTE: This property will become an alias for the
                        <literal>ruby-position</literal> property in the CSS Ruby Module ( <xref
                        linkend="refCSS3Ruby"/> ).</remark></para>
        </section>
        <section xml:id="sec-css-oeb-head-foot">
            <title>Display Property Values <code>oeb-page-head</code> and
                <code>oeb-page-foot</code></title>
            <para>In addition to the standard values defined for the <code>display</code> property
                in <xref linkend="refCSS"/> (<link
                    xlink:href="http://www.w3.org/TR/CSS2/visuren.html#display-prop">Section
                    9.2.4</link>), EPUB Style Sheets may specify the values
                    <literal>oeb-page-head</literal> and <literal>oeb-page-foot</literal>. </para>
            <para>Reading Systems should present the content of an element assigned <code>display:
                    oeb-page-head</code> only as a header, and the content of an element assigned
                    <code>display: oeb-page-foot</code> only as a footer. Neither should be simply
                presented as if it were <code>inline</code> or <code>block</code>. Reading Systems,
                however, are free to present headers and footers either in special areas as usual
                for paper publications, or to make them available in another way. For example, a
                device with a small screen might instead pop them up on demand. </para>
            <para>For purposes of page layout, these display values are similar to block boxes with
                an absolute position (i.e. a position value of fixed or absolute). That is, they are
                removed from the normal flow and a new block box is created with its own flow.
                Margins, padding, and other block characteristics are determined as if the element
                had <code>position: fixed</code> set. </para>
            <para>An element assigned <code>display: oeb-page-head</code> or <code>display:
                    oeb-page-foot</code> shall not be considered in effect while any preceding
                content remains presented, and shall remain in effect until another header or footer
                respectively is in effect instead, or until no part of its parent element remains
                presented, whichever occurs first.. For example, when rendered to a screen with
                appropriate style settings, the myhead-classed div element below would become the
                page header as soon as nothing preceding the containing div is displayed and go out
                of effect when that div is no longer visible: <remark role="toto">WM: what if there
                    is content IN the containing div preceding the header - is that "preceding
                    content"?</remark></para>
            <para>
                <informalexample>
                    <synopsis>
 &lt;div>
   &lt;div class="myhead" style="display: oeb-page-head">
      The OEB Publication Structure: Introduction
   &lt;/div>
   &lt;h2>Introduction&lt;/h2>
   &lt;p>...&lt;/p>
&lt;/div>           
            
        </synopsis>
                </informalexample>
            </para>
        </section>

    </chapter>

    <appendix xml:id="acknowledgements" role="acknowledgements" conformance="informative">
        <title>Contributors</title>
        <xi:include href="./share/contributors.xml"/>
    </appendix>

    <xi:include href="./share/references.xml"/>
</book>
