<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../util/docbook/schema/docbookspec.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="../../util/docbook/schema/docbookspec.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<?xml-model href="../../util/docbook/schema/docbook.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:epub="http://www.idpf.org/2011/epub" xmlns:xi="http://www.w3.org/2001/XInclude"
    version="5.1">
    <title>EPUB Content Documents 3.0</title>

    <info>
        <releaseinfo>Recommended Specification</releaseinfo>
        <pubdate>11 October 2011</pubdate>
        <printhistory>
            <formalpara>
                <title>This version</title>
                <para>
                    <link
                        xlink:href="http://www.idpf.org/epub/30/spec/epub30-contentdocs-20111011.html"
                    />
                </para>
            </formalpara>
            <formalpara>
                <title>Latest version</title>
                <para>
                    <link xlink:href="http://www.idpf.org/epub/30/spec/epub30-contentdocs.html"/>
                </para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para>
                    <link
                        xlink:href="http://www.idpf.org/epub/30/spec/epub30-contentdocs-20110908.html"
                    />
                </para>
            </formalpara>
        </printhistory>
        <releaseinfo role="errata"> Please refer to the <link
        	xlink:href="./epub30-contentdocs-errata/">errata</link> for this document, which may
            include some normative corrections. </releaseinfo>
        <releaseinfo role="diff"> A diff of changes from the previous draft is available at <link
            xlink:href="http://code.google.com/p/epub-revision/source/diff?spec=svn3218&amp;old=3183&amp;r=3218&amp;format=side&amp;path=%2Ftrunk%2Fsrc%2Fspec%2Fepub30-contentdocs.xml"
                >this link</link>. </releaseinfo>
        <xi:include href="./share/copyright.xml"/>
        <xi:include href="./share/legalnotice.xml"/>
        <authorgroup role="current">
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>DAISY Consortium</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>William McCoy</personname>
                <affiliation>
                    <org>
                        <orgname>International Digital Publishing Forum (IDPF)</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Elika J. Etemad</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Matt Garrish</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
        </authorgroup>

        <!-- <abstract>
            <title>Open Publication Structure 3.0</title>
            <para>EPUB Content Documents 3.0 specifies a usage of XHTML, SVG and CSS optimized for
                representation of structured, composable, and accessible documents. EPUB Content
                Documents 3.0 is one of a family of related specifications that comprise EPUB 3. The
                EPUB 3 Overview describes the overall state of EPUB 3 and <literal role="rfc2119">should</literal> be read before other
                EPUB 3 documents. </para>
        </abstract> -->

    </info>

    <chapter xml:id="sec-overview">
        <title>Overview</title>

        <section xml:id="sec-overview-purpose-and-scope" conformance="informative">
            <title>Purpose and Scope</title>

            <para>This specification, EPUB Content Documents 3.0, defines profiles of HTML5, SVG,
                and CSS for use in the context of <link linkend="gloss-epub-publication">EPUB®
                    Publications</link>.</para>

            <xi:include href="./share/specdesc-prepara.xml"/>
            <itemizedlist xml:id="epub-specs-listing">
                <xi:include href="./share/specdesc-overview.xml"/>
                <xi:include href="./share/specdesc-publications.xml"/>
                <xi:include href="./share/specdesc-ocf.xml"/>
                <xi:include href="./share/specdesc-overlays.xml"/>
            </itemizedlist>

            <para>This specification supersedes Open Publication Structure (OPS) 2.0.1 <xref
                    linkend="refOPS2"/>. Refer to <xref linkend="refEPUB3Changes"/> for information
                on differences between this specification and its predecessor.</para>

        </section>

        <section xml:id="sec-overview-relations" conformance="informative">

            <title>Relationship to Other Specifications</title>

            <section xml:id="sec-overview-relations-html">
                <title>Relationship to HTML5</title>

                <para>The <link linkend="sec-xhtml">XHTML document type defined by this
                        specification</link> is based on W3C <xref linkend="refHTML5"/>, and
                    inherits all definitions of semantics, structure and processing behaviors from
                    the HTML5 specification unless otherwise specified.</para>
                <!-- Paragraph about use of XML serialization of HTML5 here -->

                <para>In addition, this specification <link linkend="sec-xhtml-extensions">defines a
                        set of extensions</link> to the W3C HTML5 document model that <xref
                        linkend="gloss-author"/>s may include in <xref
                        linkend="gloss-content-document-epub-xhtml"/>s.</para>

                <para>This specification defines a simplified processing model that does not require
                    Reading Systems to support scripting, HTML5 forms or the HTML5 DOM. <xref
                        linkend="gloss-epub-reading-system"/>s conformant with this specification
                	are only required to be able to process a conforming <xref
                        linkend="gloss-content-document-epub"/>. As <link
                        linkend="sec-scripted-content-rs-reqs">support for scripting and HTML5
                        forms</link> are optional Reading System features, a conformant Reading
                    System might not be a fully-conformant HTML5 User Agent (i.e., it might not
                    implement the complete HTML5 processing model).</para>

            </section>

            <section xml:id="sec-overview-relations-svg">
                <title>Relationship to SVG</title>

                <para>This specification defines <link linkend="sec-svg">a restricted subset of SVG
                        1.1</link> to represent vector graphics inline in <xref
                        linkend="gloss-content-document-epub-xhtml"/>s and as standalone <xref
                        linkend="gloss-content-document-epub-svg"/>s. </para>
            </section>

            <section xml:id="sec-overview-relations-css">
                <title>Relationship to CSS</title>
                <para>The <link linkend="sec-css">CSS profile</link> defined in this specification
                    has CSS 2.1 <xref linkend="refCSS21"/> as its baseline. Any CSS Style Sheet that
                    conforms to CSS 2.1 may be used in the context of an EPUB Publication, except as
                    noted in <xref linkend="sec-css-2.1"/>.</para>
                <para>This specification also incorporates features defined by CSS3 Modules and
                    introduces EPUB-specific CSS constructs.</para>
            </section>

            <section xml:id="sec-overview-versioning">
                <title>EPUB 3 Versioning Strategy</title>
                <!-- TODO this <literal role="rfc2119">may</literal> go to Publications, and <literal role="rfc2119">should</literal> be reffed from overview -->
                <para xml:id="sec-overview-versionining"> EPUB 3 references W3C specifications that
                    are not yet final, and incompatible changes to them may occur in the future that
                    would cause EPUB 3 Content Documents that were previously conformant to no
                    longer be conformant to the latest versions of the referenced
                    specifications.</para>
                <para>The IDPF anticipates revising the EPUB 3 specifications if and when such
                    incompatible changes occur, updating the normative constraints defined herein as
                    necessary and incrementing the minor version number of EPUB 3 (e.g., publishing
                    an EPUB 3.0.<code role="var">n</code>). </para>
            </section>

        </section>

        <section xml:id="sec-terminology">
            <title>Terminology</title>
            <xi:include href="./share/terminology.xml"/>
        </section>

        <xi:include href="./share/typography.xml"/>
        
        <xi:include href="./share/conformancestatements.xml"/>

        <section xml:id="sec-overview-nspfx">
            <title>Namespace prefix mappings</title>
            <para>For convenience, the following namespace prefix mappings <xref
                    linkend="refXMLNamespaces"/> are used throughout this specification:</para>
            <informaltable xml:id="tbl-nspfx">
                <tr>
                    <th class="left">prefix</th>
                    <th class="odd">namespace URI</th>
                </tr>
                <tr>
                    <td class="left">
                        <code role="markup">epub</code>
                    </td>
                    <td class="odd">
                        <uri>http://www.idpf.org/2007/ops</uri>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <code role="markup">m</code>
                    </td>
                    <td class="odd">
                        <uri>http://www.w3.org/1998/Math/MathML</uri>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <code role="markup">pls</code>
                    </td>
                    <td class="odd">
                        <uri>http://www.w3.org/2005/01/pronunciation-lexicon</uri>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <code role="markup">ssml</code>
                    </td>
                    <td class="odd">
                        <uri>http://www.w3.org/2001/10/synthesis</uri>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <code role="markup">svg</code>
                    </td>
                    <td class="odd">
                        <uri>http://www.w3.org/2000/svg</uri>
                    </td>
                </tr>
            </informaltable>
        </section>

    </chapter>

    <chapter xml:id="sec-contentdocs">

        <title>EPUB Content Documents</title>

        <section xml:id="sec-xhtml">
            <title>XHTML Content Documents</title>

            <para>This section defines a profile of <xref linkend="refHTML5"/> for creating XHTML
                Content Documents. An instance of an XML document that conforms to this profile is a
                    <xref linkend="gloss-core-media-type"/> and is referred to in this specification
                and its <link linkend="sibling-specs">sibling specifications</link> as an <xref
                    linkend="gloss-content-document-epub-xhtml"/>.</para>

            <para>Unless otherwise specified, this specification inherits all definitions of
                semantics, structure and processing behaviors
                <!--  of the elements and attributes in the W3C HTML5 vocabulary --> from the <xref
                    linkend="refHTML5"/> specification. </para>

            <caution xml:id="caution-html5">
                <para>The EPUB 3 XHTML Content Document definition references features in the W3C
                        <xref linkend="refHTML5"/> specification that are still works in progress
                    and may change in incompatible ways. When utilizing such features, authors
                    should consider the inherent risks in terms of the potential impact on
                    interoperability and document longevity.</para>
            </caution>

            <section xml:id="sec-xhtml-conf-content"
                xreflabel="XHTML Content Documents — Content Conformance">
                <title>Content Conformance</title>
                <para>An <xref linkend="gloss-content-document-epub-xhtml"/> <literal role="rfc2119">must</literal> meet all of the
                    following criteria:</para>
                <variablelist role="conformance-list" xml:id="confreq-cd-xhtml">
                    <varlistentry xml:id="confreq-cd-xhtml-docprops">
                        <term>Document Properties</term>
                        <listitem>
                            <para xml:id="confreq-cd-xhtml-xml">
                                <xi:include href="./share/xml-defref.xml"/>
                            </para>
                            <!--
                            <para xml:id="confreq-cd-xhtml-docprops-xml">
                                <xi:include href="./share/xml-wellformed.xml"/>
                            </para>

                            <para xml:id="confreq-cd-xhtml-docprops-extmarkupdecl">
                                <xi:include href="./share/xml-extmarkupdecl.xml"/>
                            </para>

                            <para xml:id="confreq-cd-xhtml-docprops-xinc">
                                <xi:include href="./share/xml-xinc.xml"/>
                            </para>

                            <para xml:id="confreq-cd-xhtml-enc">
                                <xi:include href="./share/xml-enc.xml"/>
                            </para>
                            -->
                        	
                        	<para xml:id="confreq-cd-xhtml-docprops-syntax">It <literal role="rfc2119">must</literal> be 
                        		an <xref linkend="refHTML5"/> document that conforms to the <link
                                    xlink:href="http://www.w3.org/TR/html5/Overview.html#the-xhtml-syntax"
                                    >XHTML syntax</link>.</para>

                            <para xml:id="confreq-cd-xhtml-docprops-html5">For all document
                                constructs used that are defined by <xref linkend="refHTML5"/>, it
                                <literal role="rfc2119">must</literal> conform to the conformance criteria defined for those
                                constructs in that specification, unless explicitly overridden in
                                    <xref linkend="sec-xhtml-deviations"/>.</para>
                        	
                        	<para xml:id="confreq-cd-xhtml-docprops-schema">It 
                        		<literal role="rfc2119">may</literal> include extensions to 
                        		the <xref linkend="refHTML5"/> grammar as defined in 
                        		<xref linkend="sec-xhtml-extensions"/>, and <literal role="rfc2119">must</literal> conform to all
                                content conformance constraints defined therein.
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="confreq-cd-xhtml-fileprops">
                        <term>File Properties</term>
                        <listitem>
                            <para xml:id="confreq-cd-xhtml-fileprops-name">The XHTML Content
                                Document filename <literal role="rfc2119">should</literal> use the file extension
                                    <filename>.xhtml</filename>.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <note xml:id="note-cd-xhtml-refprops-pkg">
                    <!-- note similar statement for xhtml, svg and css-->
                    <para>All <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s
                        referenced from an XHTML Content Document must conform to the constraints
                        for Publication Resources defined in <olink type="epub-spec"
                            targetdoc="publications" targetptr="sec-epub-content-conf"/></para>
                </note>
            </section>

            <section xml:id="sec-xhtml-conf-rs"
                xreflabel="XHTML Content Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para>A conformant <xref linkend="gloss-epub-reading-system"/> <literal role="rfc2119">must</literal> meet all of the
                    following criteria for processing <xref
                        linkend="gloss-content-document-epub-xhtml"/>s:</para>

                <itemizedlist role="conformance-list" xml:id="xhtml-rs-confreqs">
                    <listitem>
                        <!-- todo below: overridden really refers to the deviations and extensions sections-->
                        <para xml:id="confreq-xhtml-rs-behavior">Unless explicitly defined by this
                            specification or its <link linkend="sibling-specs">sibling
                                specifications</link> as overridden, it <literal role="rfc2119">must</literal> process XHTML Content
                            Documents using semantics defined by the <xref linkend="refHTML5"/>
                            specification and honor any applicable User Agent conformance
                            constraints expressed therein.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-behavior-add">It <literal role="rfc2119">must</literal> meet all Reading System
                            conformance criteria defined in <xref linkend="sec-xhtml-extensions"
                            />.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-behavior-restr">It <literal role="rfc2119">must</literal> recognize and adapt
                            behaviorally to the constraints defined in <xref
                                linkend="sec-xhtml-deviations"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-scrpt">It <literal role="rfc2119">must</literal> meet the Reading System
                            conformance criteria defined in <xref
                                linkend="sec-scripted-content-rs-reqs"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-css">It <literal role="rfc2119">must</literal> support visual rendering of
                            XHTML Content Documents as defined in <xref linkend="sec-css-rs-conf"
                            />.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-a11y">It <literal role="rfc2119">should</literal> recognize embedded ARIA
                            markup and support exposure of any given ARIA roles, states and
                            properties to platform accessibility APIs <xref linkend="refARIA"/>.
                        </para>
                    </listitem>
                </itemizedlist>
            </section>

            <section xml:id="sec-xhtml-extensions">
                <title>HTML5 Extensions</title>

                <para>This section defines EPUB 3 <xref linkend="gloss-content-document-epub-xhtml"
                    /> extensions to the underlying <xref linkend="refHTML5"/> document
                    model.</para>
            	
            	<section xml:id="sec-xhtml-semantic-markup">
            		<title>Semantic Markup</title>
            		
            		<section xml:id="sec-xhtml-semantic-inflection">
            			<title>Semantic Inflection</title>
            			
            			<section xml:id="sec-xhtml-semantic-inflection-intro" conformance="informative">
            				<title>Introduction</title>
            				
            				<para>Semantic inflection is the process of attaching additional meaning
            					about the specific purpose and/or nature an element plays in an <xref
            						linkend="gloss-content-document-epub-xhtml"/>. In the context of
            					<xref linkend="gloss-epub-publication"/>s, the <code role="markup"><link
            						linkend="attrdef-epub-type">epub:type</link></code> attribute is
            					typically used to express domain-specific semantics, with the
            					inflection(s) it carries complementing the underlying <xref
            						linkend="refHTML5"/> host vocabulary. The applied semantics always
            					refine the meaning of their containing elements, never override their
            					nature (e.g., the attribute can be used to indicate a
            					<code role="markup">section</code> is a chapter in a work, but cannot be used to
            					turn <code role="markup">p</code> elements into list items to avoid proper list
            					structures).</para>
            				
            				<para>Semantic metadata is not intended for human consumption; it instead
            					provides a controlled way for Reading Systems and other User Agents to
            					learn more about the structure and content of a document, providing them
            					the opportunity to enhance the reading experience for Users. </para>
            				
            				<para>This specification defines a method for semantic inflection using
            					<emphasis>the attribute axis</emphasis>: instead of adding new XML
            					elements to the XHTML Content Document vocabulary, the
            					<code role="markup">epub:type</code> attribute can be appended to existing
            					elements to inflect the desired semantics. A mechanism to identify
            					external vocabularies that provide controlled values for the attributes
            					is also defined.</para>
            				
            			</section>
            			
            			<section xml:id="sec-xhtml-content-type-attribute">
            				<title>The <code role="markup">epub:type</code> Attribute</title>
            				
            				<para>The <code role="markup">epub:type</code> attribute inflects semantics on the element
            					on which it appears. Its value is one or more space-separated terms
            					stemming from external vocabularies associated with the document
            					instance, as defined in <xref
            						linkend="sec-contentdocs-vocab-association"/>. </para>
            				
            				<para>The inflected semantic <literal role="rfc2119">must</literal> express a subclass of the semantic of the
            					carrying element. In the case of semantically neutral elements (such as
            					<xref linkend="refHTML5"/>
            					<code role="markup"
            						xlink:href="http://www.w3.org/TR/html5/Overview.html#the-div-element"
            						>div</code> and <code role="markup"
            							xlink:href="http://www.w3.org/TR/html5/Overview.html#the-span-element"
            							>span</code>), the inflected semantic <literal role="rfc2119">must not</literal> attach a
            					meaning that is already conveyed by an existing element (e.g., that a
            					<code role="markup">div</code> represents a paragraph or section). Reading Systems
            					<literal role="rfc2119">must</literal> <link linkend="confreq-rs-epubtype-prec">ignore inflected
            						semantics</link> that conflict with the carrying element.</para>
            				
            				<note>
            					<para>The <code role="markup">epub:type</code> attribute is intended to be
            						functionally equivalent to the W3C Role Attribute <xref
            							linkend="refPFRoleAttribute"/>, but with restrictions as
            						specified in <xref linkend="sec-contentdocs-vocab-association"/>.
            					</para>
            				</note>
            				
            				<variablelist xreflabel="epub:type" role="elem-synopsis"
            					xml:id="attrdef-epub-type">
            					<varlistentry>
            						<term>Attribute Name</term>
            						<listitem>
            							<para>
            								<code role="markup">type</code>
            							</para>
            						</listitem>
            					</varlistentry>
            					<varlistentry>
            						<term>Namespace</term>
            						<listitem>
            							<para>
            								<uri>http://www.idpf.org/2007/ops</uri>
            							</para>
            						</listitem>
            					</varlistentry>
            					<varlistentry>
            						<term>Usage</term>
            						<listitem>
            							<para><link xlink:href="http://www.w3.org/TR/html5/single-page.html#global-attributes">Global attribute</link>.
            								<literal role="rfc2119">May</literal> be specified on all elements.</para>
            						</listitem>
            					</varlistentry>
            					<varlistentry>
            						<term>Value</term>
            						<listitem>
            							<para>A space-separated list of <olink type="epub-spec"
            								targetptr="sec-property-datatype"
            								targetdoc="publications">property</olink> values, with
            								restrictions as defined in <xref
            									linkend="sec-contentdocs-vocab-association"/>.</para>
            						</listitem>
            					</varlistentry>
            				</variablelist>
            				
            			</section>
            			
            			<section xml:id="sec-contentdocs-vocab-association"
            				xreflabel="Vocabulary Association">
            				<title>Vocabulary Association</title>
            				
            				<para>This specification adopts the vocabulary association mechanisms
            					defined in <olink targetdoc="publications"
            						targetptr="sec-metadata-assoc" type="epub-spec"/>, with the
            					following modifications: </para>
            				
            				<bridgehead xml:id="sec-contentdocs-default-vocab">Default
            					Vocabulary</bridgehead>
            				<para>The default vocabulary for Content Documents is defined to be the
            					<link linkend="refEPUBStructureVocab">EPUB 3 Structural Semantics
            						Vocabulary</link>.</para>
            				
            				<bridgehead xml:id="sec-contentdocs-reserved-vocabs">Reserved
            					Prefixes</bridgehead>
            				
            				<para>This specification reserves prefixes that Authors 
            					<literal role="rfc2119">may</literal> use in the <code role="markup">epub:type</code> 
            					attribute in the normative document 
            					<link xlink:href="../../vocab/structure/pfx/index.html">EPUB 
            						Content Documents Reserved Prefixes</link>.</para>
            				
            				<bridgehead xml:id="sec-contentdocs-prefix-attr">The <code role="markup">prefix</code>
            					Attribute</bridgehead>
            				<para>The <code role="markup">prefix</code> attribute definition is unchanged, but the
            					attribute is defined to be in the namespace
            					<uri>http://www.idpf.org/2007/ops</uri> when used in Content
            					Documents.</para>
            				
            				<bridgehead>Examples</bridgehead>
            				<informalexample xml:id="ex.epubtype.note">
            					<para>The following example shows the <code role="markup">epub:type</code> attribute
            						used to inflect footnote and note reference semantics. The
            						properties used are defined in the <link
            							linkend="sec-contentdocs-default-vocab">default
            							vocabulary</link>. </para>
            					<synopsis>
<xi:include href="./examples/contentdocs/epub-type-1.xml" parse="text"/></synopsis>
            				</informalexample>
            				<informalexample xml:id="ex.epubtype.gloss">
            					<para>The following example shows the <code role="markup">epub:type</code> attribute
            						used to inflect glossary semantics on an HTML5 definition list. The
            						property used is defined in the <link
            							linkend="sec-contentdocs-default-vocab">default
            							vocabulary</link>. </para>
            					<synopsis>
<xi:include href="./examples/contentdocs/epub-type-2.xml" parse="text"/></synopsis>
            				</informalexample>
            				<informalexample xml:id="ex.epubtype.pg">
            					<para>The following example shows the <code role="markup">epub:type</code> attribute
            						used to inflect source publication pagebreak semantics. The property
            						used is defined in the <link linkend="sec-contentdocs-default-vocab"
            							>default vocabulary</link>. (Note that the <olink
            								type="epub-spec" targetptr="sec-opf-dcsource"
            								targetdoc="publications"/> element provides a means of
            						identifying the source publication to which the given pagination
            						information applies.)</para>
            					<synopsis>
<xi:include href="./examples/contentdocs/epub-type-3.xml" parse="text"/></synopsis>
            				</informalexample>
            				
            			</section>
            			
            			<section xml:id="sec-contentdocs-semantic-inflection-processing-reqs">
            				<title>Processing Requirements</title>
            				
            				<para>A Reading System <literal role="rfc2119">must</literal> process the <code role="markup">epub:type</code> attribute as
            					follows:</para>
            				
            				<itemizedlist role="conformance-list">
            					<listitem>
            						<para xml:id="confreq-rs-epubtype-beh">It <literal role="rfc2119">may</literal> associate specialized
            							behaviors with none, some or all of the terms defined in the
            							<link linkend="sec-contentdocs-default-vocab">default
            								vocabulary</link>.</para>
            					</listitem>
            					<listitem xml:id="confreq-rs-epubtype-oth">
            						<para>It <literal role="rfc2119">may</literal> associate specialized behaviors with terms given in
            							vocabularies other than the default.</para>
            					</listitem>
            					<listitem xml:id="confreq-rs-epubtype-ign">
            						<para>It <literal role="rfc2119">must</literal> ignore terms that it does not recognize.</para>
            					</listitem>
            					<!--
                            <listitem>
                                <para>A Reading System <literal role="rfc2119">may</literal> support the dereferencing of unrecognized
                                    CURIEs occurring in the <code role="markup">epub:type</code> and
                                        <code role="markup">rel</code> attributes. If a Reading System
                                    successfully dereferences an unrecognized CURIE, it <literal role="rfc2119">may</literal>
                                    (depending on the information available in the referenced
                                    vocabulary property) employ adaptive behaviors in response to
                                    the change to the document structural semantics that results
                                    from the CURIE dereferencing.</para>
                            </listitem>                            
                            <listitem>
                                <para>If the attempt to dereference an unrecognized CURIE fails, or
                                    if the dereferencing of unrecognized CURIEs is not supported,
                                    then the Reading System <literal role="rfc2119">must</literal> ignore the given unrecognized CURIE
                                    and continue processing the <code role="markup">epub:type</code> or
                                        <code role="markup">rel</code> attribute.</para>
                            </listitem>
                            -->
            				</itemizedlist>
            				<para xml:id="confreq-rs-epubtype-prec">When Reading System behavior
            					associated with a given <code role="markup">epub:type</code> value conflicts with
            					behavior associated with the carrying element, the behavior associated
            					with the element <literal role="rfc2119">must</literal> be given precedence.</para>
            			</section>
            			
            		</section>
            		
            		<section xml:id="sec-xhtml-semantic-enrichment">
            			<title>Semantic Enrichment</title>
            			
            			<section xml:id="sec-xhtml-semantic-enrichment-intro" conformance="informative">
            				<title>Introduction</title>
            				
            				<para>Unlike <link linkend="sec-xhtml-semantic-inflection">semantic inflection</link>, which is 
            					about refining the structures within your markup, semantic enrichment enables the layering 
            					of meaning into the content in order to facilitate machine processing.</para>
            				
            				<para>The <xref linkend="refMicrodata"/> and <xref linkend="refRDFa"/> specifications both define
            					sets of attributes that can be used in <xref linkend="gloss-content-document-epub-xhtml"/>s 
            					to semantically enrich the content.</para>
            			</section>
            			
            			<section xml:id="sec-xhtml-semantic-enrichment-content-conf">
            				<title>Content Conformance</title>
            				
            				<para>A conformant <xref linkend="gloss-content-document-epub-xhtml"/> <literal role="rfc2119">must</literal> meet all
            					of the following criteria:</para>
            				
            				<itemizedlist role="conformance-list" xml:id="xhtml-semantic-enrichment-confreqs">
            					<listitem>
            						<para xml:id="confreq-xhtml-microdata">It <literal role="rfc2119">must</literal> allow the use of
            							<xref linkend="refMicrodata"/> attributes as defined in that specification.</para>
            					</listitem>
            					<listitem>
            						<para xml:id="confreq-xhtml-rdfa">It <literal role="rfc2119">must</literal> allow the use of
            							<xref linkend="refRDFa"/> attributes as defined in <xref linkend="refHTMLRDFa"/>.</para>
            					</listitem>
            				</itemizedlist>
            			</section>
            		</section>
            	</section>

                <section xml:id="sec-xhtml-ssml-attrib">
                    <title>SSML Attributes</title>

                    <section xml:id="sec-cd-ssml-intro">
                        <title>Overview</title>

                        <para>The W3C Speech Synthesis Markup Language <xref linkend="refSSML"/> is
                            a language used for assisting <xref linkend="gloss-tts"/> engines in
                            generating synthetic speech. Although SSML is designed as a standalone
                            document type, it also defines semantics suitable for use within other
                            host languages.</para>

                        <para>This specification recasts the <link
                                xlink:href="http://www.w3.org/TR/speech-synthesis11/#S3.1.10">SSML
                                1.1 <code role="markup">phoneme</code> element</link> as two attributes —
                                <code role="markup">ssml:ph</code> and <code role="markup">ssml:alphabet</code> — and makes them
                            available within EPUB XHTML Content Documents.</para>

                    	<para>Reading Systems with <xref linkend="gloss-tts"/> capabilities <literal role="rfc2119">should</literal>
                            support the SSML Attributes as defined below.</para>

                        <xi:include href="./share/note-tts-features.xml"/>

                    </section>

                    <section xml:id="sec-cd-ssml-ph-attrib">
                        <title>The <code role="markup">ssml:ph</code> attribute</title>
                        <para>The <code role="markup">ssml:ph</code> attribute specifies a phonemic/phonetic
                            pronunciation of the text represented by the element to which the
                            attribute is attached.</para>
                        <variablelist xreflabel="ssml:ph" role="elem-synopsis"
                            xml:id="attrdef-ssml-ph">
                            <varlistentry>
                                <term>Attribute Name</term>
                                <listitem>
                                    <para>
                                        <code role="markup">ph</code>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Namespace</term>
                                <listitem>
                                    <para>
                                        <uri>http://www.w3.org/2001/10/synthesis</uri>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Usage</term>
                                <listitem>
                                	<para><link xlink:href="http://www.w3.org/TR/html5/single-page.html#global-attributes">Global attribute</link>. 
                                		May be specified on all elements with which a phonetic
                                        equivalent can logically be associated (e.g., elements that
                                        contain textual information).</para>
                                    <para>Must not be specified on a descendant of an element that
                                        already carries this attribute.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Value</term>
                                <listitem>
                                    <para>A phonemic/phonetic expression, syntactically valid with
                                        respect to <link linkend="sec-cd-ssml-alphabet-attrib">the
                                            phonemic/phonetic alphabet being used</link>.</para>
                                </listitem>
                            </varlistentry>
                        </variablelist>
                        <para>This attribute inherits all the semantics of the <link
                                linkend="refSSML">SSML 1.1</link>
                            <code role="markup">phoneme</code> element <code role="markup"
                                xlink:href="http://www.w3.org/TR/speech-synthesis11/#S3.1.10">
                                ph</code> attribute, with the following
                            addition:</para>
                        <itemizedlist role="conformance-list">
                            <listitem>
                                <para xml:id="ssml-ph-concat"> When the <code role="markup">ssml:ph</code>
                                    attribute appears on an element that has text node descendants,
                                    the corresponding document text to which the pronunciation
                                    applies is the string that results from concatenating the
                                    descendant text nodes, in document order. The specified phonetic
                                    pronunciation <literal role="rfc2119">must</literal> therefore logically match the element's
                                    textual data in its entirety (i.e., not just an isolated part of
                                    its content).</para>
                            </listitem>
                        </itemizedlist>
                        <note>
                            <para>Reading Systems that support the SSML Attributes and <link
                                    linkend="sec-pls">PLS Documents</link> must honor the defined
                                    <link linkend="confreq-pls-rs-casc">precedence rules</link> for
                                these two constructs. </para>
                        </note>
                    </section>

                    <section xml:id="sec-cd-ssml-alphabet-attrib">
                        <title>The <code role="markup">ssml:alphabet</code> attribute</title>

                        <para>The <code role="markup">ssml:alphabet</code> attribute specifies which
                            phonemic/phonetic pronunciation alphabet is used in the value of the
                            <code role="markup"><xref linkend="attrdef-ssml-ph"/></code> attribute.</para>

                        <variablelist xreflabel="ssml:alphabet" role="elem-synopsis"
                            xml:id="attrdef-ssml-alphabet">
                            <varlistentry>
                                <term>Attribute Name</term>
                                <listitem>
                                    <para>
                                        <code role="markup">alphabet</code>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Namespace</term>
                                <listitem>
                                    <para>
                                        <uri>http://www.w3.org/2001/10/synthesis</uri>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Usage</term>
                                <listitem>
                                	<para><link xlink:href="http://www.w3.org/TR/html5/single-page.html#global-attributes">Global attribute</link>. 
                                		<literal role="rfc2119">May</literal> be specified on any element.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Value</term>
                                <listitem>
                                    <para>The name of the pronunciation alphabet used in the value
                                        of <code role="markup"><xref linkend="attrdef-ssml-ph"/></code>
                                        (inherited). </para>
                                </listitem>
                            </varlistentry>
                        </variablelist>

                        <para>This attribute inherits all the semantics of the <link
                                linkend="refSSML">SSML 1.1</link>
                            <code role="markup">phoneme</code> element <code role="markup"
                                xlink:href="http://www.w3.org/TR/speech-synthesis11/#S3.1.10">
                                alphabet</code> attribute, with the following
                            addition:</para>
                        <itemizedlist role="conformance-list">
                            <listitem>
                                <para xml:id="ssml-alphabet-inherit">The value of the
                                        <code role="markup">ssml:alphabet</code> attribute is inherited in the
                                    document tree. The pronunciation alphabet used in a given
                                        <code role="markup">ssml:ph</code> attribute value is determined by
                                    locating the first occurrence of the <code role="markup">ssml:alphabet</code>
                                    attribute starting with the element on which the
                                        <code role="markup">ssml:ph</code> attribute appears, followed by the
                                    nearest ancestor element.</para>
                            </listitem>
                        </itemizedlist>

                        <para>Reading Systems that support the <link linkend="sec-xhtml-ssml-attrib"
                                >SSML Attributes</link> feature of this specification <literal role="rfc2119">should</literal> support
                            the IPA alphabet <xref linkend="refIPA"/>, as expressed by the value "<code role="value">ipa</code>".</para>
                    </section>

                </section>

                <section xml:id="sec-xhtml-content-switch">
                    <title>Content Switching</title>

                    <section xml:id="sec-xhtml-switch-intro" conformance="informative">
                        <title>Introduction</title>

                        <para>The <code role="markup">switch</code> element provides a simple mechanism through
                            which Authors can tailor the Publication content displayed to Users, one
                            that isn't dependent on the scripting capabilities of the Reading
                            System.</para>

                        <para>Reading System developers may choose to support XML vocabularies and
                            new HTML elements that are not valid in <xref
                                linkend="gloss-content-document-epub-xhtml"/>s. The
                                <code role="markup">switch</code> mechanism encourages this type of development
                            and experimentation, but at the same time provides Authors who wish to
                            take advantage of it the security of knowing that their content will
                            still display on any compliant Reading System (i.e., it maintains the
                            baseline requirement that all XHTML Content Documents be valid if none
                            of the specialized markup is supported).</para>

                        <para>Content switching is not just about encouraging future development,
                            however; it can also be used to create Publications that maintain a
                            level of compatibility with older Reading Systems unable to handle the
                            new features of EPUB 3. For example, instances of MathML, now a native
                            type, could be added using <code role="markup">switch</code> elements so that EPUB 2
                            Reading Systems could instead provide fallback images or text.</para>
                    </section>

                    <section xml:id="sec-xhtml-switch-def">
                        <title>Definition</title>

                        <section xml:id="sec-xhtml-epub-switch">
                            <title>The <code role="markup">epub:switch</code> Element</title>

                            <para>The <code role="markup">switch</code> element allows an XML fragment to be
                                conditionally inserted into the content model of an XHTML Content
                                Document.</para>

                            <variablelist xreflabel="epub:switch" role="elem-synopsis"
                                xml:id="elemdef-switch">
                                <varlistentry>
                                    <term>Element name</term>
                                    <listitem>
                                        <para>
                                            <code role="markup">switch</code>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Namespace</term>
                                    <listitem>
                                        <para>
                                            <uri>http://www.idpf.org/2007/ops</uri>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Usage</term>
                                    <listitem>
                                        <para>In <link
                                                xlink:href="http://www.w3.org/TR/html5/Overview.html#flow-content-0"
                                                >Flow</link> and <link
                                                xlink:href="http://www.w3.org/TR/html5/Overview.html#phrasing-content-0"
                                                >Inline</link> content. Repeatable.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Attributes</term>
                                    <listitem>
                                        <variablelist role="elem-synopsis-attlist">
                                            <varlistentry xml:id="attrdef-switch-id">
                                                <term>
                                                    <code role="markup">id</code>
                                                  <option>[optional]</option>
                                                </term>
                                                <listitem>
                                                  <xi:include href="./share/id-prose-para.xml"/>
                                                </listitem>
                                            </varlistentry>
                                        </variablelist>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Content Model</term>
                                    <listitem>
                                        <para>In this order: <code role="markup"><link role="codelink"
                                                  linkend="sec-xhtml-epub-case"
                                                >case</link></code>
                                            <option>[1 or more]</option>, <code role="markup"><link
                                                  role="codelink" linkend="sec-xhtml-epub-default"
                                                  >default</link></code>
                                            <option>[exactly 1]</option>.</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>

                            <para>A Reading System <literal role="rfc2119">must</literal> individually process each
                                    <code role="markup">switch</code> element in a document to determine whether
                                it can render any of the child <code role="markup"><link linkend="elemdef-case"
                                        >case</link></code> elements (as determined by the value of
                                their <code role="markup"><link linkend="attrdef-case-required-namespace"
                                        >required-namespace</link></code> attributes).</para>

                            <para>For each <code role="markup">switch</code> encountered, the Reading System
                                <literal role="rfc2119">should</literal> render the content of the first <code role="markup">case</code> it
                                supports, but is free to select from any of the available options.
                                If the Reading System does not support the markup contained in any
                                of the child <code role="markup">case</code> elements, it <literal role="rfc2119">must</literal> render the contents
                                of the <code role="markup"><link linkend="elemdef-default">default</link></code>
                                element.</para>

                            <para>The <xref linkend="refHTML5"/>
                                <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</code> element <literal role="rfc2119">should</literal> be used to embed custom
                                (non-core) content types in XHTML Content Documents. Custom markup
                                <literal role="rfc2119">should</literal> be wrapped in a <code role="markup">switch</code> element only when the
                                content it represents is an integral part of the document and
                                depends on the context of the document to be properly
                                processed.</para>

                            <bridgehead>Examples</bridgehead>

                            <informalexample>
                                <para>An example of ChemML markup inserted using the
                                        <code role="markup">switch</code> element.</para>
                                <synopsis><xi:include href="examples/contentdocs/switch-1.xml" parse="text"/></synopsis>
                            </informalexample>

                            <informalexample>
                                <para>An example of adding MathML markup for compliance with EPUB 2
                                    Reading Systems.</para>
                                <synopsis><xi:include href="examples/contentdocs/switch-2.xml" parse="text"/></synopsis>
                            </informalexample>

                        </section>

                        <section xml:id="sec-xhtml-epub-case">
                            <title>The <code role="markup">epub:case</code> Element</title>

                            <para>The <code role="markup">case</code> element contains an instance of markup from
                                an XML vocabulary. The included markup <literal role="rfc2119">may</literal> be natively supported in
                                XHTML Content Documents (in the case of MathML and SVG), but such
                                support is not a requirement.</para>

                            <variablelist xreflabel="epub:case" role="elem-synopsis"
                                xml:id="elemdef-case">
                                <varlistentry>
                                    <term>Element name</term>
                                    <listitem>
                                        <para>
                                            <code role="markup">case</code>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Namespace</term>
                                    <listitem>
                                        <para>
                                            <uri>http://www.idpf.org/2007/ops</uri>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Usage</term>
                                    <listitem>
                                        <para>Required first child of <code role="markup"><link
                                                  linkend="elemdef-switch">switch</link></code>.
                                            Repeatable.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Attributes</term>
                                    <listitem>
                                        <variablelist role="elem-synopsis-attlist">
                                            <varlistentry xml:id="attrdef-case-id">
                                                <term>
                                                    <code role="markup">id</code>
                                                  <option>[optional]</option>
                                                </term>
                                                <listitem>
                                                  <xi:include href="./share/id-prose-para.xml"/>
                                                </listitem>
                                            </varlistentry>
                                            <varlistentry xml:id="attrdef-case-required-namespace">
                                                <term>
                                                    <code role="markup">required-namespace</code>
                                                  <option>[required]</option>
                                                </term>
                                                <listitem>
                                                  <para>An extension identifier in URI form <xref
                                                  linkend="refRFC2046"/> that identifies the XML
                                                  vocabulary or extension that the Reading System
                                                  <literal role="rfc2119">must</literal> support in order to process the content of
                                                  the <code role="markup">case</code> element. </para>
                                                </listitem>
                                            </varlistentry>
                                        </variablelist>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Content Model</term>
                                    <listitem>
                                        <para>An XML fragment conforming to the markup vocabulary
                                            identified in the <code role="markup">required-namespace</code>
                                            attribute.</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>

                            <para>Each <code role="markup">case</code> element <literal role="rfc2119">must</literal> contain an alternate
                                representation of the same content. To ensure the best rendering of
                                their content, Authors <literal role="rfc2119">should</literal> order <code role="markup">case</code> elements by to
                                their optimal rendering format.</para>

                            <para>If the <code role="markup">case</code> element contains markup that is valid in
                                an XHTML Content Document (e.g., MathML), that content <literal role="rfc2119">must</literal> be valid
                                at the point where the <code role="markup"><link linkend="elemdef-switch"
                                        >switch</link></code> element has been inserted (i.e., its
                                addition <literal role="rfc2119">must not</literal> result in an invalid document).</para>

                            <para>Foreign markup in a <code role="markup">case</code> element <literal role="rfc2119">must</literal> be well formed,
                                but does not have to be valid at its point of insertion. Authors
                                <literal role="rfc2119">should</literal> ensure that any foreign markup matches the context in which
                                it is used (e.g., a block element should not be included in a
                                    <code role="markup">switch</code> element inserted in an inline
                                context).</para>

                            <note>
                                <para>The IDPF maintains an informative registry of common extension
                                    identifiers for use in the <code role="markup">required-namespace</code>
                                    attribute at <uri xlink:href="../../switch/index.html"
                                        >http://www.idpf.org/epub/switch/</uri>.</para>
                            </note>

                        </section>

                        <section xml:id="sec-xhtml-epub-default">
                            <title>The <code role="markup">epub:default</code> Element</title>

                            <para>The <code role="markup">default</code> element provides markup that is valid in
                                any XHTML Content Document for when a Reading System cannot render
                                any of the <code role="markup"><link linkend="elemdef-case">case</link></code>
                                elements.</para>

                            <variablelist xreflabel="epub:default" role="elem-synopsis"
                                xml:id="elemdef-default">
                                <varlistentry>
                                    <term>Element name</term>
                                    <listitem>
                                        <para>
                                            <code role="markup">default</code>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Namespace</term>
                                    <listitem>
                                        <para>
                                            <uri>http://www.idpf.org/2007/ops</uri>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Usage</term>
                                    <listitem>
                                        <para>Required last child of <code role="markup"><xref
                                                  linkend="elemdef-switch"/></code>.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Attributes</term>
                                    <listitem>
                                        <variablelist role="elem-synopsis-attlist">
                                            <varlistentry xml:id="attrdef-default-id">
                                                <term>
                                                    <code role="markup">id</code>
                                                  <option>[optional]</option>
                                                </term>
                                                <listitem>
                                                  <xi:include href="./share/id-prose-para.xml"/>
                                                </listitem>
                                            </varlistentry>
                                        </variablelist>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Content Model</term>
                                    <listitem>
                                        <para>An <xref linkend="refHTML5"/>-compliant markup
                                            fragment.</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>

                            <para>The <code role="markup">default</code> element acts as a fallback for the
                                        <code role="markup"><link linkend="elemdef-switch">switch</link></code>
                                and <literal role="rfc2119">must</literal> include a representation of the content that is valid in
                                XHTML Content Documents.</para>

                            <para>The <code role="markup">default</code> element <literal role="rfc2119">must not</literal> include content that
                                would invalidate the document at the point where the
                                    <code role="markup">switch</code> has been inserted: XHTML Content Documents
                                <literal role="rfc2119">must</literal> be valid if all the <code role="markup">switch</code> elements are replaced
                                by their child <code role="markup">default</code> elements.</para>

                        </section>
                    </section>

                    <section xml:id="sec-xhtml-switch-processing">
                        <title>Processing</title>

                        <para><xref linkend="gloss-epub-reading-system"/>s <literal role="rfc2119">must</literal> support the
                                <code role="markup">switch</code> element.</para>

                        <para>This specification does not require a specific rendering approach for
                                <code role="markup">switch</code> elements. A Reading System <literal role="rfc2119">may</literal> choose to apply
                            CSS styling to render each <code role="markup">switch</code>, for example, but <literal role="rfc2119">may</literal> use
                            any other approach as appropriate. All Reading Systems <literal role="rfc2119">must</literal> present the
                            content of only one <code role="markup">case</code> element or the
                                <code role="markup">default</code> element per <code role="markup">switch</code> for rendering,
                            however.</para>

                        <para>The <code role="markup">switch</code> element <literal role="rfc2119">must</literal> be processed as though all of its
                            children but one have the HTML5 <code role="markup"
                                xlink:href="http://www.w3.org/TR/html5/Overview.html#the-hidden-attribute"
                                >hidden</code> attribute set (i.e., apply the same processing rules
                            and requirements outlined for that attribute to the
                            content not to be rendered).</para>

                        <note>
                            <para>As the content that may be rendered depends on the capabilities of
                                the User's Reading System, linking can be guaranteed only to the
                                    <code role="markup">switch</code> element. Deep referencing into the
                                    <code role="markup">switch</code> element is not recommended.</para>
                        </note>

                        <note>
                            <para>The occurrence of <code role="markup">switch</code> elements in <xref
                                    linkend="gloss-content-document-epub-xhtml"/> is indicated in
                                the <xref linkend="gloss-package-document"/>
                                <xref linkend="gloss-manifest"/> through the <property role="css"><olink
                                        type="epub-spec" targetdoc="publications" targetptr="switch"
                                    /></property> property.</para>
                        </note>

                    </section>

                </section>

                <section xml:id="sec-xhtml-epub-trigger">
                    <title>The <code role="markup">epub:trigger</code> Element</title>
                    <para>The <code role="markup">trigger</code> element enables the creation of markup-defined
                        user interfaces for controlling multimedia objects, such as audio and video
                        playback, in both scripted and non-scripted contexts.</para>
                    <variablelist xreflabel="epub:trigger" role="elem-synopsis"
                        xml:id="elemdef-epub-trigger">
                        <varlistentry>
                            <term>Element name</term>
                            <listitem>
                                <para>
                                    <code role="markup">trigger</code>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Namespace</term>
                            <listitem>
                                <para>
                                    <uri>http://www.idpf.org/2007/ops</uri>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Usage</term>
                            <listitem>
                            	<para>As a child of <code role="markup" xlink:href="http://www.w3.org/TR/html5/single-page.html#the-head-element">head</code>
                            		and in <link xlink:href="http://www.w3.org/TR/html5/Overview.html#flow-content-0"
                                        >Flow content</link>. Repeatable.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attributes</term>
                            <listitem>
                                <variablelist role="elem-synopsis-attlist">
                                    <varlistentry xml:id="attrdef-trigger-id">
                                        <term>
                                            <code role="markup">id</code>
                                            <option>[optional]</option>
                                        </term>
                                        <listitem>
                                            <xi:include href="./share/id-prose-para.xml"/>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-action">
                                        <term>
                                            <code role="markup">action</code>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>The action to perform for this event.</para>
                                            <para>Allowed values: <code role="value">show</code> |
                                                  <code role="value">hide</code> | <code role="value">play</code> |
                                                  <code role="value">pause</code> | <code role="value">resume</code> |
                                                  <code role="value">mute</code> | <code role="value">unmute</code>
                                            </para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-ref">
                                        <term>
                                            <code role="markup">ref</code>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>An IDREF <xref linkend="refXML"/> that identifies
                                                the element that is the object of the action.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-defaultAction">
                                        <term>
                                            <code role="markup">ev:defaultAction</code>
                                            <option>[optional]</option>
                                        </term>
                                        <listitem>
                                            <para>The applicable event for this trigger, as defined
                                                in <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-event">
                                        <term>
                                            <code role="markup">ev:event</code>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>The applicable event for this trigger, as defined
                                                in <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-observer">
                                        <term>
                                            <code role="markup">ev:observer</code>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>The source object for this trigger, as defined in
                                                  <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-phase">
                                        <term>
                                            <code role="markup">ev:phase</code>
                                            <option>[optional]</option>
                                        </term>
                                        <listitem>
                                            <para>The applicable event for this trigger, as defined
                                                in <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-propagate">
                                        <term>
                                            <code role="markup">ev:propagate</code>
                                            <option>[optional]</option>
                                        </term>
                                        <listitem>
                                            <para>The applicable event for this trigger, as defined
                                                in <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>Empty.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>

                    <para>The <code role="markup">trigger</code> element associates an <code role="markup">event</code> from a
                        specified source object (<code role="markup">observer</code>) with a desired action to be
                        performed with a specified target object (<code role="markup">ref</code>).</para>

                    <para>The semantics of the defined <code role="markup">action</code> values are:</para>

                    <itemizedlist>
                        <listitem>
                            <para><code role="value">show</code> – set the element's DOM <code role="property"
                                    xlink:href="http://www.w3.org/TR/CSS21/visufx.html#propdef-visibility"
                                    >visibility</code>
                                <xref linkend="refCSS21"/> property to visible.</para>
                        </listitem>
                        <listitem>
                            <para><code role="value">hide</code> – set the element's DOM <code role="property"
                                    xlink:href="http://www.w3.org/TR/CSS21/visufx.html#propdef-visibility"
                                    >visibility</code>
                                <xref linkend="refCSS21"/> property to hidden.</para>
                        </listitem>
                        <listitem>
                            <para><code role="value">play</code> – play the associated resource from the
                                beginning.</para>
                        </listitem>
                        <listitem>
                            <para><code role="value">pause</code> – pause playing.</para>
                        </listitem>
                        <listitem>
                            <para><code role="value">resume</code> – resume playing.</para>
                        </listitem>
                        <listitem>
                            <para><code role="value">mute</code> – mute sound.</para>
                        </listitem>
                        <listitem>
                            <para><code role="value">unmute</code> – unmute sound.</para>
                        </listitem>
                    </itemizedlist>

                    <para>Reading Systems that support the <xref linkend="refHTML5"/> <code role="markup">audio</code> or <code role="markup">video</code> elements
                        <literal role="rfc2119">must</literal> support the <code role="markup">epub:trigger</code> element. 
                        The <code role="value">play</code>, <code role="value">pause</code>, <code role="value">resume</code>, 
                        <code role="value">mute</code> and <code role="value">unmute</code> actions can be applied to 
                        <code role="markup">audio</code> and <code role="markup">video</code> elements only. The 
                        <code role="value">show</code> and <code role="value">hide</code> actions can be applied to any descendant 
                        of the <code role="markup">body</code> element.</para>

                    <informalexample>
                        <para>Sample markup of a video player that uses <code role="markup">trigger</code>
                            elements to control playback and muting. The <code role="markup">role</code>, <code role="markup">tabindex</code>
                        	and <code role="markup">aria-controls</code> attributes ensure the <code role="markup">span</code> elements
                        	are accessible as buttons to keyboard users.</para>

                        <programlisting><xi:include href="examples/contentdocs/trigger.xml" parse="text"/></programlisting>
                    </informalexample>
                </section>

                <section xml:id="sec-xhtml-alternate-style-tags">
                    <title>Alternate Style Tags</title>
                    <para>In accordance with <xref linkend="refAlternateStyleTags"/> , the
                        <code role="markup">link</code> element <code role="markup">class</code> attribute <literal role="rfc2119">may</literal>
                        include any of the following values: <code role="value">horizontal</code>,
                        <code role="value">vertical</code>, <code role="value">day</code> and
                        <code role="value">night</code>. These values inherit the semantics defined by
                        that specification for their use.</para>
                    <para>Reading Systems <literal role="rfc2119">should</literal> select and utilize such tagged style sets as
                        appropriate, and as described in that specification.</para>
                </section>
                
                <section xml:id="sec-xhtml-custom-attributes">
                    <title>Custom Attributes</title>
                    
                    <para><xref linkend="gloss-epub-reading-system"/>s <literal role="rfc2119">may</literal> 
                        introduce functionality not defined in this specification to enhance the rendering of 
                        <xref linkend="gloss-epub-publication"/>s. To facilitate this experimentation, 
                        vendors <literal role="rfc2119">may</literal> define custom attributes for use in 
                        <xref linkend="gloss-content-document-epub-xhtml"/>s.</para>
                    
                    <para>Custom attributes <literal role="rfc2119">may</literal> be included on any element
                        in an XHTML Content Document provided such attributes are from a foreign namespace, 
                        which is defined as a namespace <xref linkend="refXMLNamespaces"/> that does not map 
                        to either of the following URIs:</para>
                    
                    <itemizedlist>
                        <listitem>
                            <para><uri>http://www.w3.org/1999/xhtml</uri></para>
                        </listitem>
                        <listitem>
                            <para><uri>http://www.idpf.org/2007/ops</uri></para>
                        </listitem>
                    </itemizedlist>
                    
                    <para>Custom attributes, and the behaviors associated with them, 
                        <literal role="rfc2119">must not</literal> alter the integrity of a Publication.
                        The content <literal role="rfc2119">must</literal> remain consumable by a User 
                        without any information loss or other significant deterioration, regardless 
                        of the Reading System it is rendered on.</para>
                    
                    <note>
                        <para>To facilitate interoperability of custom attributes across Reading Systems, 
                            vendors are strongly encouraged to document any extensions they implement at
                            <uri xlink:href="http://www.idpf.org/epub/extensions/attributes">http://www.idpf.org/epub/extensions/attributes</uri>.</para>
                    </note>
                </section>
            </section>

            <section xml:id="sec-xhtml-deviations">
                <title>HTML5 Deviations and Constraints</title>
            	
            	<para>This section defines deviations from, and constraints on, the underlying 
            		<xref linkend="refHTML5"/> document model applicable to EPUB 3 <xref
            			linkend="gloss-content-document-epub-xhtml"/>s.</para>

                <section xml:id="sec-xhtml-mathml">
                    <title>Embedded MathML</title>

                    <section xml:id="sec-xhtml-mathml-intro" conformance="informative">
                        <title>Introduction</title>

                        <para>XHTML Content Documents support embedded <xref linkend="refMathML"/>
                            but limit its usage to a restricted subset of the full MathML markup
                            language.</para>

                        <para>This subset is designed to ease the implementation burden on Reading
                            Systems and to promote accessibility, while retaining compatibility with
                                <xref linkend="refHTML5"/> User Agents. </para>

                        <note>
                            <para>The <property role="css"><olink type="epub-spec" targetdoc="publications"
                                        targetptr="mathml"/></property> property of the <xref
                                    linkend="gloss-manifest"/>
                                <code role="markup">item</code> element indicates that an XHTML Content Document
                                contains embedded MathML.</para>
                        </note>

                    </section>

                    <section xml:id="sec-xhtml-mathml-conf-content"
                        xreflabel="Embedded MathML — Content Conformance">
                        <title>Content Conformance</title>

                    	<para>Any occurrence of MathML markup in XHTML Content Documents <literal role="rfc2119">must</literal>
                            conform to the constraints expressed in the MathML specification <xref
                                linkend="refMathML"/>, with the following additional
                            restrictions:</para>

                        <variablelist role="conformance-list">
                            <varlistentry xml:id="math-pres">
                                <term>Presentation MathML</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-pres">The <code role="markup">m:math</code>
                                        element <literal role="rfc2119">must</literal> contain only <link
                                            xlink:href="http://www.w3.org/TR/MathML/chapter3.html"
                                            >Presentation MathML</link>, with the exception of the
                                            <code role="markup">m:annotation-xml</code> element as defined
                                        below.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-cont">
                                <term>Content MathML</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-annot-cont"><link
                                            xlink:href="http://www.w3.org/TR/MathML/chapter4.html"
                                            >Content MathML</link> <literal role="rfc2119">may</literal> be included within MathML
                                    	markup in XHTML Content Documents, and, when present, <literal role="rfc2119">must</literal>
                                        occur within an <code role="markup">m:annotation-xml</code> child element
                                        of an <code role="markup">m:semantics</code> element.</para>
                                    <para xml:id="confreq-mathml-annot-cont-attrs">When Content
                                        MathML is included as per the previous condition, the given
                                            <code role="markup">m:annotation-xml</code> element's
                                            <code role="markup">encoding</code> attribute <literal role="rfc2119">must</literal> be set to either of
                                        the functionally-equivalent values
                                        <code role="value">MathML-Content</code> or
                                            <code role="value">application/mathml-content+xml</code>, and its
                                            <code role="markup">name</code> attribute <literal role="rfc2119">must</literal> be set to
                                        <code role="value">contentequiv</code>. </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-deprecated">
                                <term>Deprecated MathML</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-deprecated">Elements and attributes
                                    	marked as deprecated in <xref linkend="refMathML"/> <literal role="rfc2119">must not</literal>
                                        be included within MathML markup in XHTML Content
                                        Documents.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-xhtml">
                                <term>XHTML Content Document fragments</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-annot-xht">XHTML Content Document
                                        fragments <literal role="rfc2119">may</literal> be included within MathML markup in XHTML
                                        Content Documents, and, when present, <literal role="rfc2119">must</literal> occur within an
                                            <code role="markup">m:annotation-xml</code> child element of an
                                            <code role="markup">m:semantics</code> element.</para>
                                    <para xml:id="confreq-mathml-annot-xht-attrs">When an XHTML
                                        Content Document fragment is included as per the above
                                        paragraph, the given <code role="markup">m:annotation-xml</code> element's
                                            <code role="markup">encoding</code> attribute <literal role="rfc2119">must</literal> be set to
                                        <code role="value">application/xhtml+xml</code> and its
                                            <code role="markup">name</code> attribute <literal role="rfc2119">must</literal> be set to
                                        <code role="value">alternate-representation</code>.</para>
                                    <para xml:id="confreq-mathml-annot-xht-math">Any included XHTML
                                        Content Document fragments <literal role="rfc2119">must not</literal> themselves contain
                                        MathML markup.</para>
                                    <para xml:id="confreq-mathml-annot-xht-model">Any included XHTML
                                        Content Document fragments <literal role="rfc2119">must</literal> conform to the content model
                                        in which the ancestor <code role="markup">m:math</code> element occurs,
                                        such that if the <code role="markup">m:math</code> element is replaced by
                                        the given XHTML Content Document fragment the document
                                        remains valid.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-alt">
                                <term>Alternative Content</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-alt">Alternative content <literal role="rfc2119">should</literal> be
                                        included, and, when present, <literal role="rfc2119">must</literal> be represented as defined
                                        in <xref linkend="sec-xhtml-mathml-alt"/>.</para>
                                </listitem>
                            </varlistentry>
                        </variablelist>

                    </section>


                    <section xml:id="sec-xhtml-mathml-rs-conf"
                        xreflabel="Embedded MathML — Reading System Conformance">
                        <title>Reading System Conformance</title>

                        <para>A conformant <xref linkend="gloss-epub-reading-system"/> <literal role="rfc2119">must</literal> meet all
                            of the following criteria for processing MathML embedded in XHTML
                            Content Documents:</para>

                        <itemizedlist role="conformance-list" xml:id="mathml-rs-confreqs">
                            <listitem>
                                <para xml:id="confreq-mathml-rs-behavior">It <literal role="rfc2119">must</literal> support processing
                                    of <link xlink:href="http://www.w3.org/TR/MathML/chapter3.html"
                                        >Presentation MathML</link>, and <literal role="rfc2119">may</literal> support processing of
                                        <link xlink:href="http://www.w3.org/TR/MathML/chapter4.html"
                                        >Content MathML</link>, using semantics defined by the
                                    MathML 3.0 specification <xref linkend="refMathML"/>.</para>
                            </listitem>
                            <listitem>
                                <para xml:id="confreq-mathml-rs-render">If it has a <xref
                                        linkend="gloss-viewport"/>, it <literal role="rfc2119">must</literal> support visual rendering
                                    of Presentation MathML.</para>
                            </listitem>
                            <listitem>
                                <para xml:id="confreq-mathml-rs-alt-text">When producing <link
                                        linkend="sec-xhtml-mathml-alt">alternative textual
                                        content</link> for MathML markup, it <literal role="rfc2119">should</literal> be able to
                                    dynamically generate such content from the given <link
                                        linkend="confreq-mathml-pres">Presentation MathML</link>,
                                    and if not, <literal role="rfc2119">must</literal> give preference to <link linkend="math-xhtml"
                                        >XHTML Content Document fragments</link> followed by the
                                        <code role="markup">alttext</code> attribute on the <code role="markup">m:math</code>
                                    element.</para>
                            </listitem>
                            <listitem>
                                <para xml:id="confreq-rs-mathml-prop">It <literal role="rfc2119">must</literal> regard the <olink
                                        type="epub-spec" targetdoc="publications" targetptr="mathml"
                                    /> property of the <xref linkend="gloss-package-document"/>
                                    <xref linkend="gloss-manifest"/>
                                    <code role="markup">item</code> element as the authoritative definition of
                                    whether an XHTML Content Document includes embedded
                                    MathML.</para>
                            </listitem>

                        </itemizedlist>
                    </section>

                    <section xml:id="sec-xhtml-mathml-alt">
                        <title>Alternative Content</title>

                        <para>Reading Systems <literal role="rfc2119">should</literal> be able to generate any necessary alternative
                            textual renditions dynamically using the given <link
                                linkend="confreq-mathml-pres">Presentation MathML</link> markup
                            (e.g., as output to <xref linkend="gloss-tts"/> engines). To support
                            Reading Systems that are not so capable, alternative textual content
                            <literal role="rfc2119">should</literal> be included with each occurrence of the <code role="markup">m:math</code>
                            element in XHTML Content Documents.</para>

                        <para>The <code role="markup">alttext</code> attribute on the <code role="markup">m:math</code> element
                            <literal role="rfc2119">should</literal> be used for this purpose primarily when shorter alternative text
                        	runs are sufficient. When more extensive alternative text is required,
                                <link linkend="math-xhtml">XHTML Content Document fragments</link>
                            <literal role="rfc2119">should</literal> be used. (Note that Reading Systems query these two alternative
                            text locations using a defined <link
                                linkend="confreq-mathml-rs-alt-text">preference order</link>.) </para>

                    	<para>For Reading System forward compatibility purposes, fallback images <literal role="rfc2119">may</literal>
                            be provided using the <code role="markup">altimg</code> attribute on the
                                <code role="markup">m:math</code> element. It is <literal role="rfc2119">recommended</literal> that the dimension
                            and alignment attributes (<code role="markup">altimg-width</code>,
                                <code role="markup">altimg-height</code> and <code role="markup">altimg-valign</code>) be used
                            in conjunction with the <code role="markup">altimg</code> attribute.</para>

                        <note xml:id="note-mathml-altimg-refprops-pkg">
                            <!-- note similar statement for xhtml, svg and css and mathml alternative content -->
                            <para>All referenced <xref
                            	linkend="gloss-publication-resource-cmt-or-foreign"/>s must
                                conform to the constraints for Publication Resources defined in
                                    <olink type="epub-spec" targetdoc="publications"
                                    targetptr="sec-epub-content-conf"/>.</para>
                        </note>
                    </section>

                </section>


                <section xml:id="sec-xhtml-svg">
                    <title>Embedded SVG</title>
                    <!-- http://www.w3.org/TR/html5/the-map-element.html#svg-0 -->

                    <para><xref linkend="gloss-content-document-epub-xhtml"/>s support the embedding
                        of <link
                            xlink:href="http://www.w3.org/TR/SVG/intro.html#TermSVGDocumentFragment"
                            >SVG 1.1 document fragments</link>
                        <emphasis>by reference</emphasis> (embedding via reference, for example,
                        from an <code role="markup">img</code> or <code role="markup">object</code> element) and <emphasis>by
                            inclusion</emphasis> (embedding via direct inclusion of the
                            <code role="markup">svg:svg</code> element in the XHTML Content Document) <xref
                            linkend="refSVG"/>.</para>

                    <para>The content conformance constraints for SVG embedded in XHTML Content
                        Documents are the same as defined for <xref
                            linkend="gloss-content-document-epub-svg"/>s in <xref
                            linkend="sec-svg-restrictions"/>.</para>

                    <para>Reading Systems <literal role="rfc2119">must</literal> process SVG embedded in XHTML Content Documents as
                        defined in <xref linkend="sec-svg-rs-conf"/>.</para>

                    <note>
                        <para>The <property role="css"><olink type="epub-spec" targetdoc="publications"
                                    targetptr="svg"/></property> property of the <xref
                                linkend="gloss-manifest"/>
                            <code role="markup">item</code> element indicates that an XHTML Content Document
                            contains embedded SVG.</para>
                    </note>

                    <!--
                    <note>
                        <para>This section defines conformance requirements for SVG embedded in
                            XHTML Content Documents. Refer to <xref linkend="sec-svg"/> for
                            conformance requirements for SVG as an EPUB Content Document.</para>
                    </note>
                    -->

                    <section xml:id="sec-xhtml-svg-css">
                        <title>Embedded SVG and CSS</title>

                        <para xml:id="confreq-svg-rs-css-embed-ref">For the purposes of styling SVG
                            embedded in XHTML Content Documents <emphasis>by reference</emphasis>,
                            Reading Systems <literal role="rfc2119">must not</literal> apply CSS style rules of the containing
                            document to the referenced SVG document.</para>

                        <para xml:id="confreq-svg-rs-css-embed-inc">For the purposes of styling SVG
                            embedded in XHTML Content Documents <emphasis>by inclusion</emphasis>,
                            Reading Systems <literal role="rfc2119">must</literal> apply applicable CSS rules of the containing
                            document to the included SVG elements.</para>

                        <note>
                            <para>SVG included <emphasis>by reference</emphasis> is processed as a
                                separate document, and may include its own CSS style rules just like
                                an <xref linkend="gloss-content-document-epub-svg"/> would. Note
                                that this is consistent with situations where an <xref
                                    linkend="refHTML5"/>
                                <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</code> element references an external <xref
                                    linkend="refHTML5"/> element.</para>
                        </note>

                    </section>

                </section>

                <section xml:id="sec-xhtml-deviations-unicode">
                    <title>Unicode Restrictions</title>

                    <para>This section lists restrictions on the Unicode character
                        repertoire.</para>

                    <variablelist>
                        <varlistentry>
                            <term>Private Use Characters and Embedded Fonts</term>
                            <listitem>
                                <para xml:id="confreq-xhtml-unicode-pua">Any included characters
                                    that map to a code point within one of the Private Use Area
                                    (PUA) ranges as defined in <xref linkend="refUnicode5"/> <literal role="rfc2119">must</literal>
                                    occur within a string that is styled or attributed in a manner
                                    that includes a reference to an <link linkend="sec-css-fonts"
                                        >embedded font</link> that contains an appropriate glyph for
                                    that code point.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </section>

                <section xml:id="sec-xhtml-deviations-discouraged">
                    <title>Discouraged Constructs</title>
                    <variablelist role="conformance-list">
                        <varlistentry>
                            <term>The <code role="markup">rp</code> Element</term>
                            <listitem>
                                <para xml:id="confreq-xhtml-vocab-rp">The <xref linkend="refHTML5"/>
                                    <code role="markup"
                                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-rp-element"
                                            >rp</code> element is intended to provide a
                                    fallback — an optional parenthesis display around
                                        <code role="markup">ruby</code> markup — for older version Reading Systems
                                    that do not recognize ruby markup. As EPUB 3 Reading Systems are
                                    ruby-aware, and can provide fallbacks, the use of
                                        <code role="markup">rp</code> elements in Content Documents is
                                    discouraged.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>The <code role="markup">embed</code> Element</term>
                            <listitem>
                                <para xml:id="confreq-xhtml-vocab-embed">Since the <xref
                                        linkend="refHTML5"/>
                                    <code role="markup"
                                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-embed-element"
                                            >embed</code> element does not provide intrinsic
                                    facilities to provide <link linkend="confreq-rs-scripted-flbk"
                                        >fallbacks</link> for Reading Systems that do not support
                                    scripting, its use is discouraged when the resource referenced
                                    has scripting components. Authors <literal role="rfc2119">should</literal> use the
                                        <code role="markup">object</code> element instead.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </section>

                <!-- iframe src restriction dropped as per Issue 129
                <section xml:id="sec-xhtml-deviations-restricted">
                    <title>Restricted Constructs</title>
                    <para>This section lists restrictions on <xref
                            linkend="gloss-content-document-epub-xhtml"/> that are not enforced by
                        the <link linkend="app-xhtml-schema">schema for XHTML Content
                            Documents</link>.</para>
                    <variablelist role="conformance-list">
                        <varlistentry xml:id="confreq-cd-xhtml-refprops">
                            <term>Reference Restrictions</term>
                            <listitem>
                                <para xml:id="confreq-cd-xhtml-refprops-iframe"
                                    xreflabel="iframe src type restriction">The HTML5
                                        <code role="markup">iframe</code> element <code role="markup">src</code> attribute <literal role="rfc2119">must</literal>
                                    only reference <xref linkend="gloss-content-document-epub-xhtml"
                                    />s. </para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </section>
                -->

            </section>

        </section>

        <section xml:id="sec-xhtml-nav">

            <title>EPUB Navigation Documents</title>

            <section xml:id="sec-xhtml-nav-intro" conformance="informative">
                <title>Introduction</title>

                <para>The EPUB Navigation Document is a <olink type="epub-spec"
                        targetdoc="publications" targetptr="sec-epub-content-conformance-nav"
                        >required component</olink> of <xref linkend="gloss-epub-publication"/>s. It
                    provides the Author with a mechanism to include a human- and machine-readable
                    global navigation layer in the Publication, thereby ensuring increased usability
                    and accessibility for the User. </para>

                <para>The EPUB Navigation Document is an adaptation of <xref
                        linkend="gloss-content-document-epub-xhtml"/> and is, <link
                        linkend="confreq-cd-nav-docprops-parent">by definition</link>, a valid XHTML
                    Content Document instance. All Content and Reading System conformance
                    requirements that apply to XHTML Content Documents also apply to the EPUB
                    Navigation Document.</para>

                <para>The navigation features of this adaptation are expressed through
                    specializations of the <xref linkend="refHTML5"/>
                    <code role="markup"
                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-nav-element"
                            >nav</code> element. Each <code role="markup">nav</code> element in an EPUB
                    Navigation Document represents a data island — an embedded source of specialized
                    information within the general markup — from which Reading Systems can retrieve
                    navigational information. Unlike typical XML data islands, however, the
                    information within the <code role="markup">nav</code> element remains human readable as an
                        <xref linkend="refHTML5"/> document.</para>

                <para>To facilitate machine readability, the content model of <code role="markup">nav</code>
                    elements in EPUB Navigation Documents is restricted relative to what is allowed
                    in general XHTML Content Documents.</para>

                <note>
                    <para>The EPUB Navigation Document is identified in the <xref
                            linkend="gloss-package-document"/>
                        <xref linkend="gloss-manifest"/> through the <property role="css"><olink
                                type="epub-spec" targetdoc="publications" targetptr="nav"
                            /></property> property.</para>
                </note>

                <note xml:id="note-ncx">
                    <para>The EPUB Navigation Document supersedes the NCX document type as defined
                        in <xref linkend="refOPF2"/>.</para>
                    <para>Information on how EPUB 3 Publications may include an NCX document for
                        EPUB 2 Reading System forwards compatibility purposes is available in <olink
                            type="epub-spec" targetdoc="publications" targetptr="ncx-superseded"
                        />.</para>
                </note>

            </section>

            <section xml:id="sec-xhtml-nav-content-conf"
                xreflabel="EPUB Navigation Documents — Content Conformance">
                <title>Content Conformance</title>

                <para>A conformant <xref linkend="gloss-content-document-epub-nav"/> <literal role="rfc2119">must</literal> meet all
                    of the following criteria:</para>

                <variablelist role="conformance-list" xml:id="confreq-cd-nav">
                    <varlistentry xml:id="confreq-cd-nav-docprops">
                        <term>Document Properties</term>
                        <listitem>
                            <para xml:id="confreq-cd-nav-docprops-parent">It <literal role="rfc2119">must</literal> conform to all
                                content conformance constraints for <xref
                                    linkend="gloss-content-document-epub-xhtml"/>s as defined in
                                    <xref linkend="sec-xhtml-conf-content"/>.</para>
                            <para xml:id="confreq-cd-nav-docprops-schema">It <literal role="rfc2119">must</literal> 
                            	conform to all content conformance constraints specific for EPUB Navigation Documents
                                expressed in <xref linkend="sec-xhtml-nav-def"/>.</para>
                            <para xml:id="confreq-cd-nav-docprops-spine">As a conforming XHTML
                                Content Document, it <literal role="rfc2119">may</literal> be included in the Publication <xref
                                    linkend="gloss-spine"/>. </para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>

            <section xml:id="sec-xhtml-nav-rs-conf"
                xreflabel="EPUB Navigation Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para>A conformant <xref linkend="gloss-epub-reading-system"/> <literal role="rfc2119">must</literal> meet all of the
                    following criteria for processing <xref
                        linkend="gloss-content-document-epub-nav"/>s:</para>

                <itemizedlist role="conformance-list" xml:id="xhtml-nav-rs-confreqs">
                    <listitem>
                        <para xml:id="confreq-nav-access">When requested by a User, Reading Systems
                            <literal role="rfc2119">must</literal> provide access to the links and link labels in <link
                                linkend="sec-xhtml-nav-def-types">the <code role="markup">nav</code>
                                elements</link> of the EPUB Navigation Document in a fashion that
                            allows the User to activate the links provided. When a link is
                            activated, the Reading System <literal role="rfc2119">must</literal> relocate the application's current
                            reading position to the destination identified by that link.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-nav-spine">Reading Systems <literal role="rfc2119">must</literal> honor the above
                            requirement irrespective of whether the EPUB Navigation Document
                            provided in a Publication is part of the <xref linkend="gloss-spine"
                            />.</para>
                    </listitem>

                </itemizedlist>
            </section>

            <section xml:id="sec-xhtml-nav-def">
                <title>EPUB Navigation Document Definition</title>

                <section xml:id="sec-xhtml-nav-def-model">
                    <title>The <code role="markup">nav</code> Element: Restrictions</title>
                	<para>When a <code role="markup">nav</code> element carries the <code role="markup"><link
                		linkend="sec-xhtml-content-type-attribute">epub:type</link></code> attribute
                    	in an <xref linkend="gloss-content-document-epub-nav"/>, this specification 
                    	restricts the content model of the element and its descendants as follows:</para>

                    <itemizedlist role="conformance-list">
                        <listitem>
                            <para xml:id="confreq-nav-hd">Each <code role="markup">nav</code> element <literal role="rfc2119">may</literal> contain
                                an optional heading indicating the title of the navigation list. The
                                heading <literal role="rfc2119">must</literal> be an 
                                <link xlink:href="http://www.w3.org/TR/html5/dom.html#heading-content"
                                        >HTML5 heading content</link> element.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-ol">The optional heading <literal role="rfc2119">must</literal> be followed by a
                                single <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-ol-element"
                                        >ol</code> ordered list; no other elements are
                                permitted as direct children of the <code role="markup">nav</code> element. This
                                ordered list represents the primary level of content
                                navigation.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a">Each list item (<code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-li-element"
                                        >li</code>) of the ordered list represents a primary
                                heading, structure or other point of interest within the Publication
                                and <literal role="rfc2119">must</literal> contain either a child <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-a-element"
                                        >a</code> element or a child <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-span-element"
                                        >span</code> element. The <code role="markup">a</code> element
                                describes the target within the Content Document that the link
                                points to. The <code role="markup">span</code> element serves as a heading for
                                breaking down lists into distinct groups (for example, a large list
                                of illustrations can be segmented into several lists, one for each
                                chapter).</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a-cnt">Each child <code role="markup">a</code> or
                                    <code role="markup">span</code> element of a list item <literal role="rfc2119">may</literal> contain any valid
                                    <link
                                    xlink:href="http://www.w3.org/TR/html5/Overview.html#phrasing-content-0"
                                    >HTML5 phrasing content</link>, but <literal role="rfc2119">must not</literal> result in a
                                zero-length text string after concatenation of all child content and
                                application of whitespace normalization rules.</para>
                        </listitem>
                        <listitem xml:id="confreq-nav-a-title">
                            <para>If the <code role="markup">a</code> element contains instances of <link
                                    xlink:href="http://dev.w3.org/html5/spec/Overview.html#embedded-content-0"
                                    >HTML5 embedded content</link> that do not provide intrinsic
                                text alternatives, it <literal role="rfc2119">must</literal> also include a <code role="markup">title</code>
                                attribute with an alternate text rendition of the link label.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a-href">The relative IRI reference provided in
                            	the <code role="markup">href</code> attribute of the <code role="markup">a</code> element <literal role="rfc2119">must</literal>
                                resolve to an <!-- olink
		                                    type="epub-spec" targetdoc="contentdocs"
		                                    targetptr="gloss-content-document-epub"/ -->
                                <xref linkend="gloss-content-document-epub"/> or fragment
                                therein.</para>
                        </listitem>
                        <listitem>
                        	<para xml:id="confreq-nav-a-nest">The <code role="markup">a</code> element <literal role="rfc2119">may</literal>
                                optionally be followed by an <code role="markup">ol</code> ordered list
                                representing a subsidiary content level below that heading (e.g.,
                                all the subsection headings of a section). The <code role="markup">span</code>
                                element <literal role="rfc2119">must</literal> be followed by an <code role="markup">ol</code> ordered list: it
                                cannot be used in "leaf" <code role="markup">li</code> elements. Regardless of
                                whether an <code role="markup">a</code> or <code role="markup">span</code> element precedes it,
                                this sublist <literal role="rfc2119">must</literal> adhere to all the content requirements defined in
                                this section for constructing the primary navigation list, and
                                recursively (for each additional level of the Publication's
                                hierarchy represented in this manner).</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-ol-style">The <code role="markup">ol</code> element
                                represents an ordered list. In the context of this specification,
                                the default display style of list items <literal role="rfc2119">must</literal> be equivalent to CSS
                                    <property role="css">list-style: none</property> (Reading Systems with no CSS
                                support <literal role="rfc2119">must not</literal> show list item numbering). Authors <literal role="rfc2119">may</literal> specify
                                alternative list item styles using CSS, but these would obviously be
                                ignored by Reading Systems that do not support Cascading Style
                                Sheets. </para>
                        </listitem>
                    </itemizedlist>

                    <informalexample>
                        <para>The following example shows a partial <property role="rdfa">lot</property> ("list of
                            tables") <code role="markup">nav</code> element, with <code role="markup">span</code> elements used
                            as link-less headings for grouping the sublists.</para>
                        <synopsis><xi:include href="./examples/contentdocs-nav/grouped-list.xml" parse="text"/></synopsis>
                    </informalexample>
                </section>

                <section xml:id="sec-xhtml-nav-def-types">
                    <title>The <code role="markup">nav</code> Element: Types</title>

                    <para>The <code role="markup">nav</code> elements defined in an EPUB Navigation Document are
                        distinguished semantically by the value of their <code role="markup">epub:type</code>
                        attribute. By <link linkend="sec-contentdocs-default-vocab">default</link>,
                        values of <code role="markup">epub:type</code> are drawn from the EPUB 3 Structural
                        Semantics Vocabulary <xref linkend="refEPUBStructureVocab"/>, but values
                        drawn from other vocabularies are also allowed. Refer to <xref
                            linkend="sec-xhtml-content-type-attribute"/> for more information. </para>

                    <section xml:id="sec-xhtml-nav-def-types-toc">
                        <title>The <property role="rdfa">toc</property>
                            <code role="markup">nav</code> Element</title>

                        <para>The <property role="rdfa">toc</property>
                            <code role="markup">nav</code> element defines the primary navigational hierarchy of
                            the <xref linkend="gloss-epub-publication"/>. It conceptually
                            corresponds to a table of contents in a printed work (i.e., it provides
                            navigation to the structural sections of the Publication).</para>

                        <para>For usability and accessibility reasons, <xref linkend="gloss-author"
                            />s <literal role="rfc2119">should</literal> provide a comprehensive table of contents: the
                            <property role="rdfa">toc</property>
                            <code role="markup">nav</code> <literal role="rfc2119">should not</literal> exclude references based solely on their
                            nesting depth within the document hierarchy, as is often the case in
                            print works (particularly in reduced tables of contents).</para>

                        <para>In the case of Publications that exclusively reference XHTML Content
                            Documents from their spines, the <property role="rdfa">toc</property>
                            <code role="markup">nav</code> will typically correspond to the aggregation of <link
                                xlink:href="http://www.w3.org/TR/html5/Overview.html#headings-and-sections"
                                >HTML5 outlines</link> of those documents (excluding any subtrees
                            that do not contribute to the primary Publication outline).</para>

                        <para>The order of <code role="markup">li</code> elements contained within the
                            <property role="rdfa">toc</property>
                            <code role="markup">nav</code> element <literal role="rfc2119">must</literal> match the order of the targeted elements
                            within each <link linkend="confreq-nav-a-href">targeted EPUB Content
                                Document</link>, and <literal role="rfc2119">must</literal> also follow the order of Content Documents
                            in the Publication <xref linkend="gloss-spine"/>.</para>

                        <para>The <property role="rdfa">toc</property>
                            <code role="markup">nav</code> element <literal role="rfc2119">must</literal> occur exactly once in EPUB Navigation
                            Documents.</para>

                        <note>
                            <para>The <property role="css">toc</property>
                                <code role="markup">nav</code> element corresponds to the <code role="markup">navMap</code>
                                element in the superseded NCX <xref linkend="refOPF2"/>.</para>
                        </note>

                        <!--<note>
                            <para>When <xref linkend="gloss-content-document-epub-xhtml"/>s are used
                                in the Publication <xref linkend="gloss-spine"/>, authoring tools
                                <literal role="rfc2119">may</literal> utilize the <link
                                    xlink:href="http://www.w3.org/TR/html5/Overview.html#outlines"
                                    >HTML5 document outline algorithm</link> to generate the
                                    <literal>toc</literal>
                                <code role="markup">nav</code> element contents. Note, however, that when the spine
                                includes multiple Content Documents, the <literal>toc</literal>
                                <code role="markup">nav</code> element contains navigation information that spans
                                across multiple outlines (the full table of contents aggregates
                                outlines obtained from several XHTML Content Documents).</para>
                        </note>-->

                    </section>

                    <section xml:id="sec-xhtml-nav-def-types-pagelist">
                        <title>The <property role="css">page-list</property>
                            <code role="markup">nav</code> Element</title>

                        <para>The <property role="rdfa">page-list</property>
                            <code role="markup">nav</code> element is a container for pagination information. It
                            provides navigation to positions in the Publication content that
                            correspond to the locations of page boundaries present in a print source
                            being represented by this EPUB Publication.</para>

                        <para>The <property role="css">page-list</property>
                        	<code role="markup">nav</code> element is <literal role="rfc2119">optional</literal> in EPUB Navigation Documents and
                            <literal role="rfc2119">must not</literal> occur more than once. </para>

                        <para> The order of <code role="markup">li</code> elements contained within a
                                <property role="css">page-list</property>
                            <code role="markup">nav</code> structure <literal role="rfc2119">must</literal> match the order of the actual pages
                            inside each <link linkend="confreq-nav-a-href">targeted EPUB Content
                                Document</link> and <literal role="rfc2119">must</literal> also follow the order of Content Documents
                            in the Publication <xref linkend="gloss-spine"/>. </para>

                        <para>The <property role="css">page-list</property>
                            <code role="markup">nav</code> element <literal role="rfc2119">should</literal> contain only a single <code role="markup">ol</code>
                            descendant (i.e., it <literal role="rfc2119">should</literal> be a flat list, not a nested structure of
                            navigation items). </para>

                        <note>
                            <para>The <property role="css">page-list</property>
                                <code role="markup">nav</code> element corresponds to the <code role="markup">pageList</code>
                                element in the superseded NCX. <xref linkend="refOPF2"/></para>
                        </note>

                        <note>
                            <para>The <olink type="epub-spec" targetptr="sec-opf-dcsource"
                                    targetdoc="publications"/> element provides a means of
                                identifying the source publication to which the given pagination
                                information applies.</para>
                        </note>
                    </section>

                    <section xml:id="sec-xhtml-nav-def-types-landmarks">
                        <title>The <property role="css">landmarks</property>
                            <code role="markup">nav</code> Element</title>

                        <para>The <property role="rdfa">landmarks</property>
                            <code role="markup">nav</code> element identifies fundamental structural components of
                            the publication in order to enable Reading Systems to provide the User
                            efficient access to them.</para>

                        <para>The structural semantics of each link target within the
                            <property role="rdfa">landmarks</property>
                            <code role="markup">nav</code> element is determined by the value of the <link
                                linkend="sec-xhtml-content-type-attribute">epub:type</link>
                            attribute on the <code role="markup">a</code> element descendants. The
                        	<code role="markup">epub:type</code> attribute is <literal role="rfc2119">required</literal> on <code role="markup">a</code>
                            element descendants of the <property role="rdfa">landmarks</property>
                            <code role="markup">nav</code> element. </para>

                        <para xml:id="nav-landmarks-htu-extend">The <property role="rdfa">landmarks</property>
                            <code role="markup">nav</code> element extends the suggested <!-- TODO make olink -->
                            HTML context of terms from the <link linkend="refEPUBStructureVocab"
                                >EPUB Structural Semantics Vocabulary</link> to include the
                                <code role="markup">a</code> element. </para>

                        <informalexample>
                            <para>The following example shows a <property role="rdfa">landmarks</property>
                                <code role="markup">nav</code> element with structural semantics drawn from the
                                    <link linkend="refEPUBStructureVocab">EPUB Structural Semantics
                                    Vocabulary</link>.</para>
                            <synopsis><xi:include href="./examples/contentdocs-nav/landmarks.xml" parse="text"/></synopsis>
                        </informalexample>

                        <para>The <property role="css">landmarks</property>
                        	<code role="markup">nav</code> element is <literal role="rfc2119">optional</literal> in EPUB Navigation Documents and
                            <literal role="rfc2119">must not</literal> occur more than once. </para>

                        <note>
                            <para>The <property role="css">landmarks</property>
                                <code role="markup">nav</code> element corresponds to the deprecated OPF
                                    <code role="markup">guide</code> element. Refer to <olink type="epub-spec"
                                    targetdoc="publications" targetptr="sec-guide-elem"/> for more
                                information. </para>
                        </note>
                    </section>

                    <section xml:id="sec-xhtml-nav-def-types-other">
                        <title>Other <code role="markup">nav</code> Elements</title>

                        <para>EPUB Navigation Documents optionally <literal role="rfc2119">may</literal> include one or more
                            <code role="markup">nav</code> elements in addition to the <property role="rdfa">toc</property>,
                            <property role="rdfa">page-list</property> and <property role="rdfa">landmarks</property>
                            <code role="markup">nav</code> elements defined above. Such additional
                                <code role="markup">nav</code> elements <literal role="rfc2119">should</literal> have an <code role="markup">epub:type</code>
                            attribute to provide a machine-readable semantic, and <literal role="rfc2119">must</literal> have a
                            human-readable heading as their first child.</para>

                        <para>This specification imposes no restrictions on the semantics of such
                            additional <code role="markup">nav</code> elements: they <literal role="rfc2119">may</literal> be used to represent
                            navigational semantics for any information domain, and they <literal role="rfc2119">may</literal> contain
                            link targets with homogeneous or heterogeneous semantics.</para>

                    </section>
                </section>

                <section xml:id="sec-xhtml-nav-def-hidden">
                    <title>The <code role="markup">hidden</code> attribute</title>

                    <para>In some cases, <xref linkend="gloss-author"/>s may wish to hide parts of
                        the navigation data within the content flow (i.e., the Reading System's
                        principal rendering of the <xref linkend="gloss-spine"/> contents). A
                        typical example is the <link linkend="sec-xhtml-nav-def-types-pagelist">list
                            of page breaks</link>, which usually isn't rendered as part of the
                        content flow but instead exposed to the <xref linkend="gloss-user"/>
                        separately in a dedicated navigation user interface.</para>

                    <para> While the CSS <property role="css">display</property> property can be used to control
                        the visual rendering of EPUB Navigation Documents in Reading Systems with
                            <xref linkend="gloss-viewport-css"/>s, not all Reading Systems provide
                        such an interface. To control rendering across all Reading Systems, authors
                        <literal role="rfc2119">must</literal> use the <xref linkend="refHTML5"/>
                        <code role="markup"
                                xlink:href="http://www.w3.org/TR/html5/Overview.html#the-hidden-attribute"
                                >hidden</code> attribute to indicate which (if any) portions
                        of the navigation data are excluded from rendering in the content flow. The
                            <code role="markup">hidden</code> attribute has no effect on how navigation data is
                        rendered outside of the content flow (such as in dedicated navigation user
                        interfaces provided by Reading Systems).</para>

                    <informalexample>
                        <para>The following example shows a partial <property role="rdfa">page-list</property>
                            <code role="markup">nav</code> element. The presence of the <code role="markup">hidden</code>
                            attribute on the root indicates that the entire list is excluded from
                            rendering in the content flow.</para>
                        <synopsis><xi:include href="./examples/contentdocs-nav/page-list.xml" parse="text"/></synopsis>
                    </informalexample>

                    <informalexample>
                        <para>The following example shows a partial <property role="rdfa">toc</property>
                            <code role="markup">nav</code> element where the <code role="markup">hidden</code> attribute is used
                            to limit content flow rendering to the two topmost hierarchical
                            levels.</para>
                        <synopsis><xi:include href="./examples/contentdocs-nav/toc.xml" parse="text"/></synopsis>
                    </informalexample>

                </section>
            </section>
        </section>

        <section xml:id="sec-svg">
            <title>SVG Content Documents</title>
            <section xml:id="sec-svg-intro" conformance="informative">
                <title>Introduction</title>

                <para>The Scalable Vector Graphics (SVG) 1.1 (Second Edition) specification <xref
                        linkend="refSVG"/> defines a format for representing final-form vector
                    graphics and text.</para>

                <para>Although an EPUB Publication typically uses <link linkend="sec-xhtml">XHTML
                        Content Documents</link> as the <link
                        linkend="gloss-content-document-top-level">top-level</link> document type,
                    the use of <xref linkend="gloss-content-document-epub-svg"/>s is also permitted.
                    SVGs are typically only used in certain special circumstances, such as when
                    final-form page images are the only suitable representation of the content (as
                    may be the case, for example, in the context of manga or comic books). </para>

                <para>This section defines a profile for <xref linkend="refSVG"/> documents. An
                    instance of an XML document that conforms to this profile is a <xref
                        linkend="gloss-core-media-type"/> and is referred to in this specification
                    and its <link linkend="sibling-specs">sibling specifications</link> as an <xref
                        linkend="gloss-content-document-epub-svg"/>.</para>

                <note>
                    <para>This section defines conformance requirements for <xref
                            linkend="gloss-content-document-epub-svg"/>s. Refer to <xref
                            linkend="sec-xhtml-svg"/> for conformance requirements for SVG embedded
                        in XHTML Content Documents.</para>
                </note>

            </section>
            <section xml:id="sec-svg-content-conf"
                xreflabel="SVG Content Documents — Content Conformance">
                <title>Content Conformance</title>
                <variablelist role="conformance-list">
                    <para>An <xref linkend="gloss-content-document-epub-svg"/> <literal role="rfc2119">must</literal> meet all of the
                        following criteria:</para>
                    <varlistentry xml:id="confreq-mo-docprops">
                        <term>Document Properties</term>
                        <listitem role="conformance-item">
                            <para xml:id="confreq-cd-svg-xml">
                                <xi:include href="./share/xml-defref.xml"/>
                            </para>
                            <para xml:id="confreq-cd-svg-docprops-schema">It <literal role="rfc2119">must</literal> be an <link
                                    xlink:href="http://www.w3.org/TR/SVG/intro.html#TermSVGDocumentFragment"
                                    >SVG 1.1 document fragment</link> valid to the constructs defined in
                            	that specification, and conform to all content conformance constraints expressed in <xref
                                    linkend="sec-svg-restrictions"/>.</para>
                            <para xml:id="confreq-cd-svg-accessibility">It <literal role="rfc2119">should</literal> adhere to the
                                accessibility guidelines given in <xref linkend="refSVGAccess"/>.
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="confreq-svg-fileprops">
                        <term>File Properties</term>
                        <listitem>
                            <para xml:id="confreq-svg-fileprops-name">The SVG Content Document
                                filename <literal role="rfc2119">should</literal> use the file extension
                                <filename>.svg</filename>.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <note xml:id="note-cd-svg-refprops-pkg">
                    <!-- note similar statement for xhtml, svg and css-->
                    <para>All <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s
                        referenced from an SVG Content Document must conform to the constraints for
                        Publication Resources defined in <olink type="epub-spec"
                            targetdoc="publications" targetptr="sec-epub-content-conf"/></para>
                </note>
            </section>
            <section xml:id="sec-svg-restrictions">
                <title>Restrictions on SVG 1.1</title>

                <para>This specification restricts the content model of <xref
                        linkend="gloss-content-document-epub-svg"/>s and <link
                        linkend="sec-xhtml-svg">SVG embedded in XHTML Content Documents</link> as
                    follows:</para>

                <itemizedlist role="conformance-list" xml:id="sec-svg-restrictions-list">
                    <listitem>
                        <para xml:id="confreq-svg-anim">The <xref linkend="refSVG"/>
                            <link
                                xlink:href="http://www.w3.org/TR/SVG/animate.html#AnimationElements"
                                >Animation Elements</link> and <link
                                xlink:href="http://www.w3.org/TR/SVG/script.html#AnimationEvents"
                                >Animation event attributes</link> <literal role="rfc2119">must not</literal> occur. </para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-foreignObject">The <xref linkend="refSVG"/>
                            <code role="markup"
                                    xlink:href="http://www.w3.org/TR/SVG11/extend.html#ForeignObjectElement"
                                    >svg:foreignObject</code> element <literal role="rfc2119">must</literal> contain either
                            <xref linkend="refHTML5"/> <link xlink:href="http://www.w3.org/TR/html5/single-page.html#flow-content">flow content</link>
                            or exactly one <xref linkend="refHTML5"/> <link xlink:href=""><code role="markup">body</code> element</link>. This content 
                            <literal role="rfc2119">must</literal> represent a valid document fragment of the XHTML Content Document
                            model defined in <xref linkend="sec-xhtml-conf-content"/>.
                            The <code role="markup">svg:foreignObject</code> element's <code role="markup">requiredExtensions</code>
                            attribute, if given, <literal role="rfc2119">must</literal> be set to
                            <uri>http://www.idpf.org/2007/ops</uri>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-title">The <xref linkend="refSVG"/>
                            <code role="markup"
                                    xlink:href="http://www.w3.org/TR/SVG11/struct.html#TitleElement"
                                    >svg:title</code> element <literal role="rfc2119">must</literal> contain only valid XHTML
                            Content Document Phrasing content.</para>
                    </listitem>
                    <!-- <listitem>
                        <para xml:id="confreq-svg-dim">It <literal role="rfc2119">should</literal> include the <code role="markup"><link
                                    xlink:href="http://www.w3.org/TR/SVG/struct.html#SVGElementWidthAttribute"
                                    >width</link></code> and <code role="markup"><link
                                    xlink:href="http://www.w3.org/TR/SVG/struct.html#SVGElementHeightAttribute"
                                    >height</link></code> attributes on the <code role="markup">svg:svg</code>
                            element.</para>
                    </listitem> -->
                </itemizedlist>

            </section>
            <section xml:id="sec-svg-rs-conf"
                xreflabel="SVG Content Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para>A conformant <xref linkend="gloss-epub-reading-system"/> <literal role="rfc2119">must</literal> meet all of the
                    following criteria for processing SVG Content Documents and SVG <link
                        linkend="sec-xhtml-svg">embedded in XHTML Content Documents</link>:</para>

                <itemizedlist role="conformance-list" xml:id="svg-rs-confreqs">
                    <!--
                    <listitem>
                        <para xml:id="confreq-svg-rs-behavior">It <literal role="rfc2119">must</literal> support processing of SVG
                            using semantics defined by the SVG 1.1 specification <xref
                                linkend="refSVG"/>.</para>
                    </listitem>
                    -->
                    <listitem>
                        <para xml:id="confreq-svg-rs-behavior">It <literal role="rfc2119">must</literal> support the language features
                            of SVG that correspond to the feature string
                                <uri>http://www.w3.org/TR/SVG11/feature#SVG-dynamic</uri>
                            minus the
                                <uri>http://www.w3.org/TR/SVG11/feature#Animation</uri> and
                                <uri>http://www.w3.org/TR/SVG11/feature#AnimationEventsAttribute</uri>
                            features (see <link xlink:href="http://www.w3.org/TR/SVG/feature.html"
                                >Feature strings</link>) <xref linkend="refSVG"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-rs-scrpt">It <literal role="rfc2119">must</literal> meet the Reading System
                            conformance criteria defined in <xref
                                linkend="sec-scripted-content-rs-reqs"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-rs-css">If it has an <xref
                                linkend="gloss-viewport-svg"/>, it <literal role="rfc2119">must</literal> support the visual rendering
                            of SVG using CSS as defined in <link
                                xlink:href="http://www.w3.org/TR/SVG11/styling.html">Section
                                6</link> of <xref linkend="refSVG"/>, and it <literal role="rfc2119">should</literal> support all
                            properties defined in <link
                                xlink:href="http://www.w3.org/TR/SVG11/propidx.html">Appendix
                            	N</link> of that specification. In the case of embedded SVG, it <literal role="rfc2119">must</literal>
                            also conform to the constraints defined in <xref
                                linkend="sec-xhtml-svg-css"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-rs-text">It <literal role="rfc2119">should</literal> support User selection and
                            searching of text within SVG elements.</para>
                    </listitem>
                    <!-- not needed as we changed confreq-svg-rs-behavior
                    <listitem>
                        <para xml:id="confreq-svg-rs-links">It <literal role="rfc2119">must</literal> recognize SVG links (i.e., the
                                <code role="markup">svg:a</code> element), and if it supports exposing links to
                            Users for activation, then these links <literal role="rfc2119">must</literal> be exposed. </para>
                    </listitem>
                    -->
                    <listitem>
                        <para xml:id="confreq-svg-rs-reqdExt">It <literal role="rfc2119">must</literal> recognize the value
                                <uri>http://www.idpf.org/2007/ops</uri> of the
                                <code role="markup">requiredExtensions</code> attribute when appearing on the
                                <code role="markup">svg:switch</code> and <code role="markup">svg:foreignObject</code> elements
                            as representing the occurrence of XHTML Content Document
                            fragments.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-svg-prop">It <literal role="rfc2119">must</literal> regard the <olink
                                type="epub-spec" targetdoc="publications" targetptr="svg"/> property
                            of the <xref linkend="gloss-package-document"/>
                            <xref linkend="gloss-manifest"/>
                            <code role="markup">item</code> element as the authoritative definition of whether an
                            EPUB XHTML Content Document includes embedded SVG.</para>
                    </listitem>
                </itemizedlist>
            </section>
        </section>

        <section xml:id="sec-scripted-content">
            <title>Scripted Content Documents</title>

            <para><xref linkend="gloss-content-document-epub"/>s <literal role="rfc2119">may</literal> contain scripting using the
                facilities defined for this in the respective underlying specifications (<xref
                    linkend="refHTML5"/> and <xref linkend="refSVG"/>). When an EPUB Content
                Document contains scripting, it is referred to in this specification and its <link
                    linkend="sibling-specs">sibling specifications</link> as a <xref
                    linkend="gloss-content-document-epub-scripted"/>. This label also applies to
                    <xref linkend="gloss-content-document-epub-xhtml"/>s when they contain instances
                of <link xlink:href="http://www.w3.org/TR/html5/Overview.html#forms">HTML5
                    forms</link>.</para>

            <section xml:id="sec-scripted-context">
                <title>Scripting Contexts</title>

                <para xml:id="sec-scripted-content-models">This specification defines two contexts
                    in which scripts <literal role="rfc2119">may</literal> appear:</para>

                <variablelist>
                    <varlistentry xml:id="sec-scripted-content-type-spine-level"
                        xreflabel="spine-level">
                        <term>spine-level</term>
                        <listitem>
                            <para>An instance of the <xref linkend="refHTML5"/>
                                <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-script-element"
                                        >script</code> element included in a <xref
                                    linkend="gloss-content-document-top-level"/>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="sec-scripted-content-type-container-constrained"
                        xreflabel="container-constrained">
                        <term>container-constrained</term>
                        <listitem>
                            <para>An instance of the <xref linkend="refHTML5"/>
                                <code role="markup">script</code> element included in an <xref
                                    linkend="gloss-content-document-epub"/> that is embedded in a
                                parent Content Document using one of the <xref linkend="refHTML5"/>
                                <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</code>, <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-iframe-element"
                                        >iframe</code> or <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-embed-element"
                                        >embed</code> elements.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <para>In both of the above-defined contexts, whether the JavaScript code is embedded
                    directly in the <code role="markup">script</code> element or referenced via its
                        <code role="markup">src</code> attribute makes no difference to the executing
                    context.</para>

                <para>Which context a script is used in determines the rights and restrictions that
                    a Reading System may place on it. Refer to <link
                        linkend="sec-scripted-content-content-reqs">Content Conformance</link> and
                        <link linkend="sec-scripted-content-rs-reqs">Reading System
                        Conformance</link> for some specific requirements that must be adhered to
                    (not all Reading Systems may provide the same scripting functionality).</para>

                <bridgehead>Example</bridgehead>

                <para>Consider the following example Package Document:</para>

                <informalexample>
                    <synopsis><xi:include href="examples/contentdocs/scriptcontext-01.xml" parse="text"/></synopsis>
                </informalexample>

                <para>and the following file <filename>scripted01.xhtml</filename>:</para>

                <informalexample>
                    <synopsis><xi:include href="examples/contentdocs/scriptcontext-02.xml" parse="text"/></synopsis>
                </informalexample>

                <para>and the following file <filename>scripted02.xhtml</filename>:</para>

                <informalexample>
                    <synopsis><xi:include href="examples/contentdocs/scriptcontext-03.xml" parse="text"/></synopsis>
                </informalexample>

                <para>From these examples, it is true that:</para>

                <itemizedlist>
                    <listitem>
                        <para>the code in the <code role="markup">script</code> element in the <code role="markup">head</code>
                            in <filename>scripted01.xhtml</filename> is a spine-level script because
                            the document is referenced from the spine;</para>
                    </listitem>
                    <listitem>
                        <para>the code in the <code role="markup">script</code> element in
                                <filename>scripted02.xhtml</filename> is a container-constrained
                            script because the HTML file it occurs in is included in
                                <filename>scripted01.xhtml</filename> via the <code role="markup">iframe</code>
                            element.</para>
                    </listitem>
                </itemizedlist>

            </section>

            <section xml:id="sec-scripted-content-content-reqs"
                xreflabel="Scripted Content Documents — Content Conformance">
                <title>Content Conformance</title>

                <variablelist role="conformance-list">
                    <varlistentry>
                        <term>Container-constrained scripts</term>
                        <listitem>
                            <para xml:id="confreq-cd-scripted-container">A container-constrained
                                script <literal role="rfc2119">must not</literal> contain instructions for modifying the DOM of the
                                parent Content Document or other contents in the Publication, and
                                <literal role="rfc2119">must not</literal> contain instructions for manipulating the size of its
                                containing rectangle.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Spine-level scripts</term>
                        <listitem>
                            <para xml:id="confreq-cd-scripted-spine">EPUB Content Documents that
                                include <xref linkend="sec-scripted-content-type-spine-level"/>
                                scripting <literal role="rfc2119">must</literal> utilize the <emphasis>progressive enhancement
                                    technique</emphasis>, which for the purposes of this
                                specification has the following definition: when the document is
                                rendered by a Reading System without scripting support or with
                                scripting support disabled, the <link
                                    linkend="gloss-content-document-top-level">top-level document
                                    content</link> <literal role="rfc2119">must</literal> retain its integrity, remaining consumable
                                by the User without any information loss or other significant
                                deterioration.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Accessibility</term>
                        <listitem>
                            <para xml:id="confreq-cd-scripted-a11y">EPUB Content Documents that
                                include scripting — using any <link
                                    linkend="sec-scripted-content-models">inclusion model</link> —
                                <literal role="rfc2119">should</literal> employ relevant accessibility techniques to ensure that the
                                content remains consumable by all Users. <xref linkend="refARIA"/>
                                <xref linkend="refWCAG20"/>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="confreq-cd-scripted-flbk"
                        xreflabel="Fallbacks for Scripted Content Documents">
                        <term>Fallbacks</term>
                        <listitem>
                            <!--
                            <para xml:id="confreq-cd-scripted-flbk-canvas">EPUB Content Documents
                                that include the HTML <code role="markup">canvas</code> element for scripting
                                purposes <literal role="rfc2119">should</literal> include non-scripted fallback content using the
                                intrinsic model for fallback as defined by <code role="markup">canvas</code>
                                <xref linkend="refHTML5"/>.</para>
                            <para xml:id="confreq-cd-scripted-flbk-object">EPUB Content Documents
                                that include the HTML <code role="markup">object</code> element for scripting
                                purposes <literal role="rfc2119">should</literal> include non-scripted fallback content using the
                                intrinsic model for fallback as defined by <code role="markup">object</code>
                                <xref linkend="refHTML5"/>.</para> -->
                            <para xml:id="confreq-cd-scripted-fallback">EPUB Content Documents that
                                include scripting — using any <link
                                    linkend="sec-scripted-content-models">inclusion model</link> —
                                <literal role="rfc2119">may</literal> provide fallbacks for such content, either by using intrinsic
                                fallback mechanisms (such as those available for the <xref
                                    linkend="refHTML5"/>
                                <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</code> and <code role="markup"
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-canvas-element"
                                        >canvas</code> elements) or, when an intrinsic
                                fallback is not applicable, by using a <olink type="epub-spec"
                                    targetdoc="publications"
                                    targetptr="sec-fallback-processing-flow-manifest"
                                    >manifest-level</olink> fallback.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <note>
                    <para>The <property role="css"><olink type="epub-spec" targetdoc="publications"
                                targetptr="scripted"/></property> property of the <xref
                            linkend="gloss-manifest"/>
                        <code role="markup">item</code> element indicates that an EPUB Content Document is a <xref
                            linkend="gloss-content-document-epub-scripted"/>.</para>
                </note>
                <!-- TODO handler note -->
            </section>

            <section xml:id="sec-scripted-content-rs-reqs"
                xreflabel="Scripted Content Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

            	<para><xref linkend="gloss-epub-reading-system"/> support for scripting is <literal role="rfc2119">optional</literal>.
                    A Reading System that supports scripting <literal role="rfc2119">must</literal> meet the following
                    criteria:</para>

                <itemizedlist role="conformance-list">
                    <listitem>
                        <para xml:id="confreq-rs-scripted-support">It <literal role="rfc2119">must</literal> support <xref
                                linkend="sec-scripted-content-type-container-constrained"/>
                            scripting and <literal role="rfc2119">may</literal> support <xref
                                linkend="sec-scripted-content-type-spine-level"/> scripting.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-ua">It <literal role="rfc2119">may</literal> render <xref
                                linkend="gloss-content-document-epub-scripted"/>s as an interactive,
                            scripted User Agent according to <xref linkend="refHTML5"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-container">It <literal role="rfc2119">must not</literal> allow a
                            container-constrained script to modify the DOM of the parent Content
                            Document or other contents in the Publication, and <literal role="rfc2119">must not</literal> allow it to
                            manipulate the size of its containing rectangle. (Note: Even if a script
                            is not container-constrained, the Reading System <literal role="rfc2119">may</literal> impose restrictions
                            on modifications (see also the <link linkend="feature-dom-manipulation"
                                >dom-manipulation feature</link>).)</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-limit">It <literal role="rfc2119">may</literal> place additional limitations
                            on the capabilities provided to scripts during execution (e.g., limiting
                            networking).</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-readingsystem-object">It <literal role="rfc2119">must</literal> implement
                            the JavaScript <code role="markup">navigator</code> extension object
                                <code role="markup">epubReadingSystem</code> defined in <xref
                                linkend="app-epubReadingSystem"/>. It also <literal role="rfc2119">must</literal> support the
                                <code role="markup">dom-manipulation</code> and <code role="markup">layout-change</code>
                            features defined in <xref linkend="app-ers-hasFeature-features"/> in
                            container-constrained scripting contexts.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-prop">It <literal role="rfc2119">must</literal> regard the <property role="rdfa"><olink
                                    type="epub-spec" targetdoc="publications" targetptr="scripted"
                                    >scripted</olink></property> property of the <xref
                                linkend="gloss-package-document"/>
                            <xref linkend="gloss-manifest"/>
                            <code role="markup">item</code> element as the authoritative definition of whether an
                            EPUB Content Document includes scripting.</para>
                    </listitem>
                </itemizedlist>

                <para>A Reading System that does not support scripting <literal role="rfc2119">must</literal> meet the following
                    criteria:</para>

                <itemizedlist role="conformance-list">
                    <listitem>
                        <para xml:id="confreq-rs-scripted-flbk">It <literal role="rfc2119">must</literal> process fallbacks for
                            scripted content as defined in <xref linkend="confreq-cd-scripted-flbk"
                            />.</para>
                    </listitem>
                </itemizedlist>

                <note>
                    <para>Reading Systems may render Scripted Content Documents in a manner that
                        disables other EPUB capabilities and/or provides a different rendering and
                        User experience (e.g., by disabling pagination).</para>

                    <para>Authors choosing to restrict the usage of scripting to the <xref
                            linkend="sec-scripted-content-type-container-constrained"/> model will
                        ensure a more consistent User experience between scripted and non-scripted
                        content (e.g., consistent pagination behavior).</para>

                    <para>Authors should use declarative techniques whenever practical to increase
                        the interoperability, longevity and accessibility of their Publications, and
                        avoid the inclusion of scripting whenever practical.</para>
                </note>
            </section>

            <section xml:id="sec-scripted-content-security" conformance="informative">
                <title>Security Considerations</title>

                <para>All EPUB <xref linkend="gloss-author"/>s and Reading System developers need to
                    be aware of the security issues that arise when scripted content is executed by
                    a Reading System. As the underlying scripting model employed by Reading Systems
                    and browsers is the same, the same kinds of issues encountered in Web contexts
                    must be taken into consideration.</para>

                <para>Each Reading System should establish if the scripts in a particular document
                    are to be trusted or not. It is recommended that all scripts be treated as
                    untrusted (and potentially malicious), and that all vectors of attack be
                    examined and protected against. In particular, the following should be
                    considered:</para>

                <itemizedlist>
                    <listitem>
                        <para>an attack against the runtime environment (e.g., stealing files from a
                                <xref linkend="gloss-user"/>'s hard drive);</para>
                    </listitem>
                    <listitem>
                        <para>an attack against the Reading System itself (e.g., stealing a list of
                            a User's books or causing unexpected behavior);</para>
                    </listitem>
                    <listitem>
                        <para>an attack of one Content Document against another (e.g., stealing data
                            that originated in a different document);</para>
                    </listitem>
                    <listitem>
                        <para>an attack of an unencrypted script against an encrypted portion of a
                            document (e.g., an injected malicious script extracting protected
                            content);</para>
                    </listitem>
                    <listitem>
                        <para>an attack against the local network (e.g., stealing data from a server
                            behind a firewall).</para>
                    </listitem>
                </itemizedlist>

                <para>The following recommendations are provided as a guide to handling untrusted
                    scripts:</para>

                <itemizedlist>
                    <listitem>
                        <para>Reading Systems should behave as if a unique domain were allocated to
                            each Content Document, as browser-based security relies heavily on
                            document URLs and domains. Adopting this approach will isolate documents
                            from each other and from other Internet domains, thereby limiting access
                            to external URLs, cookies, DOM storage, etc.</para>
                        <para>Reading Systems that enable scripting and network access should also
                            consider including methods to notify the user that network activity is
                            occurring and/or that allow them to disable it.</para>
                        <note>
                            <para>In practice, Reading Systems may share domains across documents,
                                but they still should maintain isolation between documents.</para>
                            <para>If parts of a document are encrypted and parts are not, or if
                                different encryption keys are used for different parts of the
                                document, a unique per-document domain might not provide sufficient
                                protection.</para>
                        </note>
                    </listitem>
                    <listitem>
                        <para>If a Reading System allows persistent data to be stored, that data
                            should be treated as sensitive. Scripts may save persistent data through
                            cookies and DOM storage, but Reading Systems may block such attempts.
                            Reading Systems that do allow data to be stored must ensure that it is
                            not made available to other unrelated documents (e.g., ones that could
                            have been spoofed). In particular, checking for a matching document
                            identifier (or similar metadata) is not a valid method to control access
                            to persistent data.</para>
                        <para>Reading Systems that allow local storage should also provide methods
                            for Users to inspect, disable, or delete that data. The data should be
                            destroyed if the corresponding EPUB Publication is deleted.</para>
                    </listitem>
                </itemizedlist>

                <para>Note that compliance with these recommendations does not guarantee protection
                    from the possible attacks listed above; developers must examine each potential
                    vulnerability within the context of their Reading System.</para>
            </section>

            <section xml:id="sec-scripted-content-events" conformance="informative">
                <title>Event Model Considerations</title>

                <para>Reading Systems should follow the DOM Event model as per <xref
                        linkend="refHTML5"/> and pass UI events to the scripting environment before
                    performing any default action associated with these events. Reading System
                    implementers should ensure that scripts cannot disable critical functionality
                    (such as navigation) to constrain the extent to which a <link
                        linkend="sec-scripted-content-events">potentially malicious</link> script
                    could impact their Reading Systems. As a result, although the scripting
                    environment should be able to cancel the default action of any event, some
                    events either might not be passed through or might not be cancelable.</para>

                <para><xref linkend="gloss-author"/>s should take into account the wide variety of
                    possible Reading System implementations when adding scripting functionality to
                    their Publications (e.g., not all devices have physical keyboard, and in many
                    cases a soft keyboard is only activated only for text input elements).
                    Consequently, relying on keyboard events alone is not recommended; alternative
                    ways to trigger the desired action should always be provided.</para>

            </section>

        </section>
		
		<section xml:id="sec-fixed-layouts">
			<title>Fixed-Layout Documents</title>
			
			<section xml:id="sec-fxl-overview" conformance="informative">
				<title>Introduction</title>
				
				<para>This section defines rules for the expression and interpretation of dimensional
				    properties of <xref linkend="gloss-content-document-epub"/>s marked as <property role="rdfa">pre-paginated</property>
				    in the <xref linkend="gloss-package-document"/>.</para>
				
				<para>This specification does not define how the the <link xlink:href="icb">initial containing block</link>, 
				    will be placed within the Reading System content display area.</para>
				
				<note>
					<para>Refer to <olink type="epub-spec" targetdoc="publications" targetptr="sec-package-metadata-fxl"/>
						for information on how to designate that a Publication, or its individual spine items,
						are to be rendered in a pre-paginated manner (i.e., with fixed width and height dimensions).</para>
				</note>
			</section>
			
			<section xml:id="sec-fxl-rs-conf"
				xreflabel="Fixed Layouts — Reading System Conformance">
				<title>Reading System Conformance</title>
				
				<para>A conformant <xref linkend="gloss-epub-reading-system"/> <literal role="rfc2119">must</literal> meet all of the
					following criteria for processing <xref linkend="gloss-fixed-layout-document"/>s:</para>
				
				<itemizedlist role="conformance-list" xml:id="image-rs-confreqs">
					<listitem>
						<para xml:id="confreq-fxl-rs-viewport">It <literal role="rfc2119">should</literal> allocate the full 
							content rendering area for the document.</para>
					</listitem>
					<listitem>
						<para xml:id="confreq-fxl-rs-xhtml">It <literal role="rfc2119">must</literal> use the dimensions
						    expressed in the <property role="rdfa">viewport</property> <code role="markup">meta</code> tag to render 
						    <xref linkend="gloss-content-document-epub-xhtml"/>s, but <literal role="rfc2119">may</literal> 
						    obtain these dimensions from the package 
						    <olink type="epub-spec" targetdoc="publications" targetptr="fxl-property-viewport"/>.</para>
					</listitem>
					<listitem>
						<para xml:id="confreq-fxl-rs-svg">It <literal role="rfc2119">must</literal> use the dimensions
							expressed in the <code role="markup">viewBox</code> attribute to render
						    <xref linkend="gloss-content-document-epub-svg"/>s, but <literal role="rfc2119">may</literal> 
						    obtain these dimensions from the package
						    <olink type="epub-spec" targetdoc="publications" targetptr="fxl-property-viewport"/>.</para>
					</listitem>
				    <listitem>
				        <para xml:id="confreq-fxl-rs-content-precedence">It <literal role="rfc2119">must</literal> use the
				            dimensions expressed in the content in the case of discrepancies with the package
				            <olink type="epub-spec" targetdoc="publications" targetptr="fxl-property-viewport"/>.</para>
				    </listitem>
				</itemizedlist>
			</section>
			
			<section xml:id="sec-fxl-synthetic-spreads">
				<title>Viewport Rendering</title>
				
				<para>When rendering Fixed-Layout Documents, the default intent is that the content rendering area
					<literal role="rfc2119">should</literal> occupy as much of the available application screen area as possible.
					Reading Systems <literal role="rfc2119">should not</literal> inject additional content such as border, margins,
					headers or footers into the viewport or the application area surrounding the viewport.</para>
				
				<note>
					<para>The exposure of Reading System control widgets to the <xref linkend="gloss-user"/> is implementation-specific
						and not included in the above behavioral expectations.</para>
				</note>
			</section>
			
			<section xml:id="sec-fxl-xhtml-svg-dimensions">
				<title>Content Dimensions for XHTML and SVG</title>
				
				<para>Each <xref linkend="gloss-content-document-epub"/> referenced from a spine item that has the <property role="rdfa">pre-paginated</property> 
					value set <literal role="rfc2119">must</literal> contain the <property role="html">viewport</property> (for XHTML) or <code role="markup">viewBox</code> (for SVG) dimension 
					expressions as defined below, regardless of whether the value is set via the global 
					<olink type="epub-spec" targetdoc="publications" targetptr="fxl-property-layout">rendition:layout property</olink> 
					for the Publication or on a 
					<olink type="epub-spec" targetdoc="publications" targetptr="fxl-property-layout-overrides">spine-level override</olink>.</para>
				
				<para>For both XHTML and SVG Content Documents, the dimension expressions define the CSS initial containing block (ICB) expressed in 
					CSS Pixels <xref linkend="refCSS21"/>.</para>
				
				<section xml:id="sec-fxl-icb-xhtml">
					<title>Expressing ICB Dimensions in XHTML</title>
					
					<para>For XHTML Content Documents, 
						the ICB dimensions <literal role="rfc2119">must</literal> be expressed in 
					    a <property role="rdfa">viewport</property> <code role="markup">meta</code> tag using the syntax defined in <xref linkend="refMetaTags"/>. 
						In this version of this specification, only the width and height expressions <literal role="rfc2119">must</literal> be 
						recognized by Reading Systems.</para>
					
					<informalexample>
						<para>The following example shows a <property role="html">viewport</property> <code role="markup">meta</code> tag.</para>
						<synopsis>
<xi:include href="./examples/contentdocs/fxl-xhtml-01.xml" parse="text"/></synopsis>
					</informalexample>
					
					<para>Reading Systems <literal role="rfc2119">must</literal> clip XHTML content to the ICB dimensions declared 
						in the <property role="html">viewport</property> <code role="markup">meta</code> tag; content positioned outside of the initial
						containing block will not be visible. When the ICB aspect ratio does not match the aspect ratio of the 
						Reading System content display area, Reading Systems <literal role="rfc2119">may</literal> position the 
						ICB inside the area to accommodate the user interface; in other words, added letter-boxing space 
						<literal role="rfc2119">may</literal> appear on either side (or both) of the content.</para>
				</section>
				
				<section xml:id="sec-fxl-icb-svg">
					<title>Expressing ICB Dimensions in SVG</title>
					
					<para>For SVG Content Documents,
						the ICB dimensions <literal role="rfc2119">must</literal> be expressed using the <code
							xlink:href="http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute">viewBox</code>
							attribute <xref linkend="refSVG"/>.</para>
					
					<informalexample>
					    <para>The following example shows a <code role="markup">viewBox</code> attribute declaration.</para>
						<synopsis>
<xi:include href="./examples/contentdocs/fxl-svg-01.xml" parse="text"/></synopsis>
					</informalexample>
				</section>
			</section>
		</section>
    </chapter>

    <chapter xml:id="sec-css">
        <title>EPUB Style Sheets</title>

        <para>This section defines a profile for Cascading Style Sheets (CSS) intended to be used
            for styling of <xref linkend="gloss-content-document-epub-xhtml"/>s. An instance of a
            CSS Style Sheet that conforms to this profile is a <xref linkend="gloss-core-media-type"
            /> and is referred to in this specification and its <link linkend="sibling-specs"
                >sibling specifications</link> as an <link linkend="gloss-stylesheet">EPUB Style
                Sheet</link>.</para>

        <caution xml:id="caution-css">
            <para>The EPUB 3 CSS Profile references CSS specifications that are still works in
                progress and may change in incompatible ways. When utilizing features from such
                specifications, authors should consider the inherent risks in terms of the potential
                impact on interoperability and document longevity.</para>
        </caution>

        <note xml:id="note-css-unprefixed-authoring">
            <para>The EPUB 3 CSS Profile employs the usage of the <property role="css">-epub-</property>
                <link xlink:href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords"
                    >prefix</link> for a number of CSS3 <!-- keywords and --> property names, as
                detailed below. As the CSS3 modules that define these properties mature and
                stabilize, EPUB authoring guidelines may encourage authors to also include
                unprefixed equivalents of these properties in EPUB 3 Style Sheets.</para>
        </note>

        <section xml:id="sec-css-content-conf" xreflabel="EPUB Style Sheets — Content Conformance">
            <title>Content Conformance</title>

            <para>A conformant <xref linkend="gloss-stylesheet"/> <literal role="rfc2119">must</literal> meet all of the following
                criteria:</para>

            <itemizedlist role="conformance-list">
                <listitem xml:id="confreq-content-css-support">
                    <para>It <literal role="rfc2119">must</literal> adhere to all content restrictions given in <xref
                            linkend="sec-css-profile"/>.</para>
                </listitem>
                <listitem xml:id="confreq-content-css-unsupport">
                    <para>It <literal role="rfc2119">may</literal> include constructs not explicitly identified in the EPUB 3 CSS
                        Profile, but <literal role="rfc2119">should</literal> be authored so that rendering fidelity does not depend
                        on such additional constructs.</para>
                </listitem>
                <listitem xml:id="confreq-content-css-encoding">
                    <para>It <literal role="rfc2119">must</literal> be UTF-8 or UTF-16 encoded.</para>
                </listitem>
            </itemizedlist>

            <note xml:id="note-css-refprops-pkg">
                <!-- note similar statement for xhtml, svg and css-->
                <para>All <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s referenced
                    from a CSS Style Sheet must conform to the constraints for Publication Resources
                    defined in <olink type="epub-spec" targetdoc="publications"
                        targetptr="sec-epub-content-conf"/></para>
            </note>

        </section>

        <section xml:id="sec-css-rs-conf" xreflabel="EPUB Style Sheets — Reading System Conformance">
            <title>Reading System Conformance</title>

            <itemizedlist role="conformance-list">
                <listitem xml:id="confreq-rs-css-support">
                    <para>Reading Systems with a <xref linkend="gloss-viewport-css"/> <literal role="rfc2119">should</literal> support
                        — render as defined by the corresponding specification in the Viewport — all
                        CSS constructs included in this profile unless detailed otherwise in <xref
                            linkend="sec-css-profile"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-css-unsupport">Reading Systems <literal role="rfc2119">may</literal> support additional
                    	CSS constructs not explicitly identified in the EPUB 3 CSS Profile, and <literal role="rfc2119">must</literal>
                        handle any unsupported constructs as <link
                            xlink:href="http://www.w3.org/TR/CSS21/conform.html#ignore"
                            >defined</link> in <xref linkend="refCSS21"/>. </para>
                </listitem>
            </itemizedlist>
            <note xml:id="note-rs-css-support">
                <para>Reading Systems have varying capabilities with regards to CSS rendering
                    support, so may ignore some or all style information of an EPUB Style
                    Sheet.</para>
                <para>In addition, even when a Reading System does have a <xref
                        linkend="gloss-viewport-css"/>, it is likely to render content in a manner
                    that differs from typical HTML5 User Agents (e.g., paginating content rather
                    than providing a infinitely scrolling surface). </para>
            </note>
        </section>

        <section xml:id="sec-css-profile">
            <title>EPUB 3 CSS Profile</title>

            <section xml:id="sec-css-2.1">
                <title>CSS 2.1</title>

                <para>The style baseline of the EPUB 3 CSS Profile is Cascading Style Sheets Level 2
                    Revision 1 <xref linkend="refCSS21"/>. The profile includes all style sheet
                    constructs normatively defined in <xref linkend="refCSS21"/>, with the following
                    exceptions:</para>

                <itemizedlist>
                    <listitem>
                        <para>The <code role="value">fixed</code> value of the
                                <property role="css">position</property> property is not part of the EPUB 3 CSS
                            Profile. To avoid potential rendering and interoperability issues, it
                            <literal role="rfc2119">should not</literal> be included in an EPUB Style Sheet.</para>
                    </listitem>
                    <listitem>
                        <para>The <property role="css">direction</property> and
                                <property role="css">unicode-bidi</property> properties <literal role="rfc2119">must not</literal> be included in
                            an EPUB Style Sheet. Authors <literal role="rfc2119">should</literal> use appropriate <xref
                                linkend="refHTML5"/> markup to express directionality information
                            instead. </para>
                    </listitem>
                </itemizedlist>

                <para>Reading Systems that have a <xref linkend="gloss-viewport-css"/> <literal role="rfc2119">must</literal> support
                    the <property role="css">font-family</property> property.</para>

                <note>
                    <para>The ability of Reading Systems to paginate absolutely positioned layouts
                        is not guaranteed, so reliance on absolute positioning is discouraged.
                        Reading Systems might not support these property values.</para>
                </note>
            </section>
            <section xml:id="sec-css-2.0-list-style-type">
                <title>CSS 2.0</title>
                <para>The EPUB 3 CSS Profile includes the following values for the
                        <property role="css">list-style-type</property> property as <link
                        xlink:href="http://www.w3.org/TR/2008/REC-CSS2-20080411/generate.html#lists"
                        >defined in</link>
                    <xref linkend="refCSS20"/>:</para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <code role="value">cjk-ideographic</code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code role="value">hebrew</code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code role="value">hiragana</code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code role="value">hiragana-iroha</code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code role="value">katakana</code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code role="value">katakana-iroha</code>
                        </para>
                    </listitem>
                </itemizedlist>
                <!--
                <para>Additional details on these list styles can be found in <xref
                        linkend="refCSS3Lists"/>. <remark role="todo">The definitions in CSS3 Lists
                        are incorrect, so remove this paragraph if an updated WD has not yet been
                        published.</remark>
                </para>
                -->
            </section>
            <section xml:id="sec-css-voice-characteristics">
                <title>CSS 3.0 Speech</title>
                <!-- TODO note the difference in inclusion <para>The EPUB 3 CSS Profile includes all features defined in the CSS 3.0 Speech
                    Module <xref linkend="refCSS3Speech"/>. Reading Systems with <xref
                        linkend="gloss-tts"/> capabilities <literal role="rfc2119">should</literal> support the following
                        properties:</para> -->
                <para>The EPUB 3 CSS Profile includes <property role="css">-epub-</property> prefixed versions of
                    the following properties from the CSS3 Speech Module <xref
                        linkend="refCSS3Speech"/> using syntax as defined in <xref
                        linkend="refCSS3Speech-dated"/> and semantics as defined in <xref
                        linkend="refCSS3Speech"/>:</para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <property role="css">-epub-cue</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-pause</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-rest</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-speak</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-speak-as</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-voice-family</property>
                        </para>
                    </listitem>
                </itemizedlist>
                <xi:include href="./share/note-tts-features.xml"/>
            </section>
            <section xml:id="sec-css-fonts">
                <title>CSS Fonts Level 3</title>
                <!-- jdaggett, editor of CSS3 Fonts, believes the below-referenced @font-face portion of
                 CSS3 Fonts to be stable. Other parts of the CSS3 Fonts spec are not yet stable.
                 2011-01-11 -->

                <para>The EPUB 3 CSS Profile includes <property role="css">@font-face</property> rules and
                    descriptors as defined in the CSS Fonts Module Level 3 <xref
                        linkend="refCSS3FontsModule"/> specification, using syntax as defined in
                        <xref linkend="refCSS3FontsModule-dated"/> and semantics as defined in <xref
                        linkend="refCSS3FontsModule"/>. </para>

                <para xml:id="confreq-rs-embedded-font-types">Reading Systems with a <xref
                        linkend="gloss-viewport-css"/> <literal role="rfc2119">must</literal> support OpenType <xref
                        linkend="refOpenType"/> and WOFF <xref linkend="refWOFF"/> fonts embedded
                    using the <property role="css">@font-face</property> rule.</para>

                <note>
                    <para>Refer to <olink type="epub-spec"
                            targetptr="confreq-resources-font-fallback" targetdoc="publications"/>
                        for font fallback processing requirements. </para>
                </note>

                <para>In addition, Reading Systems <literal role="rfc2119">must</literal> support at least the following
                        <property role="css">@font-face</property> font descriptors. <!-- using
                        <literal>-epub-</literal> prefixed property names,
                        syntax as defined in <xref
                        linkend="refCSS3FontsModule-dated"/> and semantics -->
                    <!-- as
                    defined in <xref linkend="refCSS3FontsModule-dated"/>.--></para>

                <itemizedlist>
                    <!-- Got rid of font-size, as instructred by John Daggett. -->
                    <!-- Got rid of font-variant, as instructed by John Daggett.  -->
                    <listitem>
                        <para>
                            <property role="css"><!--epub-->font-family</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css"><!--epub-->font-style</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css"><!--epub-->font-weight</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css"><!--epub-->src</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css"><!--epub-->unicode-range</property>
                        </para>
                    </listitem>
                </itemizedlist>

                <para>For forwards compatibility with EPUB 2 Reading Systems that do not support
                    <property role="css" linkend="sec-css-fonts">@font-face</property> rules,
                    authors <literal role="rfc2119">should</literal> reference a generic font using the
                        <property role="css">font-family</property> property.</para>

                <note>
                    <para>Refer to <olink type="epub-spec" targetdoc="ocf"
                            targetptr="resource-obfuscation"/> for Reading System font obfuscation
                        requirements. </para>
                </note>

            </section>
            <section xml:id="sec-css-text">
                <title>CSS Text Level 3</title>

                <para>The EPUB 3 CSS Profile includes <property role="css">-epub-</property> prefixed versions of
                    the following properties from the CSS Text Level 3 <xref linkend="refCSS3Text"/>
                    specification using syntax as defined in <xref linkend="refCSS3Text-dated"/> and
                    semantics as defined in <xref linkend="refCSS3Text"/>.</para>

                <itemizedlist>
                    <listitem>
                        <para>
                            <property role="css">-epub-hyphens</property>* </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-line-break</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property role="css">-epub-text-align-last</property>
                        </para>
                    </listitem>
                    <!-- <listitem>
                        <para>
                            <property role="css">-epub-text-transform</property>
                        </para>
                    </listitem> -->
                    <listitem>
                        <para>
                            <property role="css">-epub-word-break</property>
                        </para>
                    </listitem>
                </itemizedlist>

                <para>* The <property role="css">-epub-hyphens</property> property does not include support for
                    the value <code role="value">all</code>.</para>

                <para>In addition, the EPUB 3 CSS Profile includes the unprefixed
                        <property role="css">text-transform</property> property from CSS Text Level 3 using
                    semantics as defined in <xref linkend="refCSS3Text"/> and syntax as defined in
                        <xref linkend="refCSS3Text-dated"/>, with the exception that the
                    <code role="value">fullwidth</code> and <code role="value">fullsize-kana</code> values are
                    prefixed in the EPUB 3 CSS Profile (<code role="value">-epub-fullwidth</code> and
                        <code role="value">-epub-fullsize-kana</code>, respectively). </para>
            	
            	<para>Note that the CSS Text Level 3 module has dropped support for the 
            		<code role="value">fullsize-kana</code> value since the EPUB 3.0 revision. The EPUB
            		CSS 3 Profile retains this value, but now defines its semantics as below:</para>
            	
            	<variablelist>
            		<varlistentry>
            		    <term><code role="value">-epub-fullsize-kana</code></term>
            			<listitem>
            				<para>This property converts all small Kana characters to normal Kana.  Small 
            					Kana are those Unicode characters whose names contain 
            					"HIRAGANA LETTER SMALL" or "KATAKANA LETTER SMALL". 
            					This value is typically used for ruby annotation text, where 
            					all small Kana should be drawn as large Kana.</para>
            			</listitem>
            		</varlistentry>
            	</variablelist>
            	
            </section>
        	<section xml:id="sec-css-text-decoration">
        		<title>CSS Text Decoration Level 3</title>
        		
        		<para>The EPUB 3 CSS Profile includes <property role="css">-epub-</property> prefixed versions of
        			the following properties from the CSS Text Decoration Level 3 <xref linkend="refCSS3TextDecoration"/>
        			specification using syntax as defined in <xref linkend="refCSS3TextDecoration-dated"/> and
        			semantics as defined in <xref linkend="refCSS3TextDecoration"/>.</para>
        		
        		<itemizedlist>
        			<listitem>
        				<para>
        					<property role="css">-epub-text-emphasis</property>
        				</para>
        			</listitem>
        			<listitem>
        				<para>
        					<property role="css">-epub-text-emphasis-color</property>
        				</para>
        			</listitem>
        			<listitem>
        				<para>
        					<property role="css">-epub-text-emphasis-position</property>
        				</para>
        			</listitem>
        			<listitem>
        				<para>
        					<property role="css">-epub-text-emphasis-style</property>
        				</para>
        			</listitem>
        			<listitem>
        				<para>
        					<property role="css">-epub-text-underline-position</property>
        				</para>
        			</listitem>
        		</itemizedlist>
        	</section>
        	<section xml:id="sec-css-writing-modes">
                <title>CSS Writing Modes</title>
                <para>With exceptions for the <property role="css">direction</property> and
                        <property role="css">unicode-bidi</property> properties <link
                        linkend="css-writing-modes-excl">as noted below</link>, the EPUB 3 CSS
                    Profile includes all of the features defined in the CSS Writing Modes Module
                    Level 3 <xref linkend="refCSS3WritingModesModule"/> specification using
                        <property role="css">-epub-</property> prefixed property names, syntax as defined in
                        <xref linkend="refCSS3WritingModesModule-dated"/> and semantics as defined
                    in <xref linkend="refCSS3WritingModesModule"/>.</para>

                <para xml:id="css-writing-modes-excl">The <property role="css">direction</property> and
                        <property role="css">unicode-bidi</property> properties from <xref
                        linkend="refCSS3WritingModesModule"/> are not included in the EPUB 3 CSS
                    Profile. Authors <literal role="rfc2119">should</literal> use appropriate <xref linkend="refHTML5"/> markup to
                    express directionality information instead.</para>
            </section>
        	<section xml:id="sec-css-selectors">
        		<title>Selectors</title>
        		<para>The EPUB 3 CSS Profile includes support for the
        			Selectors Level 3 <xref linkend="refSelectors"/> specification.</para>
        	</section>
        	<section xml:id="sec-css-media-queries">
                <!-- CR as of July 2010 -->
                <title>Media Queries</title>
                <para>The EPUB 3 CSS Profile includes <property role="css">@media</property>
                    <!-- As instructed by Fantasai, @import is added. --> and
                        <property role="css">@import</property> rules with media queries as defined in the Media
                    Queries <xref linkend="refMediaQueries"/> specification.</para>
            </section>
            <section xml:id="sec-css-namespaces">
                <!-- CR as of May 2008 -->
                <title>CSS Namespaces</title>

                <para>The EPUB 3 CSS Profile includes the <property role="css">@namespace</property> rule defined in
                        <xref linkend="refCSSNamespacesModule"/> for declaring the default namespace
                    for a style sheet and for binding prefixes to namespaces.</para>
            </section>
            <section xml:id="sec-css-multi-column">
                <!-- CR as of April 2011 -->
                <title>CSS Multi-Column Layout</title>
                <para>The EPUB 3 CSS Profile includes all of the features defined in the CSS
                    Multi-column Layout Module <xref linkend="refCSS3Multicol"/> specification with
                    the exception of the <property role="css">column-span</property> property. </para>
                <caution>
                    <para>Authors should not rely on column behavior in overflow conditions as this
                        behavior is unstable and may change.</para>
                </caution>
                <caution>
                	<para>Pagination algorithms are not fully defined in CSS. Authors should
                        therefore expect exact pagination points to vary from Reading System to
                        Reading System.</para>
                </caution>
                <para>Reading Systems <literal role="rfc2119">must</literal> treat the <property role="css">oeb-column-number</property> property
                    as an alias for the <property role="css">column-count</property> property. The use of the
                        <property role="css">oeb-column-number</property> property in EPUB Style Sheets is
                    deprecated; this conformance requirement may be removed in the next major
                    version of EPUB.</para>
            </section>
            <section xml:id="sec-css-ruby-position">
                <title>Ruby Positioning</title>
                <!-- both syntax and semantics locally defined -->
                <para>The EPUB 3 CSS Profile includes the <property role="css">-epub-ruby-position</property>
                    property as defined below:</para>

                <informaltable>
                    <thead>
                        <tr>
                            <td>Name:</td>
                            <td>-epub-ruby-position</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Value:</td>
                            <td><code role="value">over</code> | <code role="value">under</code> |
                                <code role="value">inter-character</code>
                            </td>
                        </tr>
                        <tr>
                            <td>Initial:</td>
                            <td>over</td>
                        </tr>
                        <tr>
                            <td>Applies to:</td>
                            <td>ruby text elements</td>
                        </tr>
                        <tr>
                            <td>Inherited:</td>
                            <td>yes</td>
                        </tr>
                        <tr>
                            <td>Percentages:</td>
                            <td>N/A</td>
                        </tr>
                        <tr>
                            <td>Media:</td>
                            <td>visual</td>
                        </tr>
                        <tr>
                            <td>Computed value:</td>
                            <td>as specified</td>
                        </tr>
                    </tbody>
                </informaltable>

                <para>This property controls the placement of ruby text with respect to its base
                    text. Values have the following meanings:</para>

                <variablelist>
                    <varlistentry>
                        <term>
                            <code role="value">over</code>
                        </term>
                        <listitem>
                            <para>Ruby text is positioned on the <link
                                    xlink:href="http://www.w3.org/TR/css3-writing-modes/#over"
                                    >over</link> side of the ruby base.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>
                            <code role="value">under</code>
                        </term>
                        <listitem>
                            <para>Ruby text is positioned on the <link
                                    xlink:href="http://www.w3.org/TR/css3-writing-modes/#under"
                                    >under</link> side of the ruby base.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>
                            <code role="value">inter-character</code>
                        </term>
                        <listitem>
                            <para>Ruby text is positioned on the right side of the base text. (This
                                value is typically used for Zhuyin Fuhao (Bopomofo) ruby.)</para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <note>
                    <para>The <property role="css">-epub-ruby-position</property> property will become an alias
                        for the <property role="css">ruby-position</property> property in the CSS Ruby Module
                            <xref linkend="refCSS3Ruby"/>.</para>
                </note>
            </section>
            <section xml:id="sec-css-oeb-head-foot">
                <title>Display Property Values <property role="css">oeb-page-head</property> and
                        <property role="css">oeb-page-foot</property> [DEPRECATED]</title>
            	
                <para>The <property role="css">oeb-page-head</property> and <code role="css">oeb-page-foot</code> values
            		are deprecated and expected to be removed or replaced in a future version of EPUB.</para>
            	
            	<para>Authors <literal role="rfc2119">may</literal> continue to include these values in 
            		EPUB Style Sheets to define running headers and footers. Refer to their definition in
            		<link xlink:href="epub30-contentdocs.html#sec-css-oeb-head-foot" xlink:title="oeb-page-head and oeb-page-foot definitions in EPUB 3.0">EPUB Content Documents 3.0</link>
            		for more information.</para>
            	
            </section>
        </section>

    </chapter>

    <chapter xml:id="sec-pls">
        <title>PLS Documents</title>

        <section xml:id="sec-pls-overview" conformance="informative">
            <title>Overview</title>

            <para>The W3C Pronunciation Lexicon Specification <xref linkend="refPLS"/> defines
                syntax and semantics for XML-based pronunciation lexicons to be used by Automatic
                Speech Recognition and <xref linkend="gloss-tts"/> engines.</para>

            <para>The following sections define conformance criteria for PLS documents when included
                in <xref linkend="gloss-epub-publication"/>s, and rules for associating PLS
                Documents with <xref linkend="gloss-content-document-epub-xhtml"/>s. </para>

            <xi:include href="./share/note-tts-features.xml"/>

        </section>

        <section xml:id="sec-pls-conf-pub">
            <title>EPUB Publication Conformance</title>

            <para>A conformant <xref linkend="gloss-epub-publication"/> <literal role="rfc2119">must</literal> meet all of the
                following criteria for inclusion of PLS Documents:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-cd-pls-xht">PLS Documents <literal role="rfc2119">may</literal> be associated with <xref
                            linkend="gloss-content-document-epub-xhtml"/>s. Each XHTML Content
                        Document <literal role="rfc2119">may</literal> contain zero or more PLS Document associations. </para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-cd-pls-assoc">PLS Documents <literal role="rfc2119">must</literal> be associated with the
                            <xref linkend="gloss-content-document-epub-xhtml"/> to which it applies
                        using the <xref linkend="refHTML5"/>
                        <code role="markup" xlink:href="http://www.w3.org/TR/html5/Overview.html#the-link-element"
                            >link</code> element with its <code role="markup">rel</code> attribute set to
                            <property role="html">pronunciation</property> and its <code role="markup">type</code> attribute set
                        to the <olink type="epub-spec" epub:specref-exclude="true"
                            targetdoc="publications" targetptr="cmt-pls">PLS media type</olink>
                            (<code role="media-type">application/pls+xml</code>).</para>
                    <para xml:id="confreq-cd-pls-assoc-lang">The <code role="markup">link</code> element
                            <code role="markup">hreflang</code> attribute <literal role="rfc2119">should</literal> be specified on each PLS
                            <code role="markup">link</code>, and its value <literal role="rfc2119">must</literal> match <link
                            xlink:href="http://www.w3.org/TR/pronunciation-lexicon/#S4.1">the
                            language for which the pronunciation lexicon is relevant</link>
                        <xref linkend="refPLS"/> when specified.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-pls-pub-cont">PLS Documents <literal role="rfc2119">must</literal> meet the content
                        conformance criteria defined in <xref linkend="sec-pls-conf-content"
                        />.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-pls-pub-manif">PLS Documents <literal role="rfc2119">must</literal> be represented and
                        located as defined in <olink type="epub-spec" targetdoc="publications"
                            targetptr="sec-epub-content-conf"/>.</para>
                </listitem>
            </itemizedlist>

            <bridgehead>Examples</bridgehead>
            <informalexample>
                <para>The following example shows two PLS Documents (one for Chinese and one for
                    Mongolian) associated with an XHTML Content Document.</para>
                <synopsis>
<xi:include href="./examples/contentdocs/pls-assoc-1.xml" parse="text"/></synopsis>
            </informalexample>

        </section>

        <section xml:id="sec-pls-conf-content" xreflabel="PLS Documents — Content Conformance">
            <title>Content Conformance</title>

            <para>To be considered a <xref linkend="gloss-publication-resource-cmt"/>, a PLS
                Document <literal role="rfc2119">must</literal> meet all of the following criteria:</para>

            <variablelist role="conformance-list" xml:id="confreq-cd-pls">
                <varlistentry xml:id="confreq-cd-pls-docprops">
                    <term>Document Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-pls-xml">
                            <xi:include href="./share/xml-defref.xml"/>
                        </para>
                        <para xml:id="confreq-cd-pls-docprops-schema">It <literal role="rfc2119">must</literal> be valid to the RELAX
                            NG schema for PLS documents available at the URI <uri
                                xlink:href="http://www.w3.org/TR/pronunciation-lexicon/pls.rng"
                                >http://www.w3.org/TR/pronunciation-lexicon/pls.rng</uri>
                            <xref linkend="refPLS"/>. </para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="confreq-cd-pls-fileprops">
                    <term>File Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-pls-fileprops-name">The PLS Document filename
                            <literal role="rfc2119">should</literal> use the file extension <filename>.pls</filename>.</para>
                    </listitem>
                </varlistentry>
            </variablelist>

        </section>

        <section xml:id="sec-pls-conf-rs" xreflabel="PLS Documents — Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <xref linkend="gloss-epub-reading-system"/> <literal role="rfc2119">must</literal> meet all of the
                following criteria for processing PLS Documents:</para>

            <itemizedlist role="conformance-list" xml:id="pls-rs-confreqs">
                <listitem>
                    <para xml:id="confreq-pls-rs-sptts">Reading Systems with <xref
                            linkend="gloss-tts"/> capabilities <literal role="rfc2119">should</literal> support PLS.</para>
                    <para xml:id="confreq-pls-rs-proc">Reading Systems that support PLS <literal role="rfc2119">must</literal> process
                        PLS documents as defined in <xref linkend="refPLS"/>.</para>
                    <para xml:id="confreq-pls-rs-scope">Reading Systems that support PLS <literal role="rfc2119">must</literal> apply
                        the supplied pronunciation instructions to all text nodes in the current
                        XHTML Content Document whose <link
                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-lang-and-xml:lang-attributes"
                            >language</link>
                        <xref linkend="refHTML5"/> matches <link
                            xlink:href="http://www.w3.org/TR/pronunciation-lexicon/#S4.1">the
                            language for which the pronunciation lexicon is relevant</link>
                        <xref linkend="refPLS"/>. The algorithm for matching language tags is
                        defined in <link linkend="refRFC5646">BCP47</link>.</para>
                    <para xml:id="confreq-pls-rs-multi"> When a pronunciation rule is specified more
                        than once for a given string target in a given language, the last occurrence
                        of the rule takes precedence, in such a way that any previously-defined
                        pronunciation rule gets overridden. </para>
                    <para xml:id="confreq-pls-rs-casc">Reading Systems that support PLS and the
                            <link linkend="sec-xhtml-ssml-attrib">SSML Attributes</link> <literal role="rfc2119">must</literal> let
                        any pronunciation instructions provided via the <code role="markup" linkend="sec-cd-ssml-ph-attrib">ssml:ph</code> attribute
                        take precedence in cases where a <code role="markup">pls:grapheme</code> matches a text
                        node of an element that carries the <code role="markup">ssml:ph</code> attribute.</para>
                </listitem>
            </itemizedlist>
        </section>

    </chapter>

    <appendix xml:id="app-epubReadingSystem">
        <title>JavaScript epubReadingSystem Object</title>

        <section xml:id="app-ers-syntax">
            <title>Syntax</title>

            <para role="syntax"><emphasis>ReadingSystem</emphasis> =
                navigator.epubReadingSystem;</para>

        </section>

        <section xml:id="app-ers-desc">
            <title>Description</title>

            <para>The <code role="markup">epubReadingSystem</code> object provides an interface through which a
                    <xref linkend="gloss-content-document-epub-scripted"/> can query information
                about a <xref linkend="gloss-user"/>'s <link linkend="gloss-epub-reading-system"
                    >Reading System</link>.</para>

            <para>The object exposes a number of <link linkend="app-ers-properties"
                    >properties</link>, about the Reading System, such as its name and version, and
                provides the <link linkend="app-ers-hasFeature">hasFeature</link> method which can
                be invoked to determine the features it supports.</para>

            <informalexample>
                <para>Example JavaScript function that displays the name of the current Reading
                    System.</para>
                <synopsis>alert("Reading System name: " + navigator.epubReadingSystem.name);</synopsis>
            </informalexample>
        </section>

        <section xml:id="app-ers-properties">
            <title>Properties</title>

            <para>The following properties <literal role="rfc2119">must</literal> be made available for retrieving information about
                the Reading System.</para>

            <table xml:id="tbl-epubReadingSystem-properties">
                <caption>Required epubReadingSystem properties</caption>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><property role="js">name</property></td>
                        <td>Returns a <code role="datatype">String</code> value representing the name of the
                            Reading System (e.g., "<code role="value">iBooks</code>",
                                "<code role="value">Kindle</code>").</td>
                    </tr>
                    <tr>
                        <td><property role="js">version</property></td>
                        <td>Returns a <code role="datatype">String</code> value representing the version of
                            the Reading System (e.g., "<code role="value">1.0</code>",
                                "<code role="value">2.1.1</code>").</td>
                    </tr>
                    <tr>
                        <td><property role="js">layoutStyle</property></td>
                        <td><para>Returns a <code role="datatype">String</code> value representing the style
                                of layout for the content.</para>
                            <para>A Reading System will typically return one of the values
                                    "<code role="value">paginated</code>" or "<code role="value">scrolling</code>",
                                but <literal role="rfc2119">may</literal> define values for any additional layout formats it
                                supports.</para></td>
                    </tr>
                </tbody>
            </table>
        </section>


        <section xml:id="app-ers-methods">
            <title>Methods</title>

            <section xml:id="app-ers-hasFeature">
                <title>hasFeature</title>

                <section xml:id="app-ers-hasFeature-syntax">
                    <title>Syntax</title>

                    <para role="syntax">hasFeature(feature[, version])</para>
                </section>

                <section xml:id="app-ers-hasFeature-desc">
                    <title>Description</title>
                    <para>For recognized features, the <code role="markup">hasFeature</code> method returns a
                        boolean value indicating whether any version is supported.</para>
                    <para>If the optional <code role="markup">version</code> parameter is included, the return
                        value indicates support only for the specified version.</para>
                    <para>The method returns <code role="value">undefined</code> if the feature is not
                        recognized by the Reading System.</para>

                    <informalexample>
                        <para>Example JavaScript function that displays whether the current Reading
                            System supports scripted manipulation of the DOM.</para>
                        <synopsis>var feature = "dom-manipulation";

var conformTest = navigator.epubReadingSystem.hasFeature(feature);

alert("Feature " + feature + " supported?: " + conformTest);</synopsis>
                    </informalexample>
                </section>

                <section xml:id="app-ers-hasFeature-features">
                    <title>Features</title>

                    <para>The following table details the features that <literal role="rfc2119">must</literal> be recognized by all
                        Reading Systems that support scripting (<link linkend="sec-scripted-context"
                            >spine-level</link> or <link linkend="sec-scripted-context"
                            >container-constrained</link>). Reading Systems <literal role="rfc2119">may</literal> support some or all
                        of these features (refer to <xref linkend="sec-scripted-content-rs-reqs"/>
                        for more information).</para>

                    <para>Feature names are case-insensitive.</para>

                    <table xml:id="tbl-epubReadingSystem-features">
                        <caption>Required epubReadingSystem features</caption>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td xml:id="feature-dom-manipulation"
                                        ><code role="value">dom-manipulation</code></td>
                                <td>Scripts <literal role="rfc2119">may</literal> make structural changes to the document’s DOM
                                    (applies to spine-level scripting only).</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-layout-changes"
                                    ><code role="value">layout-changes</code></td>
                                <td>Scripts <literal role="rfc2119">may</literal> modify attributes and CSS styles that affect content
                                    layout (applies to spine-level scripting only).</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-touch-events"
                                    ><code role="value">touch-events</code></td>
                                <td>The device supports touch events and the Reading System passes
                                    touch events to the content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-mouse-events"
                                    ><code role="value">mouse-events</code></td>
                                <td>The device supports mouse events and the Reading System passes
                                    mouse events to the content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-keyboard-events"
                                    ><code role="value">keyboard-events</code></td>
                                <td>The device supports keyboard events and the Reading System
                                    passes keyboard events to the content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-spine-scripting"
                                    ><code role="value">spine-scripting</code></td>
                                <td>Spine-level scripting is supported.</td>
                            </tr>
                        </tbody>
                    </table>

                	<para>If a Reading System supports a feature defined in this section, it <literal role="rfc2119">must</literal>
                	    return a <code role="value">true</code> value both when queried without the version
                        parameter set and when that parameter is set to the value
                        "<code role="value">1.0</code>". Otherwise, it <literal role="rfc2119">must</literal> return <code role="value">false</code>. Reading System
                        developers <literal role="rfc2119">should not</literal> change the version number of these features
                        independently of this specification.</para>

                    <para>Additional features <literal role="rfc2119">may</literal> be added by Reading System developers, but future
                    	versions of this specification <literal role="rfc2119">may</literal> append to this list in ways that <literal role="rfc2119">may</literal>
                        conflict or be incompatible with any such custom additions.</para>
                </section>
            </section>
        </section>
    </appendix>

    <xi:include href="./share/contributors.xml"/>

    <xi:include href="./share/references.xml"/>

    <appendix xml:id="DUMMY_REMOVE">
        <!-- a dummy that is removed by the build -->
        <title>THIS SECTION SHOULD NOT BE IN THE BUILD</title>
        <para xml:id="physical-container-zip"/>
        <para xml:id="sec-package-documents"/>
        <para xml:id="sec-core-media-types"/>
        <para xml:id="sec-spine-elem"/>
        <para xml:id="sec-manifest-elem"/>
        <para xml:id="sec-fallback-processing-flow"/>
        <para xml:id="sec-xml-constraints"/>
        <para xml:id="sec-link-elem"/>
        <para xml:id="sec-opf-metadata-identifiers-pid"/>
        <para xml:id="sec-resource-locations"/>
        <para xml:id="confreq-spine-itemtypes"/>
        <para xml:id="sec-publication-resources"/>
    </appendix>

</book>
