<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="../../util/docbook/schema/docbookspec.rng" type="xml"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbookspec.sch"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbook.sch"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:epub="http://www.idpf.org/2011/epub" xmlns:xi="http://www.w3.org/2001/XInclude"
    version="5.1">
    <title>EPUB Content Documents 3.0</title>

    <info>
        <releaseinfo>Working Group Draft</releaseinfo>
        <pubdate>6 May 2011</pubdate>

        <printhistory>
            <formalpara>
                <title>This version</title>
                <para>
                    <link
                        xlink:href="http://www.idpf.org/epub/30/spec/epub30-contentdocs-20110506.html"
                    />
                </para>
            </formalpara>
            <formalpara>
                <title>Latest version</title>
                <para>
                    <link xlink:href="http://www.idpf.org/epub/30/spec/epub30-contentdocs.html"/>
                </para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para>
                    <link
                        xlink:href="http://www.idpf.org/epub/30/spec/epub30-contentdocs-20110215.html"
                    />
                </para>
            </formalpara>
        </printhistory>
        <releaseinfo role="diff"> A diff of changes from the previous Working Draft is available at
                <link
                xlink:href="http://code.google.com/p/epub-revision/source/diff?spec=svn2925&amp;old=2553&amp;r=2925&amp;format=side&amp;path=%2Ftrunk%2Fsrc%2Fspec%2Fepub30-contentdocs.xml"
                >this link</link>. </releaseinfo>
        <xi:include href="./share/copyright.xml"/>
        <xi:include href="./share/legalnotice.xml"/>
        <authorgroup role="current">
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>DAISY Consortium</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>William McCoy</personname>
                <affiliation>
                    <org>
                        <orgname>International Digital Publishing Forum (IDPF)</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Elika J. Etemad</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Matt Garrish</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
        </authorgroup>

        <!-- <abstract>
            <title>Open Publication Structure 3.0</title>
            <para>EPUB Content Documents 3.0 specifies a usage of XHTML, SVG and CSS optimized for
                representation of structured, composable, and accessible documents. EPUB Content
                Documents 3.0 is one of a family of related specifications that comprise EPUB 3. The
                EPUB 3 Overview describes the overall state of EPUB 3 and should be read before other
                EPUB 3 documents. </para>
        </abstract> -->

    </info>

    <chapter xml:id="sec-overview">
        <title>Overview</title>

        <section xml:id="sec-overview-purpose-and-scope" conformance="informative">
            <title>Purpose and Scope</title>

            <para>This specification, EPUB Content Documents 3.0, defines profiles of HTML5, SVG,
                and CSS for use in the context of <link linkend="gloss-epub-publication">EPUB®
                    Publications</link>.</para>

            <xi:include href="./share/specdesc-prepara.xml"/>
            <itemizedlist xml:id="epub-specs-listing">
                <xi:include href="./share/specdesc-overview.xml"/>
                <xi:include href="./share/specdesc-publications.xml"/>
                <xi:include href="./share/specdesc-ocf.xml"/>
                <xi:include href="./share/specdesc-overlays.xml"/>
            </itemizedlist>

            <para>This specification supersedes Open Publication Structure (OPS) 2.0.1 <xref
                    linkend="refOPS2"/>. Refer to <xref linkend="refEPUB3Changes"/> for information
                on differences between this specification and its predecessor.</para>

        </section>

        <section xml:id="sec-overview-relations" conformance="informative">

            <title>Relationship to Other Specifications</title>

            <section xml:id="sec-overview-relations-html">
                <title>Relationship to HTML5</title>

                <para>The <link linkend="sec-xhtml">XHTML document type defined by this
                        specification</link> is based on W3C <xref linkend="refHTML5"/>, and
                    inherits all definitions of semantics, structure and
                    processing behaviors from the HTML5 specification unless otherwise specified.</para>
                <!-- Paragraph about use of XML serialization of HTML5 here -->

                <para>In addition, this specification <link linkend="sec-xhtml-additions">defines a
                        set of extensions</link> to the W3C HTML5 document model that Authors may
                    include in XHTML Content Documents.</para>

                <para>This specification defines a simplified processing model that does not require
                    Reading Systems to support scripting, HTML5 forms or the HTML5 DOM. <xref
                        linkend="gloss-epub-reading-system"/>s conformant with this specification
                    are only required to be able to process a conforming <xref
                        linkend="gloss-content-document-epub"/>. As <link
                        linkend="sec-scripted-content-rs-reqs">support for scripting and HTML5
                        forms</link> are optional Reading System features, a conformant Reading
                    System may not be a fully-conformant HTML5 User Agent (i.e., it may not
                    implement the complete HTML5 processing model).</para>

            </section>

            <section xml:id="sec-overview-relations-svg">
                <title>Relationship to SVG</title>

                <para>This specification defines <link linkend="sec-svg">a restricted subset of SVG
                        1.1</link> to represent vector graphics inline in <xref
                        linkend="gloss-content-document-epub-xhtml"/>s and as standalone <xref
                        linkend="gloss-content-document-epub-svg"/>s. </para>
            </section>

            <section xml:id="sec-overview-relations-css">
                <title>Relationship to CSS</title>
                <para>The <link linkend="sec-css">CSS profile</link> defined in this specification
                    has CSS 2.1 <xref linkend="refCSS21"/> as its baseline. Any CSS Style Sheet that
                    conforms to CSS 2.1 may be used in the context of an EPUB Publication, except as
                    noted in <xref linkend="sec-css-2.1"/>.</para>
                <para>This specification also incorporates features defined by CSS3 Modules and
                    introduces EPUB-specific CSS constructs.</para>
            </section>

            <section xml:id="sec-overview-versioning">
                <title>EPUB 3 Versioning Strategy</title>
                <!-- TODO this may go to Publications, and should be reffed from overview -->
                <para xml:id="sec-overview-versionining"> EPUB 3 references W3C specifications that
                    are not yet final, and incompatible changes to them may occur in the future that
                    would cause EPUB 3 Content Documents that were previously conformant to no
                    longer be conformant to the latest versions of the referenced
                    specifications.</para>
                <para>The IDPF anticipates revising the EPUB 3 specifications if and when such
                    incompatible changes occur, updating the normative constraints defined herein as
                    necessary and incrementing the minor version number of EPUB 3 (e.g., publishing
                    an EPUB 3.0.<literal>n</literal>). </para>
            </section>

        </section>

        <section xml:id="sec-terminology">
            <title>Terminology</title>
            <xi:include href="./share/terminology.xml"/>
        </section>

        <xi:include href="./share/conformancestatements.xml"/>

        <section xml:id="sec-overview-nspfx">
            <title>Namespace prefix mappings</title>
            <para>For convenience, the following namespace prefix mappings <xref
                    linkend="refXMLNamespaces"/> are used throughout this specification:</para>
            <informaltable xml:id="tbl-nspfx">
                <tr>
                    <th class="left">prefix</th>
                    <th class="odd">namespace URI</th>
                </tr>
                <tr>
                    <td class="left">
                        <literal>epub</literal>
                    </td>
                    <td class="odd">
                        <literal>http://www.idpf.org/2007/ops</literal>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <literal>m</literal>
                    </td>
                    <td class="odd">
                        <literal>http://www.w3.org/1998/Math/MathML</literal>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <literal>pls</literal>
                    </td>
                    <td class="odd">
                        <literal>http://www.w3.org/2005/01/pronunciation-lexicon</literal>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <literal>ssml</literal>
                    </td>
                    <td class="odd">
                        <literal>http://www.w3.org/2001/10/synthesis</literal>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <literal>svg</literal>
                    </td>
                    <td class="odd">
                        <literal>http://www.w3.org/2000/svg</literal>
                    </td>
                </tr>
            </informaltable>
        </section>

    </chapter>

    <chapter xml:id="sec-contentdocs">

        <title>EPUB Content Documents</title>

        <section xml:id="sec-xhtml">
            <title>XHTML Content Documents</title>

            <para>This section defines a profile of <xref linkend="refHTML5"/> for creating XHTML
                Content Documents. An instance of an XML document that conforms to this profile is a
                    <xref linkend="gloss-core-media-type"/> and is referred to in this specification
                and its <link linkend="sibling-specs">sibling specifications</link> as an <xref
                    linkend="gloss-content-document-epub-xhtml"/>.</para>

            <para>Unless otherwise specified, this specification inherits all definitions of
                semantics, structure and processing behaviors
                <!--  of the elements and attributes in the W3C HTML5 vocabulary --> from the <xref
                    linkend="refHTML5"/> specification. </para>

            <caution xml:id="caution-html5">
                <para>The EPUB 3 XHTML Content Document definition references features in the W3C
                        <xref linkend="refHTML5"/> specification that are still works in progress
                    and may change in incompatible ways. When utilizing such features, authors
                    should consider the inherent risks in terms of the potential impact on
                    interoperability and document longevity.</para>
            </caution>

            <section xml:id="sec-xhtml-conf-content"
                xreflabel="XHTML Content Documents — Content Conformance">
                <title>Content Conformance</title>
                <para>An <xref linkend="gloss-content-document-epub-xhtml"/> must meet all of the
                    following criteria:</para>
                <variablelist role="conformance-list" xml:id="confreq-cd-xhtml">
                    <varlistentry xml:id="confreq-cd-xhtml-docprops">
                        <term>Document Properties</term>
                        <listitem>
                            <para xml:id="confreq-cd-xhtml-xml">
                                <xi:include href="./share/xml-defref.xml"/>
                            </para>
                            <!--
                            <para xml:id="confreq-cd-xhtml-docprops-xml">
                                <xi:include href="./share/xml-wellformed.xml"/>
                            </para>

                            <para xml:id="confreq-cd-xhtml-docprops-extmarkupdecl">
                                <xi:include href="./share/xml-extmarkupdecl.xml"/>
                            </para>

                            <para xml:id="confreq-cd-xhtml-docprops-xinc">
                                <xi:include href="./share/xml-xinc.xml"/>
                            </para>

                            <para xml:id="confreq-cd-xhtml-enc">
                                <xi:include href="./share/xml-enc.xml"/>
                            </para>
                            -->

                            <para xml:id="confreq-cd-xhtml-docprops-syntax">It must use the <link
                                    xlink:href="http://www.w3.org/TR/html5/Overview.html#the-xhtml-syntax"
                                    >XHTML syntax</link>
                                <xref linkend="refHTML5"/>.</para>

                            <para xml:id="confreq-cd-xhtml-docprops-schema">It must be valid to the
                                XHTML Content Document schema as defined in <xref
                                    linkend="app-xhtml-schema"/>. </para>

                            <para xml:id="confreq-cd-xhtml-docprops-html5">For all document
                                constructs used that are defined by <xref linkend="refHTML5"/>, it
                                must conform to the conformance criteria defined for those
                                constructs in that specification, unless explicitly overridden in
                                    <xref linkend="sec-xhtml-deviations"/>.</para>

                            <para xml:id="confreq-cd-xhtml-docprops-def">It must conform to all
                                content conformance constraints defined in <xref
                                    linkend="sec-xhtml-additions"
                                />.<!-- and <xref
                                    linkend="sec-xhtml-deviations"/>-->
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="confreq-cd-xhtml-fileprops">
                        <term>File Properties</term>
                        <listitem>
                            <para xml:id="confreq-cd-xhtml-fileprops-name">The XHTML Content
                                Document filename should use the file extension
                                    <filename>.xhtml</filename>.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <note xml:id="note-cd-xhtml-refprops-pkg">
                    <!-- note similar statement for xhtml, svg and css-->
                    <para>All <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s
                        referenced from an XHTML Content Document must conform to the constraints
                        for Publication Resources defined in <olink type="epub-spec"
                            targetdoc="publications" targetptr="sec-epub-content-conf"/></para>
                </note>
            </section>

            <section xml:id="sec-xhtml-conf-rs"
                xreflabel="XHTML Content Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para>A conformant <xref linkend="gloss-epub-reading-system"/> must meet all of the
                    following criteria for processing <xref
                        linkend="gloss-content-document-epub-xhtml"/>s:</para>

                <itemizedlist role="conformance-list" xml:id="xhtml-rs-confreqs">
                    <listitem>
                        <!-- todo below: overridden really refers to the deviations and extensions sections-->
                        <para xml:id="confreq-xhtml-rs-behavior">Unless explicitly defined by this
                            specification or its <link linkend="sibling-specs">sibling
                                specifications</link> as overridden, it must process XHTML Content
                            Documents using semantics defined by the <xref linkend="refHTML5"/> 
                            specification, and honor any applicable User Agent conformance
                            constraints expressed therein.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-behavior-add">It must meet all Reading System
                            conformance criteria defined in <xref linkend="sec-xhtml-additions"
                            />.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-behavior-restr">It must recognize and adapt
                            behaviorally to the constraints defined in <xref
                                linkend="sec-xhtml-deviations"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-scrpt">It must meet the Reading System
                            conformance criteria defined in <xref
                                linkend="sec-scripted-content-rs-reqs"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-css">It must support visual rendering of
                            XHTML Content Documents as defined in <xref linkend="sec-css-rs-conf"
                            />.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-xhtml-rs-a11y">It should recognize embedded ARIA
                            markup and support exposure of any given ARIA roles, states and
                            properties to platform accessibility APIs <xref linkend="refARIA"/>.
                        </para>
                    </listitem>
                </itemizedlist>
            </section>

            <section xml:id="sec-xhtml-additions">
                <title>HTML5 Extensions and Enhancements</title>

                <para>This section defines EPUB 3 <xref linkend="gloss-content-document-epub-xhtml"
                    /> extensions to the underlying <xref linkend="refHTML5"/> document
                    model.</para>

                <section xml:id="sec-xhtml-semantic-inflection">

                    <title>Semantic Inflection</title>

                    <section xml:id="sec-xhtml-semantic-inflection-intro" conformance="informative">
                        <title>Introduction</title>

                        <para>Semantic inflection is the process of attaching additional meaning
                            about the specific purpose and/or nature that an element plays in an
                                <xref linkend="gloss-content-document-epub-xhtml"/>. In the context
                            of EPUB Publications, such inflection typically pertains to
                            domain-specific semantics that are not covered by the underlying host
                            language (<xref linkend="refHTML5"/>) vocabulary.</para>

                        <para>Semantic metadata is not intended for human consumption; it instead
                            provides a controlled way for Reading Systems and other User Agents to
                            learn more about the structure and content of a document, providing them
                            the opportunity to enhance the reading experience for Users. </para>

                        <para>This specification defines a method for semantic inflection using
                                <emphasis>the attribute axis</emphasis>: instead of adding new XML
                            elements to the XHTML Content Document vocabulary as needed, a fixed set
                            of attributes are used to inflect the desired semantics. A mechanism to
                            identify external vocabularies that provide controlled values for the
                            attributes is also defined.</para>

                    </section>

                    <section xml:id="sec-xhtml-content-type-attribute">
                        <title>The <code>epub:type</code> Attribute</title>

                        <para>The <code>epub:type</code> attribute inflects semantics on the element
                            on which it appears. Its value is one or more space-separated terms
                            stemming from external vocabularies associated with the document
                            instance, as defined in <xref
                                linkend="sec-contentdocs-vocab-association"/>. </para>

                        <para>The inflected semantic must express a subclass of the semantic of the
                            carrying element. Note that Reading Systems are required to <link
                                linkend="confreq-rs-epubtype-prec">ignore inflected semantics</link>
                            that conflict with the carrying element.</para>

                        <note>
                            <para>The <code>epub:type</code> attribute is intended to be
                                functionally equivalent to the W3C Role Attribute <xref
                                    linkend="refPFRoleAttribute"/>, but with restrictions as
                                specified in <xref linkend="sec-contentdocs-vocab-association"/>.
                            </para>
                        </note>

                        <variablelist xreflabel="epub:type" role="elem-synopsis"
                            xml:id="attrdef-epub-type">
                            <varlistentry>
                                <term>Attribute Name</term>
                                <listitem>
                                    <para>
                                        <literal>type</literal>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Namespace</term>
                                <listitem>
                                    <para>
                                        <literal>http://www.idpf.org/2007/ops</literal>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Usage</term>
                                <listitem>
                                    <para>May be specified on all elements.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Value</term>
                                <listitem>
                                    <para>A space-separated list of CURIEs <xref
                                            linkend="refRDFa11Core"/>, with restrictions as defined
                                        in <xref linkend="sec-contentdocs-vocab-association"
                                        />.</para>
                                </listitem>
                            </varlistentry>
                        </variablelist>

                    </section>

                    <section xml:id="sec-contentdocs-vocab-association">
                        <title>Vocabulary Association</title>

                        <para>This specification uses a subset of the vocabulary association
                            mechanism defined in RDFa 1.1 Core <xref linkend="refRDFa11Core"/>. The
                                <code>profile</code> and <code>prefix</code> attributes of RDFa 1.1
                            Core are allowed on the root element of XHTML Content Documents, and are
                            used as follows: </para>

                        <variablelist role="elem-synopsis-attlist">
                            <varlistentry xml:id="attrdef-xhtml-profile" xreflabel="profile">
                                <term>The <code>profile</code> attribute <option>[conditionally
                                        required]</option></term>
                                <listitem>
                                    <para>Specifies the URI <xref linkend="refRFC3986"/> of the
                                        vocabulary profile for EPUB Content Documents.</para>
                                    <para>This attribute is optional except when the <link
                                            linkend="attrdef-epub-type"
                                            ><code>epub:type</code></link> attribute is used in an
                                        XHTML Content Document, in which case its use is
                                        required.</para>
                                    <para>This version of the specification requires the attribute
                                        have the value
                                            <literal>http://www.idpf.org/epub/30/profile/content/</literal>
                                        <xref linkend="refEPUBContentProfile"/>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="attrdef-xhtml-prefix" xreflabel="prefix">
                                <term>The <code>prefix</code> attribute
                                    <option>[optional]</option></term>
                                <listitem>
                                    <para>Declares additional vocabulary prefix mappings beyond those
                                        declared in the profile, using the syntax defined
                                        in <xref linkend="refRDFa11Core"/>.</para>
                                </listitem>
                            </varlistentry>
                        </variablelist>

                        <xi:include href="./share/rdfa-prefix-reqs.xml"/>

                        <para>Besides reserving prefixes for a set of well-known vocabularies, the
                            vocabulary profile for EPUB Content Documents also reserves the EPUB 3
                            Structural Semantics Vocabulary <xref linkend="refEPUBStructureVocab"/>
                            as the <emphasis>default vocabulary</emphasis> for all XHTML Content
                            Documents. The terms defined in this vocabulary are used without
                            prefixes in the <code>epub:type</code> attribute of XHTML Content
                            Documents.</para>

                        <bridgehead>Examples</bridgehead>
                        <informalexample xml:id="ex.epubtype.note">
                            <para>The following example shows the <code>epub:type</code> attribute
                                used to inflect footnote and note reference semantics. The
                                properties used are defined in the <link
                                    linkend="refEPUBStructureVocab">default vocabulary</link>. </para>
                            <synopsis>
<xi:include href="./examples/contentdocs/epub-type-1.xml" parse="text"/></synopsis>
                        </informalexample>
                        <informalexample xml:id="ex.epubtype.gloss">
                            <para>The following example shows the <code>epub:type</code> attribute
                                used to inflect glossary semantics on an HTML5 definition list. The
                                property used is defined in the <link
                                    linkend="refEPUBStructureVocab">default vocabulary</link>. </para>
                            <synopsis>
<xi:include href="./examples/contentdocs/epub-type-2.xml" parse="text"/></synopsis>
                        </informalexample>
                        <informalexample xml:id="ex.epubtype.pg">
                            <para>The following example shows the <code>epub:type</code> attribute
                                used to inflect source publication pagebreak semantics. The property
                                used is defined in the <link linkend="refEPUBStructureVocab">default
                                    vocabulary</link>. (Note that the <olink type="epub-spec"
                                    targetptr="source-identifier" targetdoc="publications"/>
                                property provides a means of identifying the source publication to
                                which the given pagination information applies.)</para>
                            <synopsis>
<xi:include href="./examples/contentdocs/epub-type-3.xml" parse="text"/></synopsis>
                        </informalexample>

                    </section>

                    <section xml:id="sec-contentdocs-semantic-inflection-processing-reqs">
                        <title>Processing Requirements</title>

                        <para>Reading Systems must process the <code>epub:type</code> as
                            follows:</para>

                        <itemizedlist role="conformance-list">
                            <listitem>
                                <para xml:id="confreq-rs-epubtype-beh">A Reading System may
                                    associate specialized behaviors with none, some or all of the
                                    terms defined in the <link
                                        linkend="sec-contentdocs-vocab-association">default
                                        vocabulary</link>.</para>
                            </listitem>
                            <listitem xml:id="confreq-rs-epubtype-oth">
                                <para>A Reading System may also associate specialized behaviors with
                                    terms given in vocabularies other than the default one.</para>
                            </listitem>
                            <listitem xml:id="confreq-rs-epubtype-ign">
                                <para>A Reading System must ignore terms that it does not
                                    recognize.</para>
                            </listitem>
                            <!--
                            <listitem>
                                <para>A Reading System may support the dereferencing of unrecognized
                                    CURIEs occurring in the <code>epub:type</code> and
                                        <code>rel</code> attributes. If a Reading System
                                    successfully dereferences an unrecognized CURIE, it may
                                    (depending on the information available in the referenced
                                    vocabulary property) employ adaptive behaviors in response to
                                    the change to the document structural semantics that results
                                    from the CURIE dereferencing.</para>
                            </listitem>                            
                            <listitem>
                                <para>If the attempt to dereference an unrecognized CURIE fails, or
                                    if the dereferencing of unrecognized CURIEs is not supported,
                                    then the Reading System must ignore the given unrecognized CURIE
                                    and continue processing the <code>epub:type</code> or
                                        <code>rel</code> attribute.</para>
                            </listitem>
                            -->
                            <listitem xml:id="confreq-rs-epubtype-prec">
                                <para>When Reading System behavior associated with a given
                                        <code>epub:type</code> value conflicts with behavior
                                    associated with the carrying element, then the behavior
                                    associated with the element must be given precedence.</para>
                            </listitem>
                        </itemizedlist>
                    </section>

                </section>

                <section xml:id="sec-xhtml-ssml-attrib">
                    <title>SSML Attributes</title>

                    <section xml:id="sec-cd-ssml-intro">
                        <title>Overview</title>

                        <para>The W3C Speech Synthesis Markup Language <xref linkend="refSSML"/> is
                            a language used for assisting <xref linkend="gloss-tts"/> engines in
                            generating synthetic speech. While SSML is a language designed as a
                            standalone document type, it also defines semantics suitable for use
                            within other host languages.</para>

                        <para>This specification recasts the <link
                                xlink:href="http://www.w3.org/TR/speech-synthesis11/#S3.1.10">SSML
                                1.1 <code>phoneme</code> element</link> as two attributes
                                (<code>ssml:ph</code> and <code>ssml:alphabet</code>), and makes
                            them available within EPUB XHTML Content Documents.</para>

                        <para>Reading Systems with <xref linkend="gloss-tts"/> capabilities should
                            support the SSML Attributes as defined below.</para>

                        <xi:include href="./share/note-tts-features.xml"/>

                    </section>

                    <section xml:id="sec-cd-ssml-ph-attrib">
                        <title>The <code>ssml:ph</code> attribute</title>
                        <para>The <code>ssml:ph</code> attribute specifies a phonemic/phonetic
                            pronunciation of the text represented by the element onto which the
                            attribute appears.</para>
                        <variablelist xreflabel="ssml:ph" role="elem-synopsis"
                            xml:id="attrdef-ssml-ph">
                            <varlistentry>
                                <term>Attribute Name</term>
                                <listitem>
                                    <para>
                                        <literal>ph</literal>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Namespace</term>
                                <listitem>
                                    <para>
                                        <literal>http://www.w3.org/2001/10/synthesis</literal>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Usage</term>
                                <listitem>
                                    <para>May be specified on all elements with which a phonetic
                                        equivalent can logically be associated (e.g., elements that
                                        contain textual information), but must not be specified on a
                                        descendant of an element that already carries this
                                        attribute.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Value</term>
                                <listitem>
                                    <para>A phonemic/phonetic expression, syntactically valid with
                                        respect to <link linkend="sec-cd-ssml-alphabet-attrib">the
                                            phonemic/phonetic alphabet being used</link>.</para>
                                </listitem>
                            </varlistentry>
                        </variablelist>
                        <para>This attribute inherits all the semantics of the SSML 1.1 <xref
                                linkend="refSSML"/>
                            <code>phoneme</code> element's <link
                                xlink:href="http://www.w3.org/TR/speech-synthesis11/#S3.1.10">
                                <code>ph</code> attribute</link>, with the following
                            addition:</para>
                        <itemizedlist role="conformance-list">
                            <listitem>
                                <para xml:id="ssml-ph-concat"> When the <code>ssml:ph</code>
                                    attribute appears on an element that has text node descendants,
                                    the corresponding document text to which the pronunciation
                                    applies is the string that results from concatenating the
                                    descendant text nodes, in document order. The specified phonetic
                                    pronunciation must therefore logically match the element's
                                    textual data in its entirety (i.e., not just an isolated part of
                                    its content).</para>
                            </listitem>
                        </itemizedlist>
                        <note>
                            <para>Reading Systems that support the SSML Attributes and <link
                                    linkend="sec-pls">PLS Documents</link> must honor the defined
                                    <link linkend="confreq-pls-rs-casc">precedence rules</link> for
                                these two constructs. </para>
                        </note>
                    </section>

                    <section xml:id="sec-cd-ssml-alphabet-attrib">
                        <title>The <code>ssml:alphabet</code> attribute</title>

                        <para>The <code>ssml:alphabet</code> attribute specifies which
                            phonemic/phonetic pronunciation alphabet is used in the value of the
                                <xref linkend="attrdef-ssml-ph"/> attribute.</para>

                        <variablelist xreflabel="ssml:alphabet" role="elem-synopsis"
                            xml:id="attrdef-ssml-alphabet">
                            <varlistentry>
                                <term>Attribute Name</term>
                                <listitem>
                                    <para>
                                        <literal>alphabet</literal>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Namespace</term>
                                <listitem>
                                    <para>
                                        <literal>http://www.w3.org/2001/10/synthesis</literal>
                                    </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Usage</term>
                                <listitem>
                                    <para>Global, may be specified on any element.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry>
                                <term>Value</term>
                                <listitem>
                                    <para>The name of the pronunciation alphabet used in the value
                                        of <code><xref linkend="attrdef-ssml-ph"/></code>
                                        (inherited). </para>
                                </listitem>
                            </varlistentry>
                        </variablelist>

                        <para>This attribute inherits all the semantics of the SSML 1.1 <xref
                                linkend="refSSML"/>
                            <code>phoneme</code> element's <link
                                xlink:href="http://www.w3.org/TR/speech-synthesis11/#S3.1.10">
                                <code>alphabet</code> attribute</link>, with the following
                            addition:</para>
                        <itemizedlist role="conformance-list">
                            <listitem>
                                <para xml:id="ssml-alphabet-inherit">The value of the
                                        <code>ssml:alphabet</code> attribute is inherited in the
                                    document tree. The pronunciation alphabet used in a given
                                        <code>ssml:ph</code> attribute value is determined by
                                    locating the first occurrence of the <code>ssml:alphabet</code>
                                    attribute starting with the element on which the
                                        <code>ssml:ph</code> attribute appears, followed by the
                                    nearest ancestor element.</para>
                            </listitem>
                        </itemizedlist>

                        <para>Reading Systems that support the <link linkend="sec-xhtml-ssml-attrib"
                                >SSML Attributes</link> feature of this specification should support
                            the <literal>ipa</literal> alphabet.</para>

                    </section>

                </section>

                <section xml:id="sec-xhtml-content-switch">
                    <title>Content Switching</title>

                    <section xml:id="sec-xhtml-switch-intro" conformance="informative">
                        <title>Introduction</title>

                        <para>The <code>switch</code> element provides a simple mechanism through
                            which Authors can tailor the Publication content displayed to Users, one
                            that isn't dependent on the scripting capabilities of the Reading
                            System.</para>

                        <para>Reading System developers may choose to support XML vocabularies and
                            new HTML elements that are not valid in <xref
                                linkend="gloss-content-document-epub-xhtml"/>s. The
                                <code>switch</code> mechanism encourages this type of development
                            and experimentation, but at the same time provides Authors who wish to
                            take advantage of it the security of knowing that their content will
                            still display on any compliant Reading System (i.e., it maintains the
                            baseline requirement that all XHTML Content Documents be valid if none
                            of the specialized markup is supported).</para>

                        <para>Content switching is not just about encouraging future development,
                            however; it can also be used to create Publications that maintain a
                            level of compatibility with older Reading Systems unable to handle the
                            new features of EPUB 3. For example, instances of MathML, now a native
                            type, could be added using <code>switch</code> elements so that EPUB 2
                            Reading Systems could instead provide fallback images or text.</para>
                    </section>

                    <section xml:id="sec-xhtml-switch-def">
                        <title>Definition</title>

                        <section xml:id="sec-xhtml-epub-switch">
                            <title>The <code>epub:switch</code> Element</title>

                            <para>The <code>switch</code> element allows an XML fragment to be
                                conditionally inserted into the content model of an XHTML Content
                                Document.</para>

                            <variablelist xreflabel="epub:switch" role="elem-synopsis"
                                xml:id="elemdef-switch">
                                <varlistentry>
                                    <term>Element name</term>
                                    <listitem>
                                        <para>
                                            <literal>switch</literal>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Namespace</term>
                                    <listitem>
                                        <para>
                                            <literal>http://www.idpf.org/2007/ops</literal>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Usage</term>
                                    <listitem>
                                        <para>In <link
                                                xlink:href="http://www.w3.org/TR/html5/Overview.html#flow-content-0"
                                                >Flow</link> and <link
                                                xlink:href="http://www.w3.org/TR/html5/Overview.html#phrasing-content-0"
                                                >Inline</link> content. Repeatable.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Attributes</term>
                                    <listitem>
                                        <variablelist role="elem-synopsis-attlist">
                                            <varlistentry xml:id="attrdef-switch-id">
                                                <term>
                                                  <literal>id</literal>
                                                  <option>[optional]</option>
                                                </term>
                                                <listitem>
                                                  <xi:include href="./share/id-prose-para.xml"/>
                                                </listitem>
                                            </varlistentry>
                                        </variablelist>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Content Model</term>
                                    <listitem>
                                        <para>In this order: <literal><link role="codelink"
                                                  linkend="sec-xhtml-epub-case"
                                                >case</link></literal>
                                            <option>[1 or more]</option>, <literal><link
                                                  role="codelink" linkend="sec-xhtml-epub-default"
                                                  >default</link></literal>
                                            <option>[exactly 1]</option>.</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>

                            <para>A Reading System must individually process each
                                    <code>switch</code> element in a document to determine whether
                                it can render any of the child <code><link linkend="elemdef-case"
                                        >case</link></code> elements (as determined by the value of
                                their <code><link linkend="attrdef-case-required-namespace"
                                        >required-namespace</link></code> attributes).</para>

                            <para>For each <code>switch</code> encountered, the Reading System
                                should render the content of the first <code>case</code> it
                                supports, but is free to select from any of the available options.
                                If the Reading System does not support the markup contained in any
                                of the child <code>case</code> elements, it must render the contents
                                of the <code><link linkend="elemdef-default">default</link></code>
                                element.</para>

                            <para>The <xref linkend="refHTML5"/>
                                <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</link></code> element should be used to embed
                                custom (non-core) content types in XHTML Content Documents.
                                Custom markup should be wrapped only in a <code>switch</code>
                                element when the content it represents is an integral part of
                                the document and depends on the context of the document to be
                                properly processed.</para>

                            <bridgehead>Examples</bridgehead>

                            <informalexample>
                                <para>An example of ChemML markup inserted using the
                                        <code>switch</code> element.</para>
                                <synopsis><xi:include href="examples/contentdocs/switch-1.xml" parse="text"/></synopsis>
                            </informalexample>

                            <informalexample>
                                <para>An example of adding MathML markup for compliance with EPUB 2
                                    Reading Systems.</para>
                                <synopsis><xi:include href="examples/contentdocs/switch-2.xml" parse="text"/></synopsis>
                            </informalexample>

                        </section>

                        <section xml:id="sec-xhtml-epub-case">
                            <title>The <code>epub:case</code> Element</title>

                            <para>The <code>case</code> element contains markup from XML
                                vocabularies that may or may not be natively supported in XHTML
                                Content Documents.</para>

                            <variablelist xreflabel="epub:case" role="elem-synopsis"
                                xml:id="elemdef-case">
                                <varlistentry>
                                    <term>Element name</term>
                                    <listitem>
                                        <para>
                                            <literal>case</literal>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Namespace</term>
                                    <listitem>
                                        <para>
                                            <literal>http://www.idpf.org/2007/ops</literal>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Usage</term>
                                    <listitem>
                                        <para>Required first child of <code><link
                                                  linkend="elemdef-switch">switch</link></code>.
                                            Repeatable.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Attributes</term>
                                    <listitem>
                                        <variablelist role="elem-synopsis-attlist">
                                            <varlistentry xml:id="attrdef-case-id">
                                                <term>
                                                  <literal>id</literal>
                                                  <option>[optional]</option>
                                                </term>
                                                <listitem>
                                                  <xi:include href="./share/id-prose-para.xml"/>
                                                </listitem>
                                            </varlistentry>
                                            <varlistentry xml:id="attrdef-case-required-namespace">
                                                <term>
                                                  <literal>required-namespace</literal>
                                                  <option>[required]</option>
                                                </term>
                                                <listitem>
                                                  <para>An extension identifier in URI form <xref
                                                  linkend="refRFC2046"/> that identifies the XML
                                                  vocabulary or extension that the Reading System
                                                  must support in order to process the content of
                                                  the <code>case</code> element. </para>
                                                </listitem>
                                            </varlistentry>
                                        </variablelist>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Content Model</term>
                                    <listitem>
                                        <para>An XML fragment conforming to the markup vocabulary
                                            identified in the <code>required-namespace</code>
                                            attribute.</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>

                            <para>Each <code>case</code> element must contain an alternate
                                representation of the same content. To ensure the best rendering of
                                their content, Authors should order <code>case</code> elements by to
                                their optimal rendering format.</para>

                            <para>If the <code>case</code> element contains markup that is valid in
                                an XHTML Content Document (e.g., MathML), that content must be valid
                                at the point where the <code><link linkend="elemdef-switch"
                                        >switch</link></code> element has been inserted (i.e., its
                                addition must not result in an invalid document).</para>

                            <para>Foreign markup in a <code>case</code> element must be well formed,
                                but does not have to be valid at its point of insertion. Authors
                                should ensure that any foreign markup matches the context in which
                                it is used (e.g., a block element should not be included in a
                                    <code>switch</code> element inserted in an inline
                                context).</para>

                            <note>
                                <para>The IDPF maintains an informative registry of well-known
                                    extension identifiers for use in the
                                        <code>required-namespace</code> attribute at <link
                                        xlink:href="../../switch/"
                                        >http://www.idpf.org/epub/switch/</link>.</para>
                            </note>

                        </section>

                        <section xml:id="sec-xhtml-epub-default">
                            <title>The <code>epub:default</code> Element</title>

                            <para>The <code>default</code> element provides markup that is valid in
                                any XHTML Content Document for when a Reading System cannot render
                                any of the <code><link linkend="elemdef-case">case</link></code>
                                elements.</para>

                            <variablelist xreflabel="epub:default" role="elem-synopsis"
                                xml:id="elemdef-default">
                                <varlistentry>
                                    <term>Element name</term>
                                    <listitem>
                                        <para>
                                            <literal>default</literal>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Namespace</term>
                                    <listitem>
                                        <para>
                                            <literal>http://www.idpf.org/2007/ops</literal>
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Usage</term>
                                    <listitem>
                                        <para>Required last child of <literal><xref
                                                  linkend="elemdef-switch"/></literal>.</para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Attributes</term>
                                    <listitem>
                                        <variablelist role="elem-synopsis-attlist">
                                            <varlistentry xml:id="attrdef-default-id">
                                                <term>
                                                  <literal>id</literal>
                                                  <option>[optional]</option>
                                                </term>
                                                <listitem>
                                                  <xi:include href="./share/id-prose-para.xml"/>
                                                </listitem>
                                            </varlistentry>
                                        </variablelist>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term>Content Model</term>
                                    <listitem>
                                        <para>An <xref linkend="refHTML5"/>-compliant markup
                                            fragment.</para>
                                    </listitem>
                                </varlistentry>
                            </variablelist>

                            <para>The <code>default</code> element acts as a fallback for the
                                        <code><link linkend="elemdef-switch">switch</link></code>
                                and must include a representation of the content that is valid in
                                XHTML Content Documents.</para>

                            <para>The <code>default</code> element must not include content that
                                would invalidate the document at the point where the
                                    <code>switch</code> has been inserted: XHTML Content Documents
                                must be valid if all the <code>switch</code> elements are replaced
                                by their child <code>default</code> elements.</para>

                        </section>
                    </section>

                    <section xml:id="sec-xhtml-switch-processing">
                        <title>Processing</title>

                        <para><xref linkend="gloss-epub-reading-system"/>s must support the
                                <code>switch</code> element.</para>

                        <para>This specification does not require a specific rendering approach for
                                <code>switch</code> elements. A Reading Systems may choose to apply
                            CSS styling to render each <code>switch</code>, for example, but may use
                            any other approach as appropriate. All Reading Systems must present the
                            content of only one <code>case</code> element or the
                                <code>default</code> element per <code>switch</code> for rendering,
                            however.</para>

                        <para>The <code>switch</code> element must be processed as though all of its
                            children but one have the HTML5 <link
                                xlink:href="http://www.w3.org/TR/html5/Overview.html#the-hidden-attribute"
                                >hidden attribute</link> set (i.e., all the same processing rules
                            and requirements outlined for that attribute should be applied to the
                            content not to be rendered).</para>

                        <note>
                            <para>As the content that may be rendered depends on the capabilities of
                                the User's Reading System, linking can be guaranteed only to the
                                    <code>switch</code> element. Deep referencing into the
                                    <code>switch</code> element is not recommended.</para>
                        </note>

                        <note>
                            <para>The occurrence of <code>switch</code> elements in <xref
                                    linkend="gloss-content-document-epub-xhtml"/> is indicated in
                                the <xref linkend="gloss-package-document"/>
                                <xref linkend="gloss-manifest"/> through the <property><olink
                                        type="epub-spec" targetdoc="publications" targetptr="switch"
                                    /></property> property.</para>
                        </note>

                    </section>

                </section>

                <section xml:id="sec-xhtml-epub-trigger">
                    <title>The <code>epub:trigger</code> Element</title>
                    <para>The <code>trigger</code> element enables the creation of markup-defined
                        user interfaces for controlling multimedia objects, such as audio and video
                        playback, in both scripted and non-scripted contexts.</para>
                    <variablelist xreflabel="epub:trigger" role="elem-synopsis"
                        xml:id="elemdef-epub-trigger">
                        <varlistentry>
                            <term>Element name</term>
                            <listitem>
                                <para>
                                    <literal>trigger</literal>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Namespace</term>
                            <listitem>
                                <para>
                                    <literal>http://www.idpf.org/2007/ops</literal>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Usage</term>
                            <listitem>
                                <para>As a child of <code>head</code> and in <link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#flow-content-0"
                                        >Flow content</link>. Repeatable.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Attributes</term>
                            <listitem>
                                <variablelist role="elem-synopsis-attlist">
                                    <varlistentry xml:id="attrdef-trigger-id">
                                        <term>
                                            <literal>id</literal>
                                            <option>[optional]</option>
                                        </term>
                                        <listitem>
                                            <xi:include href="./share/id-prose-para.xml"/>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-action">
                                        <term>
                                            <literal>action</literal>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>The action to perform for this event.</para>
                                            <para>Allowed values: <code>show</code> |
                                                  <code>hide</code> | <code>play</code> |
                                                  <code>pause</code> | <code>resume</code> |
                                                  <code>mute</code> | <code>unmute</code>
                                            </para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-ref">
                                        <term>
                                            <literal>ref</literal>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>An IDREF <xref linkend="refXML"/> that identifies
                                                the element that is the object of the action.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-event">
                                        <term>
                                            <literal>ev:event</literal>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>The applicable event for this trigger, as defined
                                                in <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                    <varlistentry xml:id="attrdef-trigger-observer">
                                        <term>
                                            <literal>ev:observer</literal>
                                            <option>[required]</option>
                                        </term>
                                        <listitem>
                                            <para>The source object for this trigger, as defined in
                                                  <xref linkend="refEVENTS"/>.</para>
                                        </listitem>
                                    </varlistentry>
                                </variablelist>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Content Model</term>
                            <listitem>
                                <para>Empty.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>

                    <para>The <code>trigger</code> element associates an <code>event</code> from a
                        specified source object (<code>observer</code>) with a desired action to be
                        performed with a specified target object (<code>ref</code>).</para>

                    <para>The semantics of the defined <code>action</code> values are:</para>

                    <itemizedlist>
                        <listitem>
                            <para><literal>show</literal> – set the element's DOM <link
                                    xlink:href="http://www.w3.org/TR/CSS21/visufx.html#propdef-visibility"
                                    >visibility</link>
                                <xref linkend="refCSS21"/> property to visible.</para>
                        </listitem>
                        <listitem>
                            <para><literal>hide</literal> – set the element's DOM <link
                                    xlink:href="http://www.w3.org/TR/CSS21/visufx.html#propdef-visibility"
                                    >visibility</link>
                                <xref linkend="refCSS21"/> property to hidden.</para>
                        </listitem>
                        <listitem>
                            <para><literal>play</literal> – play the associated resource from the
                                beginning (only applicable to video or audio elements).</para>
                        </listitem>
                        <listitem>
                            <para><literal>pause</literal> – pause playing (only applicable to video
                                or audio elements).</para>
                        </listitem>
                        <listitem>
                            <para><literal>resume</literal> – resume playing (only applicable to
                                video or audio elements).</para>
                        </listitem>
                        <listitem>
                            <para><literal>mute</literal> – mute sound (only applicable to video or
                                audio elements).</para>
                        </listitem>
                        <listitem>
                            <para><literal>unmute</literal> – unmute sound (only applicable to video
                                or audio elements).</para>
                        </listitem>
                    </itemizedlist>
                    
                    <para>Reading Systems that support video or audio playback must support the
                        <code>epub:trigger</code> element.</para>
                    
                    <informalexample>
                        <para>Sample markup of a video player that uses <code>trigger</code>
                            elements to control playback and muting.</para>

                        <programlisting><xi:include href="examples/contentdocs/trigger.xml" parse="text"/></programlisting>
                    </informalexample>
                </section>

                <section xml:id="sec-xhtml-alternate-style-tags">
                    <title>Alternate Style Tags</title>
                    <para>In accordance with <xref linkend="refAlternateStyleTags"/> , the
                            <literal>link</literal> element <literal>class</literal> attribute may
                        include any of the following values: <literal>horizontal</literal>,
                            <literal>vertical</literal>, <literal>day</literal> and
                            <literal>night</literal>. These values inherit the semantics defined by
                        that specification for their use.</para>
                    <para>Reading Systems should select and utilize such tagged style sets as
                        appropriate, and as described in that specification.</para>
                </section>
            </section>

            <section xml:id="sec-xhtml-deviations">
                <title>HTML5 Deviations and Constraints</title>

                <para>This section defines deviations and/or constraints in EPUB 3 <xref
                        linkend="gloss-content-document-epub-xhtml"/>s to the underlying <xref
                        linkend="refHTML5"/> document model.</para>

                <section xml:id="sec-xhtml-mathml">
                    <title>Embedded MathML</title>

                    <section xml:id="sec-xhtml-mathml-intro" conformance="informative">
                        <title>Introduction</title>

                        <para>XHTML Content Documents support embedded MathML <xref
                                linkend="refMathML"/> but limit its usage to a restricted subset of
                            the full MathML markup language.</para>

                        <para>This subset is designed to ease the implementation burden on Reading
                            Systems and to promote accessibility, while retaining compatibility with
                                <xref linkend="refHTML5"/> User Agents. </para>

                        <note>
                            <para>The <property><olink type="epub-spec" targetdoc="publications"
                                        targetptr="mathml"/></property> property of the <xref
                                    linkend="gloss-manifest"/>
                                <code>item</code> element indicates that an XHTML Content Document
                                contains embedded MathML.</para>
                        </note>

                    </section>

                    <section xml:id="sec-xhtml-mathml-conf-content"
                        xreflabel="Embedded MathML — Content Conformance">
                        <title>Content Conformance</title>

                        <para>Any occurrence of MathML markup in XHTML Content Documents must
                            conform to the constraints expressed in the MathML specification <xref
                                linkend="refMathML"/>, with the following additional
                            restrictions:</para>

                        <variablelist role="conformance-list">
                            <varlistentry xml:id="math-pres">
                                <term>Presentation MathML</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-pres">The <code>m:math</code>
                                        element must contain only <link
                                            xlink:href="http://www.w3.org/TR/MathML/chapter3.html"
                                            >Presentation MathML</link>, with the exception of the
                                            <code>m:annotation-xml</code> element as defined
                                        below.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-cont">
                                <term>Content MathML</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-annot-cont"><link
                                            xlink:href="http://www.w3.org/TR/MathML/chapter4.html"
                                            >Content MathML</link> may be included within MathML
                                        markup in XHTML Content Documents, and, when present, must
                                        occur within an <code>m:annotation-xml</code> child element
                                        of an <code>m:semantics</code> element.</para>
                                    <para xml:id="confreq-mathml-annot-cont-attrs">When Content
                                        MathML is included as per the previous condition, the given
                                            <code>m:annotation-xml</code> element's
                                            <code>encoding</code> attribute must be set to either of
                                        the functionally-equivalent values
                                            <literal>MathML-Content</literal> or
                                            <code>application/mathml-content+xml</code>, and its
                                            <code>name</code> attribute must be set to
                                            <literal>contentequiv</literal>. </para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-deprecated">
                                <term>Deprecated MathML</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-deprecated">Elements and attributes
                                        marked as deprecated in <xref linkend="refMathML"/> must not
                                        be included within MathML markup in XHTML Content
                                        Documents.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-xhtml">
                                <term>XHTML Content Document fragments</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-annot-xht">XHTML Content Document
                                        fragments may be included within MathML markup in XHTML
                                        Content Documents, and, when present, must occur within an
                                            <code>m:annotation-xml</code> child element of an
                                            <code>m:semantics</code> element.</para>
                                    <para xml:id="confreq-mathml-annot-xht-attrs">When an XHTML
                                        Content Document fragment is included as per the above
                                        paragraph, the given <code>m:annotation-xml</code> element's
                                            <code>encoding</code> attribute must be set to
                                            <literal>application/xhtml+xml</literal> and its
                                            <code>name</code> attribute must be set to
                                            <literal>alternate-representation</literal>.</para>
                                    <para xml:id="confreq-mathml-annot-xht-math">Any included XHTML
                                        Content Document fragments must not themselves contain
                                        MathML markup.</para>
                                    <para xml:id="confreq-mathml-annot-xht-model">Any included XHTML
                                        Content Document fragments must conform to the content model
                                        in which the ancestor <code>m:math</code> element occurs,
                                        such that if the <code>m:math</code> element is replaced by
                                        the given XHTML Content Document fragment the document
                                        remains valid.</para>
                                </listitem>
                            </varlistentry>
                            <varlistentry xml:id="math-alt">
                                <term>Alternative Content</term>
                                <listitem>
                                    <para xml:id="confreq-mathml-alt">Alternative content should be
                                        included, and, when present, must be represented as defined
                                        in <xref linkend="sec-xhtml-mathml-alt"/>.</para>
                                </listitem>
                            </varlistentry>
                        </variablelist>

                    </section>


                    <section xml:id="sec-xhtml-mathml-rs-conf"
                        xreflabel="Embedded MathML — Reading System Conformance">
                        <title>Reading System Conformance</title>

                        <para>A conformant <xref linkend="gloss-epub-reading-system"/> must meet all
                            of the following criteria for processing MathML embedded in XHTML
                            Content Documents:</para>

                        <itemizedlist role="conformance-list" xml:id="mathml-rs-confreqs">
                            <listitem>
                                <para xml:id="confreq-mathml-rs-behavior">It must support processing
                                    of <link xlink:href="http://www.w3.org/TR/MathML/chapter3.html"
                                        >Presentation MathML</link>, and may support processing of
                                        <link xlink:href="http://www.w3.org/TR/MathML/chapter4.html"
                                        >Content MathML</link>, using semantics defined by the
                                    MathML 3.0 specification <xref linkend="refMathML"/>.</para>
                            </listitem>
                            <listitem>
                                <para xml:id="confreq-mathml-rs-render">If it has a <xref
                                        linkend="gloss-viewport"/>, it must support visual rendering
                                    of Presentation MathML.</para>
                            </listitem>
                            <listitem>
                                <para xml:id="confreq-mathml-rs-alt-text">When producing <link
                                        linkend="sec-xhtml-mathml-alt">alternative textual
                                        content</link> for MathML markup, it should be able to
                                    dynamically generate such content from the given <link
                                        linkend="confreq-mathml-pres">Presentation MathML</link>,
                                    and if not, must give preference to <link linkend="math-xhtml"
                                        >XHTML Content Document fragments</link> followed by the
                                        <code>alttext</code> attribute on the <code>m:math</code>
                                    element.</para>
                            </listitem>
                            <listitem>
                                <para xml:id="confreq-rs-mathml-prop">It must regard the <olink
                                        type="epub-spec" targetdoc="publications" targetptr="mathml"
                                    /> property of the <xref linkend="gloss-package-document"/>
                                    <xref linkend="gloss-manifest"/>
                                    <code>item</code> element as the authoritative definition of
                                    whether an XHTML Content Document includes embedded
                                    MathML.</para>
                            </listitem>

                        </itemizedlist>
                    </section>

                    <section xml:id="sec-xhtml-mathml-alt">
                        <title>Alternative Content</title>

                        <para>Reading Systems should be able to generate any necessary alternative
                            textual renditions dynamically using the given <link
                                linkend="confreq-mathml-pres">Presentation MathML</link> markup
                            (e.g., as output to <xref linkend="gloss-tts"/> engines). To support
                            Reading Systems that are not so capable, alternative textual
                            content should be included with each occurrence of the
                                <code>m:math</code> element in XHTML Content Documents.</para>

                        <para>The <code>alttext</code> attribute on the <code>m:math</code> element
                            should be used for this purpose primarily when shorter alternative text
                            runs are sufficient. When more extensive alternative text is required,
                                <link linkend="math-xhtml">XHTML Content Document fragments</link>
                            should be used. (Note that Reading Systems query these two alternative
                            text locations using a defined <link
                                linkend="confreq-mathml-rs-alt-text">preference order</link>.) </para>

                        <para>For Reading System forward compatibility purposes, fallback images may
                            be provided using the <code>altimg</code> attribute on the
                                <code>m:math</code> element. It is recommended that the dimension
                            and alignment attributes (<code>altimg-width</code>,
                                <code>altimg-height</code> and <code>altimg-valign</code>) be used
                            in conjunction with the <code>altimg</code> attribute.</para>

                        <note xml:id="note-mathml-altimg-refprops-pkg">
                            <!-- note similar statement for xhtml, svg and css and mathml alternative content -->
                            <para>All referenced <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s
                                must conform to the constraints for Publication Resources defined in
                                    <olink type="epub-spec" targetdoc="publications"
                                    targetptr="sec-epub-content-conf"/>.</para>
                        </note>
                    </section>

                </section>


                <section xml:id="sec-xhtml-svg">
                    <title>Embedded SVG</title>
                    <!-- http://www.w3.org/TR/html5/the-map-element.html#svg-0 -->

                    <para><xref linkend="gloss-content-document-epub-xhtml"/>s support the embedding
                        of SVG <emphasis>by reference</emphasis> (embedding via reference, for
                        example, from an <code>img</code> or <code>object</code> element) and
                            <emphasis>by inclusion</emphasis> (embedding via direct inclusion of the
                            <code>svg:svg</code> element in the XHTML Content Document) <xref
                            linkend="refSVG"/>.</para>

                    <para>The content conformance constraints for SVG embedded in XHTML Content
                        Documents are the same as defined for <xref
                            linkend="gloss-content-document-epub-svg"/>s in <xref
                            linkend="sec-svg-restrictions"/>.</para>

                    <para>Reading Systems must process SVG embedded in XHTML Content Documents as
                        defined in <xref linkend="sec-svg-rs-conf"/>.</para>

                    <note>
                        <para>The <property><olink type="epub-spec" targetdoc="publications"
                                    targetptr="svg"/></property> property of the <xref
                                linkend="gloss-manifest"/>
                            <code>item</code> element indicates that an XHTML Content Document
                            contains embedded SVG.</para>
                    </note>

                    <!--
                    <note>
                        <para>This section defines conformance requirements for SVG embedded in
                            XHTML Content Documents. Refer to <xref linkend="sec-svg"/> for
                            conformance requirements for SVG as an EPUB Content Document.</para>
                    </note>
                    -->

                    <section xml:id="sec-xhtml-svg-css">
                        <title>Embedded SVG and CSS</title>

                        <para xml:id="confreq-svg-rs-css-embed-ref">For the purposes of styling SVG
                            embedded in XHTML Content Documents <emphasis>by reference</emphasis>,
                            Reading Systems must not apply CSS style rules of the containing
                            document to the referenced SVG document.</para>

                        <para xml:id="confreq-svg-rs-css-embed-inc">For the purposes of styling SVG
                            embedded in XHTML Content Documents <emphasis>by inclusion</emphasis>,
                            Reading Systems must apply applicable CSS rules of the containing
                            document to the included SVG elements.</para>

                        <note>
                            <para>SVG included <emphasis>by reference</emphasis> is processed as a
                                separate document, and may include its own CSS style rules just like
                                an <xref linkend="gloss-content-document-epub-svg"/> would. Note
                                that this is consistent with situations where an <xref
                                    linkend="refHTML5"/>
                                <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</link></code> element references an external <xref
                                    linkend="refHTML5"/> element.</para>
                        </note>

                    </section>

                </section>

                <section xml:id="sec-xhtml-deviations-unicode">
                    <title>Unicode Restrictions</title>

                    <para>This section lists restrictions on the Unicode character
                        repertoire.</para>

                    <variablelist>
                        <varlistentry>
                            <term>Private Use Characters and Embedded Fonts</term>
                            <listitem>
                                <para xml:id="confreq-xhtml-unicode-pua">Any included characters
                                    that map to a code point within one of the Private Use Area
                                    (PUA) ranges as defined in <xref linkend="refUnicode5"/> must
                                    occur within a string that is styled or attributed in a manner
                                    that includes a reference to an <link linkend="sec-css-fonts"
                                        >embedded font</link> that contains an appropriate glyph for
                                    that code point.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </section>

                <section xml:id="sec-xhtml-deviations-discouraged">
                    <title>Discouraged Constructs</title>
                    <variablelist role="conformance-list">
                        <varlistentry>
                            <term>The <code>rp</code> Element</term>
                            <listitem>
                                <para xml:id="confreq-xhtml-vocab-rp">The <xref linkend="refHTML5"/>
                                    <code><link
                                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-rp-element"
                                            >rp</link></code> element is intended to provide a
                                    fallback — an optional parenthesis display around
                                        <code>ruby</code> markup — for older version Reading Systems
                                    that do not recognize ruby markup. As EPUB 3 Reading Systems are
                                    ruby-aware, and can provide fallbacks, the use of
                                        <code>rp</code> elements in Content Documents is
                                    discouraged.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>The <code>embed</code> Element</term>
                            <listitem>
                                <para xml:id="confreq-xhtml-vocab-embed">Since the <xref
                                        linkend="refHTML5"/>
                                    <code><link
                                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-embed-element"
                                        >embed</link></code> element does not provide intrinsic facilities
                                    to provide <link linkend="confreq-rs-scripted-flbk"
                                        >fallbacks</link> for Reading Systems that do not support
                                    scripting, its use is discouraged when the resource referenced
                                    has scripting components. Authors should use the
                                        <code>object</code> element instead.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </section>

                <!-- iframe src restriction dropped as per Issue 129
                <section xml:id="sec-xhtml-deviations-restricted">
                    <title>Restricted Constructs</title>
                    <para>This section lists restrictions on <xref
                            linkend="gloss-content-document-epub-xhtml"/> that are not enforced by
                        the <link linkend="app-xhtml-schema">schema for XHTML Content
                            Documents</link>.</para>
                    <variablelist role="conformance-list">
                        <varlistentry xml:id="confreq-cd-xhtml-refprops">
                            <term>Reference Restrictions</term>
                            <listitem>
                                <para xml:id="confreq-cd-xhtml-refprops-iframe"
                                    xreflabel="iframe src type restriction">The HTML5
                                        <code>iframe</code> element <code>src</code> attribute must
                                    only reference <xref linkend="gloss-content-document-epub-xhtml"
                                    />s. </para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                </section>
                -->

            </section>

        </section>

        <section xml:id="sec-xhtml-nav">

            <title>EPUB Navigation Documents</title>

            <section xml:id="sec-xhtml-nav-intro" conformance="informative">
                <title>Introduction</title>

                <para>The EPUB Navigation Document is a <olink type="epub-spec"
                        targetdoc="publications" targetptr="sec-epub-content-conformance-nav"
                        >required component</olink> of <xref linkend="gloss-epub-publication"/>s. It
                    provides the Author with a mechanism to include a human- and machine-readable
                    global navigation layer in the Publication, thereby ensuring increased usability
                    and accessibility for the User. </para>

                <para>The EPUB Navigation Document is an adaptation of <xref
                        linkend="gloss-content-document-epub-xhtml"/>, and is <link
                        linkend="confreq-cd-nav-docprops-parent">by definition</link> a valid XHTML
                    Content Document instance. All Content and Reading System conformance
                    requirements that apply to XHTML Content Documents also apply to the EPUB
                    Navigation Document.</para>

                <para>The navigation features of this adaptation are expressed through
                    specializations of the <xref linkend="refHTML5"/>
                    <code><link
                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-nav-element"
                            >nav</link></code> element. Each <code>nav</code> element in an EPUB
                    Navigation Document represents a data island — an embedded source of specialized
                    information within the general markup — from which Reading Systems can retrieve
                    navigational information. Unlike typical XML data islands, however, the
                    information within the <code>nav</code> element remains human readable as an
                        <xref linkend="refHTML5"/> document.</para>

                <para>To facilitate machine readability, the content model of <code>nav</code>
                    elements in EPUB Navigation Documents is restricted relative to what is allowed
                    in general XHTML Content Documents.</para>

                <note>
                    <para>The EPUB Navigation Document is identified in the <xref
                            linkend="gloss-package-document"/>
                        <xref linkend="gloss-manifest"/> through the <property><olink
                                type="epub-spec" targetdoc="publications" targetptr="nav"
                            /></property> property.</para>
                </note>

                <note xml:id="note-ncx">
                    <para>The EPUB Navigation Document supersedes the NCX document type as defined
                        in <xref linkend="refOPF2"/>.</para>
                    <para>Information on how EPUB 3 Publications may include an NCX document for
                        EPUB 2 Reading System forwards compatibility purposes is available in <olink
                            type="epub-spec" targetdoc="publications" targetptr="ncx-superseded"
                        />.</para>
                </note>

            </section>

            <section xml:id="sec-xhtml-nav-content-conf"
                xreflabel="EPUB Navigation Documents — Content Conformance">
                <title>Content Conformance</title>

                <para>A conformant <xref linkend="gloss-content-document-epub-nav"/> must meet all
                    of the following criteria:</para>

                <variablelist role="conformance-list" xml:id="confreq-cd-nav">
                    <varlistentry xml:id="confreq-cd-nav-docprops">
                        <term>Document Properties</term>
                        <listitem>
                            <para xml:id="confreq-cd-nav-docprops-parent">It must conform to all
                                content conformance constraints for <xref
                                    linkend="gloss-content-document-epub-xhtml"/>s as defined in
                                    <xref linkend="sec-xhtml-conf-content"/>.</para>
                            <para xml:id="confreq-cd-nav-docprops-schema">It must be valid to the
                                EPUB Navigation Document schema as defined in <xref
                                    linkend="app-xhtml-nav-schema"/> and conform to all content
                                conformance constraints specific for EPUB Navigation Documents
                                expressed in <xref linkend="sec-xhtml-nav-def"/>.</para>
                            <para>As a conforming XHTML Content Document, it may be included in the
                                Publication <xref linkend="gloss-spine"/>, but may also be provided
                                independently of it. </para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>

            <section xml:id="sec-xhtml-nav-rs-conf"
                xreflabel="EPUB Navigation Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para>A conformant <xref linkend="gloss-epub-reading-system"/> must meet all of the
                    following criteria for processing <xref
                        linkend="gloss-content-document-epub-nav"/>:</para>

                <itemizedlist role="conformance-list" xml:id="xhtml-nav-rs-confreqs">
                    <listitem>
                        <para xml:id="confreq-nav-access">When requested by a User, Reading Systems
                            must provide access to the links and link labels in <link
                                linkend="sec-xhtml-nav-def-types">the <code>nav</code>
                                elements</link> of the EPUB Navigation Document in a fashion that
                            allows the User to activate the links provided. When a link is
                            activated, the Reading System must relocate the application's current
                            reading position to the destination identified by that link.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-nav-spine">Reading Systems must honor the above
                            requirement irrespective of whether the EPUB Navigation Document
                            provided in a Publication is part of the <xref linkend="gloss-spine"
                            />.</para>
                    </listitem>

                </itemizedlist>
            </section>

            <section xml:id="sec-xhtml-nav-def">
                <title>EPUB Navigation Document Definition</title>

                <section xml:id="sec-xhtml-nav-def-model">
                    <title>The <code>nav</code> Element: Restrictions</title>
                    <para>This specification restricts the content model of the <code>nav</code>
                        element and its descendants in <xref
                            linkend="gloss-content-document-epub-nav"/>s as follows:</para>

                    <itemizedlist role="conformance-list">
                        <listitem>
                            <para xml:id="confreq-nav-hd">Each <code>nav</code> element may contain
                                an optional heading indicating the title of the navigation list. The
                                heading must be one of the <xref linkend="refHTML5"/>
                                <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-h1-h2-h3-h4-h5-and-h6-elements"
                                        >h1 through h6</link></code> elements or an <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-hgroup-element"
                                        >hgroup</link></code>.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-ol">The optional heading must be followed by a
                                single <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-ol-element"
                                        >ol</link></code> ordered list; no other elements are
                                permitted as direct children of the <code>nav</code> element. This
                                ordered list represents the primary level of content
                                navigation.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a">Each list item (<code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-li-element"
                                        >li</link></code>) of the ordered list represents a primary
                                heading, structure or other point of interest within the Publication
                                and must contain either a child <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-a-element"
                                        >a</link></code> element or a child <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-span-element"
                                        >span</link></code> element. The <code>a</code> element
                                describes the target within the Content Document that the link
                                points to. The <code>span</code> element serves as a heading for
                                breaking down lists into distinct groups (for example, a large list
                                of illustrations can be segmented into several lists, one for each
                                chapter).</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a-cnt">Each child <code>a</code> or
                                    <code>span</code> element of a list item may contain any valid
                                    <link
                                    xlink:href="http://www.w3.org/TR/html5/Overview.html#phrasing-content-0"
                                    >HTML5 phrasing content</link>, but must not result in a
                                zero-length text string after concatenation of all child content and
                                application of whitespace normalization rules.</para>
                        </listitem>
                        <listitem xml:id="confreq-nav-a-title">
                            <para>If the <code>a</code> element contains instances of <link
                                    xlink:href="http://dev.w3.org/html5/spec/Overview.html#embedded-content-0"
                                    >HTML5 embedded content</link> that do not provide intrinsic
                                text alternatives, it must also include a <code>title</code>
                                attribute with an alternate text rendition of the link label.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a-href">The relative IRI reference provided in
                                the <code>href</code> attribute of the <code>a</code> element must
                                resolve to an <!-- olink
		                                    type="epub-spec" targetdoc="contentdocs"
		                                    targetptr="gloss-content-document-epub"/ -->
                                <xref linkend="gloss-content-document-epub"/> or fragment
                                therein.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-a-nest">The <code>a</code> element may
                                optionally be followed by an <code>ol</code> ordered list
                                representing a subsidiary content level below that heading (e.g.,
                                all the subsection headings of a section). The <code>span</code>
                                element is meant as a heading for navigation groups, so it cannot be
                                used in "leaf" <code>li</code> elements: it must be followed by an
                                    <code>ol</code> ordered list. Regardless of whether the
                                    <code>a</code> or <code>span</code> element is used, this
                                sublist must adhere to all the content requirements defined in this
                                section for constructing the primary navigation list, and
                                recursively (for each additional level of the Publication's
                                hierarchy represented in this manner).</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-nav-ol-style">The <code>ol</code> element
                                represents an ordered list. In the context of this specification,
                                the default display style of list items must be equivalent to CSS
                                    <code>list-style: none</code> (Reading Systems with no CSS
                                support must not show list item numbering). Authors may specify
                                alternative list item styles using CSS, but these would obviously be
                                ignored by Reading Systems that do not support Cascading Style
                                Sheets. </para>
                        </listitem>
                    </itemizedlist>

                    <informalexample>
                        <para>The following example shows a partial <literal>lot</literal> ("list of
                            tables") <code>nav</code> element, with <code>span</code>
                            elements used as link-less headings for grouping the sublists.</para>
                        <synopsis><xi:include href="./examples/contentdocs-nav/grouped-list.xml" parse="text"/></synopsis>
                    </informalexample>
                </section>

                <section xml:id="sec-xhtml-nav-def-types">
                    <title>The <code>nav</code> Element: Types</title>

                    <para>The <code>nav</code> elements within the EPUB Navigation Document are
                        distinguished semantically through the value of their <code>epub:type</code>
                        attribute. By default (and as inferred from the value of the
                            <code>html</code> element <code>profile</code> attribute), values of
                            <code>epub:type</code> are drawn from the EPUB 3 Structural Semantics
                        Vocabulary <xref linkend="refEPUBStructureVocab"/>, but values drawn from
                        other vocabularies are also allowed. Refer to <xref
                            linkend="sec-xhtml-content-type-attribute"/> for more information. </para>

                    <section xml:id="sec-xhtml-nav-def-types-toc">
                        <title>The <property>toc</property>
                            <code>nav</code> Element</title>

                        <para>The <literal>toc</literal>
                            <code>nav</code> element defines the primary navigational hierarchical
                            outline of the <xref linkend="gloss-epub-publication"/>. It conceptually
                            corresponds to a table of contents in a printed work (i.e., it provides
                            navigation to the structural sections of the Publication).</para>

                        <para>For usability and accessibility reasons, <xref linkend="gloss-author"
                            />s should provide a comprehensive table of contents: the <literal>toc</literal> 
                            <code>nav</code> should not exclude references based solely on their nesting
                            depth within the document hierarchy, as is often the case in print works (particularly
                            in reduced tables of contents).</para>
                        
                        <para>In the case of Publications that exclusively reference XHTML Content Documents
                            from their <code>spine</code>s, the <literal>toc</literal>
                            <code>nav</code> will typically correspond to the aggregation of <link
                                xlink:href="http://www.w3.org/TR/html5/Overview.html#headings-and-sections"
                                >HTML5 outlines</link> of those documents (excluding any subtrees that do not
                            contribute to the primary Publication outline).</para>

                        <para>The order of <code>li</code> elements contained within the
                                <literal>toc</literal>
                            <code>nav</code> element must match the order of the 
                            targeted elements within each 
                            <link linkend="confreq-nav-a-href">targeted EPUB Content Document</link>, 
                            and must also follow the order of Content Documents in the Publication <xref
                                linkend="gloss-spine"/>.</para>

                        <para>The <property>toc</property>
                            <code>nav</code> element must occur exactly once in EPUB Navigation
                            Documents.</para>

                        <note>
                            <para>The <property>toc</property>
                                <code>nav</code> element corresponds to the <code>navMap</code>
                                element in the superseded NCX <xref linkend="refOPF2"/>.</para>
                        </note>

                        <!--<note>
                            <para>When <xref linkend="gloss-content-document-epub-xhtml"/>s are used
                                in the Publication <xref linkend="gloss-spine"/>, authoring tools
                                may utilize the <link
                                    xlink:href="http://www.w3.org/TR/html5/Overview.html#outlines"
                                    >HTML5 document outline algorithm</link> to generate the
                                    <literal>toc</literal>
                                <code>nav</code> element contents. Note, however, that when the spine
                                includes multiple Content Documents, the <literal>toc</literal>
                                <code>nav</code> element contains navigation information that spans
                                across multiple outlines (the full table of contents aggregates
                                outlines obtained from several XHTML Content Documents).</para>
                        </note>-->

                    </section>

                    <section xml:id="sec-xhtml-nav-def-types-pagelist">
                        <title>The <property>page-list</property>
                            <code>nav</code> Element</title>

                        <para>The <literal>page-list</literal>
                            <code>nav</code> element is a container for pagination information. It
                            provides navigation to positions in the Publication content that
                            correspond to the locations of page boundaries present in a print source
                            being represented by this EPUB Publication.</para>

                        <para>The <property>page-list</property>
                            <code>nav</code> element is optional in EPUB Navigation Documents, and
                            must not occur more than once. </para>

                        <para> The order of <code>li</code> elements contained within a
                                <property>page-list</property>
                            <code>nav</code> structure must match the order of the actual pages
                            inside each <link linkend="confreq-nav-a-href">targeted EPUB Content Document</link>,
                            and must also
                            follow the order of Content Documents in the Publication <xref
                                linkend="gloss-spine"/>. </para>

                        <para>The <property>page-list</property>
                            <code>nav</code> element should contain only a single <code>ol</code>
                            descendant (i.e., it should be a flat list, not a nested structure 
                            of navigation items). </para>

                        <note>
                            <para>The <property>page-list</property>
                                <code>nav</code> element corresponds to the <code>pageList</code>
                                element in the superseded NCX. <xref linkend="refOPF2"/></para>
                        </note>

                        <note>
                            <para>The <olink type="epub-spec" targetptr="source-identifier"
                                    targetdoc="publications"/> property provides a means of
                                identifying the source publication to which the given pagination
                                information applies.</para>
                        </note>
                    </section>

                    <section xml:id="sec-xhtml-nav-def-types-landmarks">
                        <title>The <property>landmarks</property>
                            <code>nav</code> Element</title>

                        <para>The <literal>landmarks</literal>
                            <code>nav</code> element identifies fundamental structural components of
                            the publication in order to enable Reading Systems to provide the User
                            efficient access to them.</para>

                        <para>The structural semantics of each link target within the
                                <literal>landmarks</literal>
                            <code>nav</code> element is determined through the value of the <link
                                linkend="sec-xhtml-content-type-attribute">epub:type</link>
                            attribute on the <code>a</code> element descendants. The
                                <code>epub:type</code> attribute is required on <code>a</code>
                            element descendants of the <literal>landmarks</literal>
                            <code>nav</code> element. </para>

                        <para xml:id="nav-landmarks-htu-extend">The <literal>landmarks</literal>
                            <code>nav</code> element extends the suggested <!-- TODO make olink -->
                            HTML context of terms from the <link linkend="refEPUBStructureVocab"
                                >EPUB Structural Semantics Vocabulary</link> to include the
                                <code>a</code> element. </para>

                        <informalexample>
                            <para>The following example shows a <literal>landmarks</literal>
                                <code>nav</code> element with structural semantics drawn from the
                                    <link linkend="refEPUBStructureVocab">EPUB Structural Semantics
                                    Vocabulary</link>.</para>
                            <synopsis><xi:include href="./examples/contentdocs-nav/landmarks.xml" parse="text"/></synopsis>
                        </informalexample>

                        <para>The <property>landmarks</property>
                            <code>nav</code> element is optional in EPUB Navigation Documents and
                            must not occur more than once. </para>

                        <note>
                            <para>The <property>landmarks</property>
                                <code>nav</code> element corresponds to the deprecated OPF
                                    <code>guide</code> element. Refer to <olink type="epub-spec"
                                    targetdoc="publications" targetptr="sec-guide-elem"/> for more
                                information. </para>
                        </note>
                    </section>

                    <section xml:id="sec-xhtml-nav-def-types-other">
                        <title>Other <code>nav</code> Elements</title>

                        <para>EPUB Navigation Documents may include zero or more <code>nav</code>
                            elements in addition to the <literal>toc</literal>,
                                <literal>page-list</literal> and <literal>landmarks</literal>
                            <code>nav</code> elements defined above. Such additional
                                <code>nav</code> elements should have an <code>epub:type</code>
                            attribute to provide a machine-readable semantic, and must have a
                            human-readable heading as their first child.</para>

                        <para>This specification imposes no restrictions on the semantics of such
                            additional <code>nav</code> elements: they may be used to represent
                            navigational semantics for any information domain, and they may contain
                            link targets with homogeneous or heterogeneous semantics.</para>

                    </section>
                </section>

                <section xml:id="sec-xhtml-nav-def-hidden">
                    <title>The <code>hidden</code> attribute</title>

                    <para>In some cases, <xref linkend="gloss-author"/>s may wish to hide parts of
                        the navigation data within the content flow (i.e., the Reading System's
                        principal rendering of the <xref linkend="gloss-spine"/> contents). A
                        typical example is the <link linkend="sec-xhtml-nav-def-types-pagelist">list
                            of page breaks</link>, which usually isn't rendered as part of the
                        content flow but instead exposed to the <xref linkend="gloss-user"/>
                        separately in a dedicated navigation user interface.</para>

                    <para> While the CSS <literal>display</literal> property can be used to control
                        the visual rendering of EPUB Navigation Documents in Reading Systems with
                            <xref linkend="gloss-viewport-css"/>s, not all Reading Systems provide
                        such an interface. To control rendering across all Reading Systems, authors
                        must use the <xref linkend="refHTML5"/>
                        <code><link
                                xlink:href="http://www.w3.org/TR/html5/Overview.html#the-hidden-attribute"
                                >hidden</link></code> attribute to indicate which (if any) portions
                        of the navigation data are excluded from rendering in the content flow. The
                            <code>hidden</code> attribute has no effect on how navigation data is
                        rendered outside of the content flow (such as in dedicated navigation user
                        interfaces provided by Reading Systems).</para>

                    <informalexample>
                        <para>The following example shows a partial <literal>page-list</literal>
                            <code>nav</code> element. The presence of the <code>hidden</code>
                            attribute on the root indicates that the entire list is excluded from
                            rendering in the content flow.</para>
                        <synopsis><xi:include href="./examples/contentdocs-nav/page-list.xml" parse="text"/></synopsis>
                    </informalexample>

                    <informalexample>
                        <para>The following example shows a partial <literal>toc</literal>
                            <code>nav</code> element where the <code>hidden</code> attribute is used
                            to limit content flow rendering to the two topmost hierarchical
                            levels.</para>
                        <synopsis><xi:include href="./examples/contentdocs-nav/toc.xml" parse="text"/></synopsis>
                    </informalexample>

                </section>
            </section>
        </section>

        <section xml:id="sec-svg">
            <title>SVG Content Documents</title>
            <section xml:id="sec-svg-intro" conformance="informative">
                <title>Introduction</title>

                <para>The Scalable Vector Graphics (SVG) 1.1 (Second Edition) specification <xref
                        linkend="refSVG"/> defines a format for representing final-form vector
                    graphics and text.</para>

                <para>Although an EPUB Publication typically uses <link linkend="sec-xhtml">XHTML
                        Content Documents</link> as the <link
                        linkend="gloss-content-document-top-level">top-level</link> document type,
                    the use of <xref linkend="gloss-content-document-epub-svg"/>s is also permitted.
                    SVGs are typically only used in certain special circumstances, such as
                    when final-form page images are the only suitable representation of the content
                    (as may be the case, for example, in the context of manga or comic books). </para>

                <para>This section defines a profile for <xref linkend="refSVG"/> documents.
                    An instance of an XML document that conforms to this profile is a <xref
                        linkend="gloss-core-media-type"/> and is referred to in this specification
                    and its <link linkend="sibling-specs">sibling specifications</link> as an <xref
                        linkend="gloss-content-document-epub-svg"/>.</para>

                <note>
                    <para>This section defines conformance requirements for <xref
                            linkend="gloss-content-document-epub-svg"/>s. Refer to <xref
                            linkend="sec-xhtml-svg"/> for conformance requirements for SVG embedded
                        in XHTML Content Documents.</para>
                </note>

            </section>
            <section xml:id="sec-svg-content-conf"
                xreflabel="SVG Content Documents — Content Conformance">
                <title>Content Conformance</title>
                <variablelist role="conformance-list">
                    <para>An <xref linkend="gloss-content-document-epub-svg"/> must meet all of the
                        following criteria:</para>
                    <varlistentry xml:id="confreq-mo-docprops">
                        <term>Document Properties</term>
                        <listitem role="conformance-item">
                            <para xml:id="confreq-cd-svg-xml">
                                <xi:include href="./share/xml-defref.xml"/>
                            </para>
                            <para xml:id="confreq-cd-svg-docprops-schema">It must be valid to the
                                SVG Content Document schema as defined in <xref
                                    linkend="app-svg-schema"/> and conform to all content
                                conformance constraints expressed in <xref
                                    linkend="sec-svg-restrictions"/>.</para>
                            <para xml:id="confreq-cd-svg-accessibility">It should adhere to the
                                accessibility guidelines given in <xref linkend="refSVGAccess"/>.
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="confreq-svg-fileprops">
                        <term>File Properties</term>
                        <listitem>
                            <para xml:id="confreq-svg-fileprops-name">The SVG Content Document
                                filename should use the file extension
                                <filename>.svg</filename>.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <note xml:id="note-cd-svg-refprops-pkg">
                    <!-- note similar statement for xhtml, svg and css-->
                    <para>All <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s
                        referenced from an SVG Content Document must conform to the constraints for
                        Publication Resources defined in <olink type="epub-spec"
                            targetdoc="publications" targetptr="sec-epub-content-conf"/></para>
                </note>
            </section>
            <section xml:id="sec-svg-restrictions">
                <title>Restrictions on SVG 1.1</title>

                <para>This specification restricts the content model of <xref
                        linkend="gloss-content-document-epub-svg"/>s and <link
                        linkend="sec-xhtml-svg">SVG embedded in XHTML Content Documents</link> as
                    follows:</para>

                <itemizedlist role="conformance-list" xml:id="sec-svg-restrictions-list">
                    <listitem>
                        <para xml:id="confreq-svg-anim">The <xref linkend="refSVG"/> <link
                                xlink:href="http://www.w3.org/TR/SVG/animate.html#AnimationElements"
                                >Animation Elements</link> and <link
                                xlink:href="http://www.w3.org/TR/SVG/script.html#AnimationEvents"
                                >Animation event attributes</link>
                            must not occur. </para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-foreignObject">The <xref linkend="refSVG"/> 
                            <code><link xlink:href="http://www.w3.org/TR/SVG11/extend.html#ForeignObjectElement">svg:foreignObject</link></code>
                            element must contain only valid XHTML Content
                            Document Flow content, and its <code>requiredExtensions</code>
                            attribute, if given, must be set to
                                <literal>http://www.idpf.org/2007/ops</literal>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-title">The <xref linkend="refSVG"/> 
                            <code><link xlink:href="http://www.w3.org/TR/SVG11/struct.html#TitleElement">svg:title</link></code>
                            element must contain only valid XHTML Content
                            Document Phrasing content.</para>
                    </listitem>
                    <!-- <listitem>
                        <para xml:id="confreq-svg-dim">It should include the <code><link
                                    xlink:href="http://www.w3.org/TR/SVG/struct.html#SVGElementWidthAttribute"
                                    >width</link></code> and <code><link
                                    xlink:href="http://www.w3.org/TR/SVG/struct.html#SVGElementHeightAttribute"
                                    >height</link></code> attributes on the <code>svg:svg</code>
                            element.</para>
                    </listitem> -->
                </itemizedlist>

            </section>
            <section xml:id="sec-svg-rs-conf"
                xreflabel="SVG Content Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para>A conformant <xref linkend="gloss-epub-reading-system"/> must meet all of the
                    following criteria for processing SVG Content Documents and SVG <link
                        linkend="sec-xhtml-svg">embedded in XHTML Content Documents</link>:</para>

                <itemizedlist role="conformance-list" xml:id="svg-rs-confreqs">
                    <!--
                    <listitem>
                        <para xml:id="confreq-svg-rs-behavior">It must support processing of SVG
                            using semantics defined by the SVG 1.1 specification <xref
                                linkend="refSVG"/>.</para>
                    </listitem>
                    -->
                    <listitem>
                        <para xml:id="confreq-svg-rs-behavior">It must support the language features
                            of SVG that correspond to the feature string
                                <literal>http://www.w3.org/TR/SVG11/feature#SVG-dynamic</literal>
                            minus the
                                <literal>http://www.w3.org/TR/SVG11/feature#Animation</literal> and
                                <literal>http://www.w3.org/TR/SVG11/feature#AnimationEventsAttribute</literal>
                            features (see <link xlink:href="http://www.w3.org/TR/SVG/feature.html"
                                >Feature strings</link>) <xref linkend="refSVG"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-rs-scrpt">It must meet the Reading System
                            conformance criteria defined in <xref
                                linkend="sec-scripted-content-rs-reqs"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-rs-css">If it has an <xref
                                linkend="gloss-viewport-svg"/>, it must support the visual rendering
                            of SVG using CSS as defined in <link
                                xlink:href="http://www.w3.org/TR/SVG11/styling.html">Section
                                6</link> of <xref linkend="refSVG"/>, and it should support all
                            properties defined in <link
                                xlink:href="http://www.w3.org/TR/SVG11/propidx.html">Appendix
                                N</link> of that specification. In the case of embedded SVG, it must
                            also conform to the constraints defined in <xref
                                linkend="sec-xhtml-svg-css"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-svg-rs-text">It should support User selection and
                            searching of text within SVG elements.</para>
                    </listitem>
                    <!-- not needed as we changed confreq-svg-rs-behavior
                    <listitem>
                        <para xml:id="confreq-svg-rs-links">It must recognize SVG links (i.e., the
                                <code>svg:a</code> element), and if it supports exposing links to
                            Users for activation, then these links must be exposed. </para>
                    </listitem>
                    -->
                    <listitem>
                        <para xml:id="confreq-svg-rs-reqdExt">It must recognize the value
                                <literal>http://www.idpf.org/2007/ops</literal> of the
                                <code>requiredExtensions</code> attribute when appearing on the
                                <code>svg:switch</code> and <code>svg:foreignObject</code> elements
                            as representing the occurrence of XHTML Content Document
                            fragments.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-svg-prop">It must regard the <olink
                                type="epub-spec" targetdoc="publications" targetptr="svg"/> property
                            of the <xref linkend="gloss-package-document"/>
                            <xref linkend="gloss-manifest"/>
                            <code>item</code> element as the authoritative definition of whether an
                            EPUB XHTML Content Document includes embedded SVG.</para>
                    </listitem>

                </itemizedlist>
            </section>
        </section>

        <section xml:id="sec-scripted-content">
            <title>Scripted Content Documents</title>

            <section xml:id="sec-scripted-inclusion">
                <title>Inclusion Models</title>
                <para><xref linkend="gloss-content-document-epub"/>s may contain scripting using the
                    facilities defined for this in the respective underlying specifications (<xref
                        linkend="refHTML5"/> and <xref linkend="refSVG"/>). When an EPUB Content
                    Document contains scripting, it is referred to in this specification and its
                        <link linkend="sibling-specs">sibling specifications</link> as a <xref
                        linkend="gloss-content-document-epub-scripted"/>. This label also applies to
                        <xref linkend="gloss-content-document-epub-xhtml"/>s when they contain
                    instances of <link xlink:href="http://www.w3.org/TR/html5/Overview.html#forms"
                        >HTML5 forms</link>.</para>

                <para xml:id="sec-scripted-content-models">In the context of <xref
                        linkend="gloss-content-document-epub-xhtml"/>s, this specification
                    distinguishes between two models of script inclusion:</para>

                <variablelist>
                    <varlistentry xml:id="sec-scripted-content-type-container-constrained"
                        xreflabel="container-constrained">
                        <term>container-constrained</term>
                        <listitem>
                            <para>In this model of scripting, the script execution is constrained to
                                the scope of a Content Document embedded in a parent Content
                                Document using one of the <xref linkend="refHTML5"/>
                                <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</link></code>, <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-iframe-element"
                                        >iframe</link></code> or <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-embed-element"
                                        >embed</link></code> elements. An executing script may have
                                read access to the DOM of its parent Content Document, but the
                                Reading System must not allow it to modify that DOM, nor other
                                content in the Publication. The script must not manipulate the size
                                of its containing rectangle.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="sec-scripted-content-type-spine-level"
                        xreflabel="spine-level">
                        <term>spine-level</term>
                        <listitem>
                            <para>In this model of scripting, the script execution scope is a <xref
                                    linkend="gloss-content-document-top-level"/>. There are no
                                restrictions on DOM access, but a Reading System may impose
                                restrictions on modifications (see also the <link
                                    linkend="feature-dom-manipulation">dom-manipulation
                                    feature</link>).</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>

            <section xml:id="sec-scripted-content-content-reqs"
                xreflabel="Scripted Content Documents — Content Conformance">
                <title>Content Conformance</title>

                <variablelist role="conformance-list">
                    <varlistentry>
                        <term>Accessibility</term>
                        <listitem>
                            <para xml:id="confreq-cd-scripted-pe">EPUB Content Documents that
                                include <xref linkend="sec-scripted-content-type-spine-level"/>
                                scripting must utilize the <emphasis>progressive enhancement
                                    technique</emphasis>: when the document is rendered by a Reading
                                System without scripting support or with scripting support disabled,
                                the <link linkend="gloss-content-document-top-level">top-level
                                    document content</link> must retain its integrity, remaining
                                consumable by the User without any information loss or other
                                significant deterioration.</para>
                            <para xml:id="confreq-cd-scripted-a11y">EPUB Content Documents that
                                include scripting — using any <link
                                    linkend="sec-scripted-content-models">inclusion model</link> —
                                should employ relevant accessibility techniques to ensure that the
                                content remains consumable by all Users. <xref linkend="refARIA"/>
                                <xref linkend="refWCAG20"/>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="confreq-cd-scripted-flbk"
                        xreflabel="Fallbacks for Scripted Content Documents">
                        <term>Fallbacks</term>
                        <listitem>
                            <!--
                            <para xml:id="confreq-cd-scripted-flbk-canvas">EPUB Content Documents
                                that include the HTML <code>canvas</code> element for scripting
                                purposes should include non-scripted fallback content using the
                                intrinsic model for fallback as defined by <code>canvas</code>
                                <xref linkend="refHTML5"/>.</para>
                            <para xml:id="confreq-cd-scripted-flbk-object">EPUB Content Documents
                                that include the HTML <code>object</code> element for scripting
                                purposes should include non-scripted fallback content using the
                                intrinsic model for fallback as defined by <code>object</code>
                                <xref linkend="refHTML5"/>.</para> -->
                            <para xml:id="confreq-cd-scripted-fallback">EPUB Content Documents that
                                include scripting — using any <link
                                    linkend="sec-scripted-content-models">inclusion model</link> —
                                may provide fallbacks for such content, either by using intrinsic
                                fallback mechanisms (such as those available for the <xref
                                    linkend="refHTML5"/>
                                <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-object-element"
                                        >object</link></code> and <code><link
                                        xlink:href="http://www.w3.org/TR/html5/Overview.html#the-canvas-element"
                                        >canvas</link></code> elements) or, when an intrinsic
                                fallback is not applicable, by using a <olink type="epub-spec"
                                    targetdoc="publications"
                                    targetptr="sec-fallback-processing-flow-manifest"
                                    >manifest-level</olink> fallback.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
                <note>
                    <para>The <property><olink type="epub-spec" targetdoc="publications"
                                targetptr="scripted"/></property> property of the <xref
                            linkend="gloss-manifest"/>
                        <code>item</code> element indicates that an EPUB Content Document is a <xref
                            linkend="gloss-content-document-epub-scripted"/>.</para>
                </note>
                <!-- TODO handler note -->
            </section>

            <section xml:id="sec-scripted-content-rs-reqs"
                xreflabel="Scripted Content Documents — Reading System Conformance">
                <title>Reading System Conformance</title>

                <para><xref linkend="gloss-epub-reading-system"/> support for scripting is optional.
                    A Reading System that supports scripting must meet the following
                    criteria:</para>

                <itemizedlist role="conformance-list">
                    <listitem>
                        <para xml:id="confreq-rs-scripted-support">It must support <xref
                                linkend="sec-scripted-content-type-container-constrained"/>
                            scripting and may support <xref
                                linkend="sec-scripted-content-type-spine-level"/> scripting.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-ua">It may render <xref
                                linkend="gloss-content-document-epub-scripted"/>s as an interactive,
                            scripted User Agent according to <xref linkend="refHTML5"/>.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-limit">It may place limitations on the
                            capabilities provided to scripts during execution (e.g., limiting
                            networking or DOM access).</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-readingsystem-object">It must implement
                            the JavaScript <code>navigator</code> extension object
                                <code>epubReadingSystem</code> defined in <xref
                                linkend="app-epubReadingSystem"/>. It also must support the
                                <code>dom-manipulation</code> and <code>layout-change</code>
                            features defined in <xref linkend="app-ers-hasFeature-features"/> in
                            container-constrained scripting contexts.</para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-rs-scripted-prop">It must regard the <code><olink
                                    type="epub-spec" targetdoc="publications" targetptr="scripted"
                                    >scripted</olink></code> property of the <xref
                                linkend="gloss-package-document"/>
                            <xref linkend="gloss-manifest"/>
                            <code>item</code> element as the authoritative definition of whether an
                            EPUB Content Document includes scripting.</para>
                    </listitem>
                </itemizedlist>

                <para>A Reading System that does not support scripting must meet the following
                    criteria:</para>

                <itemizedlist role="conformance-list">
                    <listitem>
                        <para xml:id="confreq-rs-scripted-flbk">It must process fallbacks for
                            scripted content as defined in <xref linkend="confreq-cd-scripted-flbk"
                            />.</para>
                    </listitem>
                </itemizedlist>

                <note>
                    <para>Reading Systems may render Scripted Content Documents in a manner that
                        disables other EPUB capabilities and/or provides a different rendering and
                        User experience (e.g., by disabling pagination).</para>

                    <para>Authors choosing to restrict the usage of scripting to the <xref
                            linkend="sec-scripted-content-type-container-constrained"/> model will
                        ensure a more consistent User experience between scripted and non-scripted
                        content (e.g., consistent pagination behavior).</para>

                    <para>Authors should use declarative techniques whenever practical to increase
                        the interoperability, longevity and accessibility of their Publications, and
                        avoid the inclusion of scripting whenever practical.</para>
                </note>
            </section>

            <section xml:id="sec-scripted-content-security">
                <title>Security Considerations</title>

                <para>All EPUB <xref linkend="gloss-author"/>s and Reading System developers need to
                    be aware of the security issues that arise when scripted content is executed by
                    a Reading System. As the underlying scripting model employed by Reading Systems
                    and browsers is the same, the same kinds of issues encountered in Web contexts
                    must be taken into consideration.</para>

                <para>Each Reading System should establish if the scripts in a particular document
                    are to be trusted or not. It is recommended that all scripts be treated as
                    untrusted (and potentially malicious), and that all vectors of attack be
                    examined and protected against. In particular, the following should be
                    considered:</para>

                <itemizedlist>
                    <listitem>
                        <para>an attack against the runtime environment (e.g., stealing files from a
                                <xref linkend="gloss-user"/>'s hard drive);</para>
                    </listitem>
                    <listitem>
                        <para>an attack against the Reading System itself (e.g., stealing a list of
                            a User's books or causing unexpected behavior);</para>
                    </listitem>
                    <listitem>
                        <para>an attack of one Content Document against another (e.g., stealing data
                            that originated in a different document);</para>
                    </listitem>
                    <listitem>
                        <para>an attack of an unencrypted script against an encrypted portion of a
                            document (e.g., an injected malicious script extracting protected
                            content);</para>
                    </listitem>
                    <listitem>
                        <para>an attack against the local network (e.g., stealing data from a server
                            behind a firewall).</para>
                    </listitem>
                </itemizedlist>

                <para>The following recommendations are provided as a guide to handling untrusted
                    scripts:</para>

                <itemizedlist>
                    <listitem>
                        <para>Reading Systems should behave as if a unique domain were allocated to
                            each Content Document, as browser-based security relies heavily on
                            document URLs and domains. Adopting this approach will isolate documents
                            from each other and from other Internet domains, thereby limiting access
                            to external URLs, cookies, DOM storage, etc.</para>
                        <para>Reading Systems that enable scripting and network access should also
                            consider including methods to notify the user that network activity is
                            occurring and/or that allow them to disable it.</para>
                        <note>
                            <para>In practice, Reading Systems may share domains across documents,
                                but they still should maintain isolation between documents.</para>
                            <para>If parts of a document are encrypted and parts are not, or if
                                different encryption keys are used for different parts of the
                                document, a unique per-document domain may not provide sufficient
                                protection.</para>
                        </note>
                    </listitem>
                    <listitem>
                        <para>If a Reading System allows persistent data to be stored, that data
                            should be treated as sensitive. Scripts may save persistent data through
                            cookies and DOM storage, but Reading Systems may block such attempts.
                            Reading Systems that do allow data to be stored must ensure that it is
                            not made available to other unrelated documents (e.g., ones that could
                            have been spoofed). In particular, checking for a matching document
                            identifier (or similar metadata) is not a valid method to control access
                            to persistent data.</para>
                        <para>Reading Systems that allow local storage should also provide methods
                            for Users to inspect, disable, or delete that data. The data should be
                            destroyed if the corresponding EPUB Publication is deleted.</para>
                    </listitem>
                </itemizedlist>

                <para>Note that compliance with these recommendations does not guarantee protection
                    from the possible attacks listed above; developers must examine each potential
                    vulnerability within the context of their Reading System.</para>
            </section>

            <section xml:id="sec-scripted-content-events">
                <title>Event Model Considerations</title>

                <para>Reading Systems should follow the DOM Event model as per <xref
                        linkend="refHTML5"/> and pass UI events to the scripting environment before
                    performing any default action associated with these events. Reading System
                    implementers should ensure that scripts cannot disable critical functionality
                    (such as navigation) to constrain the extent to which a <link
                        linkend="sec-scripted-content-events">potentially malicious</link> script
                    could impact their Reading Systems. As a result, although the scripting
                    environment should be able to cancel the default action of any event, some
                    events either may not be passed through or may not be cancelable.</para>

                <para><xref linkend="gloss-author"/>s should take into account the wide variety of
                    possible Reading System implementations when adding scripting functionality to
                    their Publications (e.g., not all devices have physical keyboard, and in many
                    cases a soft keyboard is only activated only for text input elements).
                    Consequently, relying on keyboard events alone is not recommended; alternative
                    ways to trigger the desired action should always be provided.</para>

            </section>

        </section>

    </chapter>

    <chapter xml:id="sec-css">
        <title>EPUB Style Sheets</title>

        <para>This section defines a profile for Cascading Style Sheets (CSS) intended to be used
            for styling of <xref linkend="gloss-content-document-epub-xhtml"/>s. An instance of a
            CSS Style Sheet that conforms to this profile is a <xref linkend="gloss-core-media-type"
            /> and is referred to in this specification and its <link linkend="sibling-specs"
                >sibling specifications</link> as an <link linkend="gloss-stylesheet">EPUB Style
                Sheet</link>.</para>

        <caution xml:id="caution-css">
            <para>The EPUB 3 CSS Profile references CSS specifications that are still works in
                progress and may change in incompatible ways. When utilizing features from such
                specifications, authors should consider the inherent risks in terms of the potential
                impact on interoperability and document longevity.</para>
        </caution>

        <note xml:id="note-css-unprefixed-authoring">
            <para>The EPUB 3 CSS Profile employs the usage of the <literal>-epub-</literal> prefix
                for a number of CSS3 <!-- keywords and --> property names, as detailed below. As the
                CSS3 modules that define these properties mature and stabilize, EPUB authoring
                guidelines may encourage authors to also include unprefixed equivalents of these
                properties in EPUB 3 Style Sheets.</para>
            <remark role="todo">TODO polish, link to
                http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords</remark>
        </note>

        <section xml:id="sec-css-content-conf" xreflabel="EPUB Style Sheets — Content Conformance">
            <title>Content Conformance</title>

            <para>A conformant <xref linkend="gloss-stylesheet"/> must meet all of the following
                criteria:</para>

            <itemizedlist role="conformance-list">
                <listitem xml:id="confreq-content-css-support">
                    <para>It must adhere to all content restrictions given in <xref
                            linkend="sec-css-profile"/>.</para>
                </listitem>
                <listitem xml:id="confreq-content-css-unsupport">
                    <para>It may include constructs not explicitly identified in the EPUB 3 CSS
                        Profile, but should be authored so that rendering fidelity does not depend
                        on such additional constructs.</para>
                </listitem>
                <listitem xml:id="confreq-content-css-encoding">
                    <para>It must be UTF-8 or UTF-16 encoded.</para>
                </listitem>
            </itemizedlist>

            <note xml:id="note-css-refprops-pkg">
                <!-- note similar statement for xhtml, svg and css-->
                <para>All <xref linkend="gloss-publication-resource-cmt-or-foreign"/>s referenced
                    from a CSS Style Sheet must conform to the constraints for Publication Resources
                    defined in <olink type="epub-spec" targetdoc="publications"
                        targetptr="sec-epub-content-conf"/></para>
            </note>

        </section>

        <section xml:id="sec-css-rs-conf" xreflabel="EPUB Style Sheets — Reading System Conformance">
            <title>Reading System Conformance</title>

            <itemizedlist role="conformance-list">
                <listitem xml:id="confreq-rs-css-support">
                    <para>Reading Systems with a <xref linkend="gloss-viewport-css"/> should support
                        — render as defined by the corresponding specification in the Viewport — all
                        CSS constructs included in this profile unless detailed otherwise in <xref
                            linkend="sec-css-profile"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-css-unsupport">Reading Systems may support additional
                        CSS constructs not explicitly identified in the EPUB 3 CSS Profile, and must
                        handle any unsupported constructs as <link
                            xlink:href="http://www.w3.org/TR/CSS21/conform.html#ignore"
                            >defined</link> in <xref linkend="refCSS21"/>. </para>
                </listitem>
            </itemizedlist>
            <note xml:id="note-rs-css-support">
                <para>Reading Systems have varying capabilities with regards to CSS rendering
                    support, so may ignore some or all style information of an EPUB Style Sheet.</para>
                <para>In addition, even when a Reading System does have a <xref
                        linkend="gloss-viewport-css"/>, it is likely to render content in a manner that
                    differs from typical HTML5 User Agents (e.g., paginating content rather than
                    providing a infinitely scrolling surface). </para>
            </note>
        </section>

        <section xml:id="sec-css-profile">
            <title>EPUB 3 CSS Profile</title>

            <section xml:id="sec-css-2.1">
                <title>CSS 2.1</title>

                <para>The style baseline of the EPUB 3 CSS Profile is Cascading Style Sheets Level 2
                    Revision 1 <xref linkend="refCSS21"/>. The profile includes all style sheet
                    constructs normatively defined in <xref linkend="refCSS21"/>, with the following
                    exceptions:</para>

                <itemizedlist>
                    <listitem>
                        <para>The <literal>fixed</literal> value of the
                                <property>position</property> property is not part of the EPUB 3 CSS
                            Profile. To avoid potential rendering and interoperability issues, it
                            should not be included in an EPUB Style Sheet.</para>
                    </listitem>
                    <listitem>
                        <para>The <property>direction</property> and
                                <property>unicode-bidi</property> properties must not be included in
                            an EPUB Style Sheet. Authors should use appropriate <xref
                                linkend="refHTML5"/> markup to express directionality information
                            instead. </para>
                    </listitem>
                </itemizedlist>

                <para>Reading Systems that have a <xref linkend="gloss-viewport-css"/> must support
                    the <property>font-family</property> property.</para>

                <note>
                    <para>The ability of Reading Systems to paginate absolutely positioned layouts
                        is not guaranteed, so reliance on absolute positioning is discouraged.
                        Reading Systems may not support these property values.</para>
                </note>
            </section>
            <section xml:id="sec-css-2.0-list-style-type">
                <title>CSS 2.0</title>
                <para>The EPUB 3 CSS Profile includes the following values for the
                        <property>list-style-type</property> property as <link
                        xlink:href="http://www.w3.org/TR/2008/REC-CSS2-20080411/generate.html#lists"
                        >defined in</link>
                    <xref linkend="refCSS20"/>:</para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <literal>cjk-ideographic</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>hebrew</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>hiragana</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>hiragana-iroha</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>katakana</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>katakana-iroha</literal>
                        </para>
                    </listitem>
                </itemizedlist>
                <!--
                <para>Additional details on these list styles can be found in <xref
                        linkend="refCSS3Lists"/>. <remark role="todo">The definitions in CSS3 Lists
                        are incorrect, so remove this paragraph if an updated WD has not yet been
                        published.</remark>
                </para>
                -->
            </section>
            <section xml:id="sec-css-voice-characteristics">
                <title>CSS 3.0 Speech</title>
                <!-- TODO note the difference in inclusion <para>The EPUB 3 CSS Profile includes all features defined in the CSS 3.0 Speech
                    Module <xref linkend="refCSS3Speech"/>. Reading Systems with <xref
                        linkend="gloss-tts"/> capabilities should support the following
                        properties:</para> -->
                <para>The EPUB 3 CSS Profile includes <literal>-epub-</literal> prefixed versions of
                    the following properties from the CSS3 Speech Module <xref
                        linkend="refCSS3Speech"/> using syntax as defined in <xref
                        linkend="refCSS3Speech-dated"/> and semantics as defined in <xref
                        linkend="refCSS3Speech"/>:</para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <literal>-epub-cue</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>-epub-pause</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>-epub-rest</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>-epub-speak</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>-epub-speakability</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal>-epub-voice-family</literal>
                        </para>
                    </listitem>
                </itemizedlist>
                <xi:include href="./share/note-tts-features.xml"/>
            </section>
            <section xml:id="sec-css-fonts">
                <title>CSS Fonts Level 3</title>
                <!-- jdaggett, editor of CSS3 Fonts, believes the below-referenced @font-face portion of
                 CSS3 Fonts to be stable. Other parts of the CSS3 Fonts spec are not yet stable.
                 2011-01-11 -->

                <para>The EPUB 3 CSS Profile includes <literal>@font-face</literal> rules and
                    descriptors as defined in the CSS Fonts Module Level 3 <xref
                        linkend="refCSS3FontsModule"/> specification, using syntax as defined in
                        <xref linkend="refCSS3FontsModule-dated"/> and semantics as defined in <xref
                        linkend="refCSS3FontsModule"/>. </para>

                <para xml:id="confreq-rs-embedded-font-types">Reading Systems with a <xref
                        linkend="gloss-viewport-css"/> must support OpenType <xref
                        linkend="refOpenType"/> and WOFF <xref linkend="refWOFF"/> fonts embedded
                    using the <literal>@font-face</literal> rule.</para>

                <note>
                    <para>Refer to <olink type="epub-spec"
                            targetptr="confreq-resources-font-fallback" targetdoc="publications"/>
                        for font fallback processing requirements. </para>
                </note>

                <para>In addition, Reading Systems must support at least the following
                        <literal>@font-face</literal> font descriptors. <!-- using
                        <literal>-epub-</literal> prefixed property names,
                        syntax as defined in <xref
                        linkend="refCSS3FontsModule-dated"/> and semantics -->
                    <!-- as
                    defined in <xref linkend="refCSS3FontsModule-dated"/>.--></para>

                <itemizedlist>
                    <!-- Got rid of font-size, as instructred by John Daggett. -->
                    <!-- Got rid of font-variant, as instructed by John Daggett.  -->
                    <listitem>
                        <para>
                            <literal><!--epub-->font-family</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal><!--epub-->font-style</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal><!--epub-->font-weight</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal><!--epub-->src</literal>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <literal><!--epub-->unicode-range</literal>
                        </para>
                    </listitem>
                </itemizedlist>

                <para>For forwards compatibility with EPUB 2 Reading Systems that do not support
                        <link linkend="sec-css-fonts"><literal>@font-face</literal> rules</link>,
                    authors should reference a generic font using the
                        <property>font-family</property> property.</para>

                <note>
                    <para>Refer to <olink type="epub-spec" targetdoc="ocf" targetptr="font-obfuscation"/>
                        for Reading System font obfuscation requirements.
                    </para>
                </note>

            </section>
            <section xml:id="sec-css-text">
                <title>CSS Text Level 3</title>

                <para>The EPUB 3 CSS Profile includes <literal>-epub-</literal> prefixed versions of
                    the following properties from the CSS Text Level 3 <xref linkend="refCSS3Text"/>
                    specification using syntax as defined in <xref linkend="refCSS3Text-dated"/> and
                    semantics as defined in <xref linkend="refCSS3Text"/>.</para>

                <itemizedlist>
                    <listitem>
                        <para>
                            <property>-epub-hyphens</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property>-epub-line-break</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property>-epub-text-align-last</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property>-epub-text-emphasis</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property>-epub-text-emphasis-color</property>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <property>-epub-text-emphasis-style</property>
                        </para>
                    </listitem>
                    <!-- <listitem>
                        <para>
                            <property>-epub-text-transform</property>
                        </para>
                    </listitem> -->
                    <listitem>
                        <para>
                            <property>-epub-word-break</property>
                        </para>
                    </listitem>
                </itemizedlist>

                <para>In addition, the EPUB 3 CSS Profile includes the unprefixed
                        <property>text-transform</property> property from CSS Text Level 3 using
                    semantics as defined in <xref linkend="refCSS3Text"/> and syntax as defined in
                        <xref linkend="refCSS3Text-dated"/>, with the exception that the
                        <literal>fullwidth</literal> and <literal>fullsize-kana</literal> values are
                    prefixed in the EPUB 3 CSS Profile (<literal>-epub-fullwidth</literal> and
                        <literal>-epub-fullsize-kana</literal>, respectively). </para>

            </section>
            <section xml:id="sec-css-writing-modes">
                <title>CSS Writing Modes</title>
                <para>With exceptions for the <property>direction</property> and
                        <property>unicode-bidi</property> properties <link
                        linkend="css-writing-modes-excl">as noted below</link>, the EPUB 3 CSS
                    Profile includes all of the features defined in the CSS Writing Modes Module
                    Level 3 <xref linkend="refCSS3WritingModesModule"/> specification using
                        <literal>-epub-</literal> prefixed property names, syntax as defined in
                        <xref linkend="refCSS3WritingModesModule-dated"/> and semantics as defined
                    in <xref linkend="refCSS3WritingModesModule"/>.</para>

                <para xml:id="css-writing-modes-excl">The <property>direction</property> and
                        <property>unicode-bidi</property> properties from <xref
                        linkend="refCSS3WritingModesModule"/> are not included in the EPUB 3 CSS
                    Profile. Authors should use appropriate <xref linkend="refHTML5"/> markup to
                    express directionality information instead.</para>
            </section>
            <section xml:id="sec-css-media-queries">
                <!-- CR as of July 2010 -->
                <title>Media Queries</title>
                <para>The EPUB 3 CSS Profile includes <literal>@media</literal>
                    <!-- As instructed by Fantasai, @import is added. --> and
                        <literal>@import</literal> rules with media queries as defined in the Media
                    Queries <xref linkend="refMediaQueries"/> specification.</para>
            </section>
            <section xml:id="sec-css-namespaces">
                <!-- CR as of May 2008 -->
                <title>CSS Namespaces</title>

                <para>The EPUB 3 CSS Profile includes the <code>@namespace</code> rule defined in
                        <xref linkend="refCSSNamespacesModule"/> for declaring the default namespace
                    for a style sheet and for binding prefixes to namespaces.</para>
            </section>
            <section xml:id="sec-css-multi-column">
                <!-- CR as of April 2011 -->
                <title>CSS Multi-Column Layout</title>
                <para>The EPUB 3 CSS Profile includes all of the features defined in the CSS
                    Multi-column Layout Module <xref linkend="refCSS3Multicol"/> specification with
                    the exception of the <property>column-span</property> property. </para>
                <caution>
                    <para>Authors should not rely on column behavior in overflow conditions as this
                        behavior is unstable and may change.</para>
                </caution>
                <caution>
                    <para>Pagination algorithms are not fully defined in CSS. Authors should
                        therefore expect exact pagination points to vary from Reading System to
                        Reading System.</para>
                </caution>
                <para>Reading Systems must treat the <property>oeb-column-number</property> property
                    as an alias for the <property>column-count</property> property. The use of the
                        <property>oeb-column-number</property> property in EPUB Style Sheets is
                    deprecated; this conformance requirement may be removed in the next major
                    version of EPUB.</para>
            </section>
            <section xml:id="sec-css-ruby-position">
                <title>Ruby Positioning</title>
                <!-- both syntax and semantics locally defined -->
                <para>The EPUB 3 CSS Profile includes the <property>-epub-ruby-position</property>
                    property as defined below:</para>

                <informaltable>
                    <thead>
                        <tr>
                            <td>Name:</td>
                            <td>-epub-ruby-position</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Value:</td>
                            <td><literal>over</literal> | <literal>under</literal> |
                                    <literal>inter-character</literal>
                            </td>
                        </tr>
                        <tr>
                            <td>Initial:</td>
                            <td>over</td>
                        </tr>
                        <tr>
                            <td>Applies to:</td>
                            <td>ruby text elements</td>
                        </tr>
                        <tr>
                            <td>Inherited:</td>
                            <td>yes</td>
                        </tr>
                        <tr>
                            <td>Percentages:</td>
                            <td>N/A</td>
                        </tr>
                        <tr>
                            <td>Media:</td>
                            <td>visual</td>
                        </tr>
                        <tr>
                            <td>Computed value:</td>
                            <td>as specified</td>
                        </tr>
                    </tbody>
                </informaltable>

                <para>This property controls the placement of ruby text with respect to its base
                    text. Values have the following meanings:</para>

                <variablelist>
                    <varlistentry>
                        <term>
                            <literal>over</literal>
                        </term>
                        <listitem>
                            <para>Ruby text is positioned on the <link
                                    xlink:href="http://www.w3.org/TR/css3-writing-modes/#over"
                                    >over</link> side of the ruby base.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>
                            <literal>under</literal>
                        </term>
                        <listitem>
                            <para>Ruby text is positioned on the <link
                                    xlink:href="http://www.w3.org/TR/css3-writing-modes/#under"
                                    >under</link> side of the ruby base.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>
                            <literal>inter-character</literal>
                        </term>
                        <listitem>
                            <para>Ruby text is positioned on the right side of the base text. (This
                                value is typically used for Zhuyin Fuhao (Bopomofo) ruby.)</para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <note>
                    <para>The <property>-epub-ruby-position</property> property will become an alias
                        for the <property>ruby-position</property> property in the CSS Ruby Module
                            <xref linkend="refCSS3Ruby"/>.</para>
                </note>
            </section>
            <section xml:id="sec-css-oeb-head-foot">
                <title>Display Property Values <code>oeb-page-head</code> and
                        <code>oeb-page-foot</code></title>
                <para>In addition to the standard values defined for the <code>display</code>
                    property in <link
                        xlink:href="http://www.w3.org/TR/CSS2/visuren.html#display-prop">Section
                        9.2.4</link> of <xref linkend="refCSS21"/>, EPUB Style Sheets may specify
                    the values <literal>oeb-page-head</literal> and
                    <literal>oeb-page-foot</literal>. </para>
                <para>Reading Systems should present the content of an element assigned
                        <code>display: oeb-page-head</code> only as a header, and the content of an
                    element assigned <code>display: oeb-page-foot</code> only as a footer. Neither
                    should be presented simply as if it were <code>inline</code> or
                        <code>block</code>. The way Reading Systems present headers and footers is
                    not defined by this specification (e.g., they may render them in
                    fixed positions as per print layouts or pop them up on demand if only limited
                    screen space is available). </para>
                <para>For the purposes of page layout, these display values are similar to block
                    boxes with an absolute position (i.e., a position value of
                        <property>fixed</property> or <property>absolute</property>). That is, they
                    are removed from the normal flow and a new block box is created with its own
                    flow. Margins, padding, and other block characteristics are determined as if the
                    element had <code>position: fixed</code> set. </para>

                <para>An element assigned <code>display: oeb-page-head</code> or <code>display:
                        oeb-page-foot</code> must not be considered in effect while any markup
                    specified before such an element is still being rendered in the same context
                    (for example, if it is on the same page in a paginated context, or in the
                    viewport for a scrolled context). Once in effect, the element must remain in
                    effect until either of the following conditions is true:</para>

                <itemizedlist>
                    <listitem>
                        <para>another header or footer (respectively) is in effect instead;
                            or</para>
                    </listitem>
                    <listitem>
                        <para>no part of its parent element remains presented.</para>
                    </listitem>
                </itemizedlist>

                <para>For example, when rendered to a screen with appropriate style settings, the
                        <property>myhead</property>-classed <code>div</code> element in the
                    following example would become the page header as soon as nothing preceding the
                    containing <code>div</code> is displayed, and go out of effect when that
                        <code>div</code> is no longer visible:</para>

                <informalexample xml:id="example-css-header">
                    <synopsis><![CDATA[
 <div>
   <div class="myhead" style="display: none; display: oeb-page-head">
      The OEB Publication Structure: Introduction
   </div>
   <h2>Introduction</h2>
   <p>…</p>
</div>]]></synopsis>
                </informalexample>

                <note>
                    <para>The <code>display</code> property has its value set to
                            <literal>none</literal> in the preceding example before setting it to
                            <code>oeb-page-head</code> to ensure that Reading Systems that do not
                        support this feature do not display the content. This approach is
                        recommended whenever setting the <literal>oeb-page-head</literal> or
                            <literal>oeb-page-foot</literal> values.</para>
                </note>
            </section>
        </section>

    </chapter>

    <chapter xml:id="sec-pls">
        <title>PLS Documents</title>

        <section xml:id="sec-pls-overview" conformance="informative">
            <title>Overview</title>

            <para>The W3C Pronunciation Lexicon Specification <xref linkend="refPLS"/> defines
                syntax and semantics for XML-based pronunciation lexicons to be used by Automatic
                Speech Recognition and <xref linkend="gloss-tts"/> engines.</para>

            <para>The following sections define conformance criteria for PLS documents when included
                in <xref linkend="gloss-epub-publication"/>s, and rules for associating PLS
                Documents with <xref linkend="gloss-content-document-epub-xhtml"/>s. </para>

            <xi:include href="./share/note-tts-features.xml"/>

        </section>

        <section xml:id="sec-pls-conf-pub">
            <title>EPUB Publication Conformance</title>

            <para>A conformant <xref linkend="gloss-epub-publication"/> must meet all of the
                following criteria for inclusion of PLS Documents:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-cd-pls-xht">PLS Documents may be associated with <xref
                            linkend="gloss-content-document-epub-xhtml"/>s. Each XHTML Content
                        Document may contain zero or more PLS Document associations. </para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-cd-pls-assoc">PLS Documents must be associated with the
                            <xref linkend="gloss-content-document-epub-xhtml"/> to which it applies
                        using the <xref linkend="refHTML5"/>
                        <code xlink:href="http://www.w3.org/TR/html5/Overview.html#the-link-element"
                            >link</code> element with its <code>rel</code> attribute set to
                            <literal>pronunciation</literal> and its <code>type</code> attribute set
                        to the <olink type="epub-spec" epub:specref-exclude="true"
                            targetdoc="publications" targetptr="cmt-pls">PLS media type</olink>
                            (<literal>application/pls+xml</literal>).</para>
                    <para xml:id="confreq-cd-pls-assoc-lang">The <code>link</code> element
                            <code>hreflang</code> attribute should be specified on each PLS
                            <code>link</code>, and its value must match <link
                            xlink:href="http://www.w3.org/TR/pronunciation-lexicon/#S4.1">the
                            language for which the pronunciation lexicon is relevant</link>
                        <xref linkend="refPLS"/> when specified.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-pls-pub-cont">PLS Documents must meet the content
                        conformance criteria defined in <xref linkend="sec-pls-conf-content"
                        />.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-pls-pub-manif">PLS Documents must be represented and
                        located as defined in <olink type="epub-spec" targetdoc="publications"
                            targetptr="sec-epub-content-conf"/>.</para>
                </listitem>
            </itemizedlist>

            <bridgehead>Examples</bridgehead>
            <informalexample>
                <para>The following example shows two PLS Documents (one for Chinese and one for
                    Mongolian) associated with an XHTML Content Document.</para>
                <synopsis>
<xi:include href="./examples/contentdocs/pls-assoc-1.xml" parse="text"/></synopsis>
            </informalexample>

        </section>

        <section xml:id="sec-pls-conf-content" xreflabel="PLS Documents — Content Conformance">
            <title>Content Conformance</title>

            <para>To be considered a <xref linkend="gloss-publication-resource-cmt"/>, a PLS
                Document must meet all of the following criteria:</para>

            <variablelist role="conformance-list" xml:id="confreq-cd-pls">
                <varlistentry xml:id="confreq-cd-pls-docprops">
                    <term>Document Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-pls-xml">
                            <xi:include href="./share/xml-defref.xml"/>
                        </para>
                        <para xml:id="confreq-cd-pls-docprops-schema">It must be valid to the RELAX
                            NG schema for PLS documents available at the URI <link
                                xlink:href="http://www.w3.org/TR/pronunciation-lexicon/pls.rng"
                                >http://www.w3.org/TR/pronunciation-lexicon/pls.rng</link>
                            <xref linkend="refPLS"/>. </para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="confreq-cd-pls-fileprops">
                    <term>File Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-pls-fileprops-name">The PLS Document filename
                            should use the file extension <filename>.pls</filename>.</para>
                    </listitem>
                </varlistentry>
            </variablelist>

        </section>

        <section xml:id="sec-pls-conf-rs" xreflabel="PLS Documents — Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <xref linkend="gloss-epub-reading-system"/> must meet all of the
                following criteria for processing PLS Documents:</para>

            <itemizedlist role="conformance-list" xml:id="pls-rs-confreqs">
                <listitem>
                    <para xml:id="confreq-pls-rs-sptts">Reading Systems with <xref
                            linkend="gloss-tts"/> capabilities should support PLS.</para>
                    <para xml:id="confreq-pls-rs-proc">Reading Systems that support PLS must process
                        PLS documents as defined in <xref linkend="refPLS"/>.</para>
                    <para xml:id="confreq-pls-rs-scope">Reading Systems that support PLS must apply
                        the supplied pronunciation instructions to all text nodes in the current
                        XHTML Content Document whose <link
                            xlink:href="http://www.w3.org/TR/html5/Overview.html#the-lang-and-xml:lang-attributes"
                            >language</link>
                        <xref linkend="refHTML5"/> matches <link
                            xlink:href="http://www.w3.org/TR/pronunciation-lexicon/#S4.1">the
                            language for which the pronunciation lexicon is relevant</link>
                        <xref linkend="refPLS"/>. The algorithm for matching language tags is
                        defined in <link linkend="refRFC5646">BCP47</link>.</para>
                    <para xml:id="confreq-pls-rs-multi"> When a pronunciation rule is specified more
                        than once for a given string target in a given language, the last occurrence
                        of the rule takes precedence, in such a way that any previously-defined
                        pronunciation rule gets overridden. </para>
                    <para xml:id="confreq-pls-rs-casc">Reading Systems that support PLS and the
                            <link linkend="sec-xhtml-ssml-attrib">SSML Attributes</link> must let
                        any pronunciation instructions provided via the <link
                            linkend="sec-cd-ssml-ph-attrib"><code>ssml:ph</code> attribute</link>
                        take precedence in cases where a <code>pls:grapheme</code> matches a text
                        node of an element that carries the <code>ssml:ph</code> attribute.</para>
                </listitem>
            </itemizedlist>
        </section>

    </chapter>

    <appendix xml:id="app-schemas">
        <title>Schemas</title>

        <para>The schemas in this Appendix are normative. <!-- In case of conflicts between the
            specification prose and the given schema, the schema shall be considered
            definitive. --> </para>

        <xi:include href="./share/schemas-not-done.xml"/>

        <note>
            <para>Validation using these schemas will require a processor that supports <xref
                    linkend="refNVDL"/>, <xref linkend="refRelaxNG"/> and <xref
                    linkend="refISOSchematron"/>.</para>
            <para>Note, however, that the NVDL schema layer can be substituted by a multi-pass
                validation using the embedded RELAX NG and ISO Schematron schemas alone.</para>
        </note>

        <section xml:id="app-xhtml-schema">
            <title>XHTML Content Document Schema</title>
            <para>The schema for XHTML Content Documents is available at <link
                    xlink:href="../schema/epub-xhtml-30.nvdl"
                    >http://www.idpf.org/epub/30/schema/epub-xhtml-30.nvdl</link>.</para>
        </section>

        <section xml:id="app-xhtml-nav-schema">
            <title>EPUB Navigation Document Schema</title>
            <para>The schema for EPUB Navigation Documents is available at <link
                    xlink:href="../schema/epub-nav-30.nvdl"
                    >http://www.idpf.org/epub/30/schema/epub-nav-30.nvdl</link>.</para>

        </section>

        <section xml:id="app-svg-schema">
            <title>SVG Content Document Schema</title>

            <para>The schema for SVG Content Documents is available at <link
                    xlink:href="../schema/epub-svg-30.nvdl"
                    >http://www.idpf.org/epub/30/schema/epub-svg-30.nvdl</link>.</para>

        </section>

    </appendix>
    
    <appendix xml:id="app-epubReadingSystem">
        <title>JavaScript epubReadingSystem Object</title>

        <section xml:id="app-ers-syntax">
            <title>Syntax</title>

            <para role="syntax"><emphasis>ReadingSystem</emphasis> =
                navigator.epubReadingSystem;</para>

        </section>

        <section xml:id="app-ers-desc">
            <title>Description</title>

            <para>The <code>epubReadingSystem</code> object provides an interface through which a
                    <xref linkend="gloss-content-document-epub-scripted"/> can query information
                about a <xref linkend="gloss-user"/>'s <link linkend="gloss-epub-reading-system"
                    >Reading System</link>.</para>

            <para>The object exposes a number of <link linkend="app-ers-properties"
                    >properties</link>, about the Reading System, such as its name and version, and
                provides the <link linkend="app-ers-hasFeature">hasFeature</link> method which can
                be invoked to determine the features it supports.</para>

            <informalexample>
                <para>Example JavaScript function that displays the name of the current Reading
                    System.</para>
                <synopsis>alert("Reading System name: " + navigator.epubReadingSystem.name);</synopsis>
            </informalexample>
        </section>

        <section xml:id="app-ers-properties">
            <title>Properties</title>

            <para>The following properties must be made available for retrieving information about
                the Reading System.</para>

            <table xml:id="tbl-epubReadingSystem-properties">
                <caption>Required epubReadingSystem properties</caption>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><literal>name</literal></td>
                        <td>Returns a <literal>String</literal> value representing the name of the
                            Reading System (e.g., <literal>iBooks</literal>,
                                <literal>Kindle</literal>).</td>
                    </tr>
                    <tr>
                        <td><literal>version</literal></td>
                        <td>Returns a <literal>String</literal> value representing the version of
                            the Reading System (e.g., <literal>1.0</literal>,
                                <literal>2.1.1</literal>).</td>
                    </tr>
                    <tr>
                        <td><literal>layoutStyle</literal></td>
                        <td><para>Returns a <literal>String</literal> value representing the style
                                of layout for the content.</para>
                            <para>A Reading System will typically return one of the values
                                    <literal>paginated</literal> or <literal>scrolling</literal>,
                                but may define values for any additional layout formats it
                                supports.</para></td>
                    </tr>
                </tbody>
            </table>
        </section>


        <section xml:id="app-ers-methods">
            <title>Methods</title>

            <section xml:id="app-ers-hasFeature">
                <title>hasFeature</title>

                <section xml:id="app-ers-hasFeature-syntax">
                    <title>Syntax</title>

                    <para role="syntax">hasFeature(feature[, version])</para>
                </section>

                <section xml:id="app-ers-hasFeature-desc">
                    <title>Description</title>
                    <para>For recognized features, the <code>hasFeature</code> method returns a
                        boolean value indicating whether any version is supported.</para>
                    <para>If the optional <code>version</code> parameter is included, the return
                        value indicates support only for the specified version.</para>
                    <para>The method returns <literal>undefined</literal> if the feature is not
                        recognized by the Reading System.</para>

                    <informalexample>
                        <para>Example JavaScript function that displays whether the current Reading
                            System supports scripted manipulation of the DOM.</para>
                        <synopsis>var feature = "dom-manipulation";

var conformTest = navigator.epubReadingSystem.hasFeature(feature);

alert("Feature " + feature + " supported?: " + conformTest);</synopsis>
                    </informalexample>
                </section>

                <section xml:id="app-ers-hasFeature-features">
                    <title>Features</title>

                    <para>The following table details the features that must be recognized by all
                        Reading Systems that support scripting (<link
                            linkend="sec-scripted-inclusion">spine-level</link> or <link
                            linkend="sec-scripted-inclusion">container-constrained</link>). Reading
                        Systems may support some or all of these features (refer to <xref
                            linkend="sec-scripted-content-rs-reqs"/> for more information).</para>

                    <para>Feature names are case-insensitive.</para>

                    <table xml:id="tbl-epubReadingSystem-features">
                        <caption>Required epubReadingSystem features</caption>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td xml:id="feature-dom-manipulation"
                                        ><literal>dom-manipulation</literal></td>
                                <td>Scripts may make structural changes to the document’s DOM
                                    (applies to spine-level scripting only).</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-layout-changes"
                                        ><literal>layout-changes</literal></td>
                                <td>Scripts may modify attributes and CSS styles that affect content
                                    layout (applies to spine-level scripting only).</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-touch-events"
                                    ><literal>touch-events</literal></td>
                                <td>The device supports touch events and the Reading System passes
                                    touch events to the content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-mouse-events"
                                    ><literal>mouse-events</literal></td>
                                <td>The device supports mouse events and the Reading System passes
                                    mouse events to the content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-keyboard-events"
                                        ><literal>keyboard-events</literal></td>
                                <td>The device supports keyboard events and the Reading System
                                    passes keyboard events to the content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-spine-scripting"
                                        ><literal>spine-scripting</literal></td>
                                <td>Spine-level scripting is supported.</td>
                            </tr>
                        </tbody>
                    </table>

                    <para>If a Reading System supports a feature defined in this section, it must
                        return a <literal>true</literal> value both when queried without the version
                        parameter set and when that parameter is set to the value
                            <literal>1.0</literal>. Otherwise, it must return false. Reading System
                        developers should not change the version number of these features
                        independently of this specification.</para>

                    <para>Additional features may be added by Reading System developers, but future
                        versions of this specification may append to this list in ways that may
                        conflict or be incompatible with any such custom additions.</para>
                </section>
            </section>
        </section>
    </appendix>

    <xi:include href="./share/contributors.xml"/>

    <xi:include href="./share/references.xml"/>

    <appendix xml:id="DUMMY_REMOVE">
        <!-- a dummy that is removed by the build -->
        <title>THIS SECTION SHOULD NOT BE IN THE BUILD</title>
        <para xml:id="physical-container-zip"/>
        <para xml:id="sec-package-documents"/>
        <para xml:id="sec-core-media-types"/>
        <para xml:id="sec-spine-elem"/>
        <para xml:id="sec-manifest-elem"/>
        <para xml:id="sec-fallback-processing-flow"/>
        <para xml:id="sec-xml-constraints"/>
        <para xml:id="sec-link-elem"/>
        <para xml:id="sec-opf-metadata-identifiers-pid"/>
        <para xml:id="sec-resource-locations"/>
        <para xml:id="confreq-spine-itemtypes"/>
        <para xml:id="sec-publication-resources"/>
    </appendix>

</book>
