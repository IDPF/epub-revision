Changes since the 1.75.2 release

Note: This document lists changes only since the 1.75.2 release. If you instead
want a record of the complete list of changes for the codebase over its entire
history, you can obtain one by running the following commands:

  svn checkout https://docbook.svn.sourceforge.net/svnroot/docbook/trunk/xsl
  svn log --xml --verbose xsl > ChangeHistory.xml

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Table of Contents

Release Notes: 1.76.0

    Gentext
    Common
    FO
    HTML
    Manpages
    Epub
    Eclipse
    Params
    XSL-Xalan

Release Notes: 1.76.0

The following is a list of changes that have been made since the 1.75.2
release.

Gentext

The following changes have been made to the gentext code since the 1.75.2
release.

  ● dleidert: locale/fr.xml

    Commit update to French localization by David Prévot (sf.net bug #3054632, Debian #594649).

  ● rlandmann: locale/fa.xml

    Update to Persian translation from the Fedora Project

  ● rlandmann: locale/bn_IN.xml; locale/bn_in.xml

    fix my capitalization mistake

  ● rlandmann: Makefile

    Update localization sources

  ● rlandmann: locale/nds.xml

    Locale for Low German

  ● Mauritz Jeanson: locale/hu.xml

    Removed duplicate htmlhelp context.

  ● Mauritz Jeanson: locale/ka.xml; Makefile

    Added support for Georgian based on patch #2917147.

  ● rlandmann: locale/nl.xml; locale/ja.xml

    Updated translations from Red Hat and the Fedora Project

  ● rlandmann: locale/bs.xml; locale/ru.xml; locale/hr.xml

    Updated locales from Red Hat and the Fedora Project

  ● rlandmann: locale/pt.xml; locale/cs.xml; locale/es.xml; locale/bg.xml;
    locale/nl.xml; loca⋯

    Updated translations from Red Hat and the Fedora Project

  ● rlandmann: Makefile

    Add new languages to Makefile

  ● rlandmann: locale/as.xml; locale/bn_IN.xml; locale/ast.xml; locale/ml.xml;
    locale/te.xml; ⋯

    New translations from Red Hat and the Fedora Project

  ● rlandmann: locale/pt.xml; locale/ca.xml; locale/da.xml; locale/sr.xml;
    locale/ru.xml; loca⋯

    Updated translations from Red Hat and the Fedora Project

  ● rlandmann: locale/zh.xml; locale/ca.xml; locale/ru.xml; locale/ga.xml;
    locale/gl.xml; loca⋯

    remove unused <nonexistantelement>

  ● dleidert: locale/de.xml

    Fix an incorrect translation. Thanks to Helge Kreutzmann.
    http://bugs.debian.org/562816

  ● Mauritz Jeanson: locale/it.xml

    Applied patch #2813221.

  ● Keith Fahlgren: Makefile

    Add Icelandic

Common

The following changes have been made to the common code since the 1.75.2
release.

  ● rlandmann: l10n.xml; Makefile

    fix my capitalization mistake

  ● David Cramer: l10n.xml; Makefile

    Changing bn_in.xml to bn_IN.xml to match what's in svn

  ● rlandmann: l10n.xml; Makefile

    Update localization sources

  ● Mauritz Jeanson: common.xsl

    Fixed bug in output-orderedlist-starting-number template (@startingnumber did not work for FO).

  ● Mauritz Jeanson: pi.xsl

    Moved warning.

  ● Mauritz Jeanson: pi.xsl

    Removed obsolete reference to DBTeXMath.

  ● Mauritz Jeanson: gentext.xsl

    Added fix to catch ID also of descendants of listitem. Closes bug #2955077.

  ● Jirka Kosek: l10n.xsl

    Stripped down, faster version of gentext.template is used when there is no localization customization.

  ● Jirka Kosek: l10n.xsl; autoidx-kosek.xsl

    Hopefully this way code will work in Xalan and without speed penalty.

  ● Mauritz Jeanson: Makefile

    Removed unused XJPARSEFLAGS.

  ● Mauritz Jeanson: l10n.xml; Makefile

    Added support for Georgian based on patch #2917147.

  ● Jirka Kosek: l10n.xsl

    Another small speed improvement

  ● Jirka Kosek: l10n.xsl; autoidx-kosek.xsl

    Workaround bug in Xalan-J. Path to locale files is written in a way it produces same absolute URI whether base URI is in .../common or .../html or .../fo directory.

  ● Robert Stayton: autoidx-kimber.xsl

    Change entities to use common/entities.ent.

  ● Mauritz Jeanson: stripns.xsl

    Added fix that preserves link/@role (makes links in the reference documentation
    with @role="tcg" work).

  ● Mauritz Jeanson: l10n.xsl

    Fixed bugs related to manpages and L10n.

  ● Jirka Kosek: l10n.xml

    Removed typo

  ● Jirka Kosek: entities.ent; autoidx-kosek.xsl

    Upgraded to use common entities. Fixed bug when some code used @sortas and some not for grouping/sorting of indexterms.

  ● Jirka Kosek: l10n.xsl; l10n.dtd; l10n.xml; autoidx-kosek.xsl

    Refactored localization support. Language files are loaded on demand. Speedup is about 30%.

  ● Jirka Kosek: l10n.xsl

    Added xsl:keys for improved performance of localization texts look up. Performance gain around 15%.

  ● Mauritz Jeanson: titles.xsl

    Fixed bug #2912677 (error with xref in title).

  ● Robert Stayton: olink.xsl

    Fix bug in xrefstyle "title" handling introduced with
    the 'insert.targetdb.data' template.

  ● Robert Stayton: gentext.xsl

    Fix bug in xref to equation without title to use context="xref-number" instead
    of "xref-number-and-title".

  ● Robert Stayton: labels.xsl

    Number all equations in one sequence, with or without title.

  ● Robert Stayton: entities.ent

    Fix bug #2896909 where duplicate @sortas on indexterms caused
    some indexterms to drop out of index.

  ● Robert Stayton: stripns.xsl

    Expand the "Stripping namespace ..." message to advise users to
    use the namespaced stylesheets.

  ● Robert Stayton: stripns.xsl

    need a local version of $exsl.node.set.available variable because
    this module imported many places.

  ● Mauritz Jeanson: olink.xsl

    Added /node() to the select expression that is used to compute the title text
    so that no <ttl> elements end up in the output. Closes bug #2830119.

  ● Keith Fahlgren: Makefile

    Add Icelandic

FO

The following changes have been made to the fo code since the 1.75.2 release.

  ● dleidert: pagesetup.xsl

    Remove the namespace mistakingly added with the last upload.

  ● dleidert: pagesetup.xsl

    Properly number acknowledgements page and start with page 1.

  ● Robert Stayton: table.xsl

    Fix bug 2979166 able - Attribute @rowheader not working

  ● Mauritz Jeanson: inline.xsl

    Improved glossterm auto-linking by using keys. The old code was inefficient when processing documents
    with many inline glossterms.

  ● Robert Stayton: titlepage.xsl

    Fix bug 2805530 author/orgname not appearing on title page.

  ● Mauritz Jeanson: graphics.xsl

    Added support for SVG content in imagedata (inspired by patch #2909154).

  ● Mauritz Jeanson: table.xsl

    Removed superfluous test used when computing column-width. Closes bug #3000898.

  ● Mauritz Jeanson: inline.xsl

    Added missing <xsl:call-template name="anchor"/>. Closes bug #2998567.

  ● Mauritz Jeanson: lists.xsl

    Added table-layout="fixed" on segmentedlist table (required by XSL spec when  proportional-column-width() is used).

  ● Robert Stayton: autoidx-kimber.xsl

    Change entities to use common/entities.ent.

  ● Jirka Kosek: autoidx-kosek.xsl

    Upgraded to use common entities. Fixed bug when some code used @sortas and some not for grouping/sorting of indexterms.

  ● Jirka Kosek: index.xsl

    Upgraded to use common entities. Fixed bug when some code used @sortas and some not for grouping/sorting of indexterms.

  ● Robert Stayton: xref.xsl

    Fix bug in olink template when an olink has an id.
    Add warning message with id value when trying to link
    to an element that has no generated text.

  ● Mauritz Jeanson: refentry.xsl

    Fixed bug #2930968 (indexterm in refmeta not handled correctly).

  ● Robert Stayton: block.xsl

    fix bug 2949567 title in revhistory breaks FO transform.

  ● Robert Stayton: glossary.xsl

    Output id attributes on glossdiv blocks so they can be added to
    xrefs or TOC.

  ● Jirka Kosek: xref.xsl

    Enabled hyphenation of URLs when ulink content is the same as link target

  ● Robert Stayton: table.xsl

    Apply patch to turn off row recursion if no @morerows attributes present.
    This will enable very large tables without row spanning to
    process without running into recursion limits.

  ● Robert Stayton: formal.xsl

    Format equation without title using table layout with equation number
    next to the equation.

  ● Robert Stayton: param.xweb; param.ent

    Add equation.number.properties.

HTML

The following changes have been made to the html code since the 1.75.2 release.

  ● Mauritz Jeanson: block.xsl

    Modified acknowledgements template to avoid invalid output (<p> in <p>).

  ● Mauritz Jeanson: titlepage.xsl

    Added default sidebar attribute-sets.

  ● Robert Stayton: table.xsl

    Fix bug 2979166 able - Attribute @rowheader not working

  ● Robert Stayton: footnote.xsl

    Fix bug 3033191 footnotes in html tables.

  ● Mauritz Jeanson: inline.xsl

    Improved glossterm auto-linking by using keys. The old code was inefficient when processing documents
    with many inline glossterms.

  ● Robert Stayton: docbook.css.xml; verbatim.xsl

    Fix bug 2844927 Validity error for callout bugs.

  ● Robert Stayton: formal.xsl

    Convert formal.object.heading to respect make.clean.html param.

  ● Robert Stayton: titlepage.templates.xml; block.xsl

    Fix bug 2840768 sidebar without title inserts empty b tag.

  ● Mauritz Jeanson: docbook.xsl

    Moved the template that outputs <base> so that the base URI also applies to relative CSS paths that come later.
    See patch #2896121.

  ● Robert Stayton: autoidx-kimber.xsl

    Change entities to use common/entities.ent.

  ● Jirka Kosek: autoidx-kosek.xsl

    Upgraded to use common entities. Fixed bug when some code used @sortas and some not for grouping/sorting of indexterms.

  ● Robert Stayton: chunk-code.xsl

    fix bug 2948363 generated filename for refentry not unique, when
    used in a set.

  ● Robert Stayton: component.xsl

    Fix missing "Chapter n" label when use chapter/info/title.

  ● Robert Stayton: table.xsl

    Row recursion turned off if no @morerows attributes in the table.
    This will prevent failure on long table (with no @morerows) due
    to excessive depth of recursion.

  ● Robert Stayton: autotoc.xsl; docbook.css.xml

    Support make.clean.html in autotoc.xsl.

  ● Robert Stayton: docbook.css.xml; block.xsl

    Add support for make.clean.html setting in block elements.

  ● Robert Stayton: html.xsl

    Remove debug message.

  ● Robert Stayton: docbook.css.xml

    Stock CSS styles for DocBook HTML output when 'make.clean.html' is non-zero.

  ● Robert Stayton: docbook.xsl

    Add templates for generating CSS files.

  ● Robert Stayton: html.xsl

    Add templates for generating CSS files and links to them.

  ● Robert Stayton: param.xweb

    Fix bugs in new entity references.

  ● Robert Stayton: chunk-common.xsl

    List of Equations now includes on equations with titles.

  ● Robert Stayton: param.xweb; param.ent

    Add new params for CSS file generation.

  ● Robert Stayton: table.xsl

    If a colspec has a colname attribute, add it to the HTML col
    element as a class attribute so it can be styled.

  ● Robert Stayton: inline.xsl

    Replace tabs with spaces.

  ● Robert Stayton: formal.xsl

    Fix bug 2825842 where table footnotes not appearing in HTML-coded table.

  ● Robert Stayton: chunktoc.xsl

    Fix bug #2834826 where appendix inside part was not chunked as it should be.

  ● Mauritz Jeanson: chunktoc.xsl

    Added missing namespace declarations. Closes bug #2890069.

  ● Mauritz Jeanson: footnote.xsl

    Updated the template for footnote paras to use the 'paragraph' template. Closes bug #2803739.

  ● Robert Stayton: chunker.xsl

    Add more namespace names to the exclude-result-prefixes attribute.

  ● Keith Fahlgren: inline.xsl; lists.xsl

    Remove <b> and <i> elements "discouraged in favor of style sheets" from
    XHTML, XHTML 1.1 (and therefore EPUB) outputs by changing html2xhtml.xsl.

    Fixes bug #2873153: No <b> and <i> tags in XHTML/EPUB

    Added regression to EPUB specs:

  ● Mauritz Jeanson: inline.xsl

    Fixed bug #2844916 (don't output @target if ulink.target is empty).

  ● Keith Fahlgren: autoidx.xsl

    Fix a bug when using index.on.type: an 'index symbols' section was created
    even if that typed index didn't include any symbols (they were in the other types).

Manpages

The following changes have been made to the manpages code since the 1.75.2
release.

  ● Mauritz Jeanson: other.xsl

    Modified the write.stubs template so that the section directory name is not output twice. Should fix bug #2831602.
    Also ensured that $lang is added to the .so path (when man.output.lang.in.name.enabled=1).

  ● Mauritz Jeanson: docbook.xsl; other.xsl

    Fixed bug #2412738 (apostrophe escaping) by applying the submitted patch.

  ● Mauritz Jeanson: other.xsl

    Fixed bugs related to manpages and L10n.

  ● Norman Walsh: block.xsl; endnotes.xsl

    Fix bug where simpara in footnote didn't work. Patch by Jonathan Nieder, jrnieder@gmail.com

  ● dleidert: lists.xsl

    Fix two indentation issues: In the first case there is no corresponding .RS
    macro (Debian #519438, sf.net 2793873). In the second case an .RS instead of
    the probably intended .sp leads to an indentation bug (Debian #527309,
    sf.net #2642139).

Epub

The following changes have been made to the epub code since the 1.75.2 release.

  ● Keith Fahlgren: bin/spec/examples/AMasqueOfDays.epub; docbook.xsl; bin/spec
    /epub_spec.rb

    Resolve some actual regressions in date output spotted by more recent versions of epubcheck

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb; bin/spec/spec_helper.rb;
    bin/spec/READM⋯

    Working toward getting the automated test suite working in Windows

  ● Keith Fahlgren: bin/spec/README

    Updates to install instructions

  ● Keith Fahlgren: bin/spec/README

    Trying to make the testing environment runnable on Windows machines

  ● Keith Fahlgren: docbook.xsl

    Updated mediaobject selection code that better uses roles (when available); based on contributons by  Glenn McDonald

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb; docbook.xsl

    Ensure that NCX documents are always outputted with a default namespace
    to prevent problems with the kindlegen machinery

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb; bin/spec/files/
    partintro.xml; docbook.x⋯

    Adding support for partintros with sect2s, 3s, etc

  ● Keith Fahlgren: docbook.xsl

    Adding param to workaround horrific ADE bug with the inability to process <br>

  ● Keith Fahlgren: docbook.xsl

    Add support for authorgroup/author in OPF metadata (via Michael Wiedmann)

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb

    Remove <b> and <i> elements "discouraged in favor of style sheets" from
    XHTML, XHTML 1.1 (and therefore EPUB) outputs by changing html2xhtml.xsl.

    Fixes bug #2873153: No <b> and <i> tags in XHTML/EPUB

    Added regression to EPUB specs:

  ● Keith Fahlgren: bin/lib/docbook.rb; bin/spec/files/DejaVuSerif-Italic.otf;
    docbook.xsl; bi⋯

    This resolves bug #2873142, Please add support for multiple embedded fonts


    If you navigate to a checkout of DocBook-XSL and go to:
    xsl/epub/bin/spec/files
    You can now run the following command:

    ../../dbtoepub -f DejaVuSerif.otf -f DejaVuSerif-Italic.otf -c test.css
    -s test_cust.xsl orm.book.001.xml

    In dbtoepub, the following option can be used more than once:
    -f, --font [OTF FILE] Embed OTF FILE in .epub.

    The underlying stylesheet now accepts a comma-separated list of font file
    names rather than just one as the RENAMED epub.embedded.fonts ('s' added).

    The runnable EPUB spec now includes:
    - should be valid .epub after including more than one embedded font

  ● Keith Fahlgren: docbook.xsl

    Improve the selection of cover images when working in DocBook 4.x land (work in progress)

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb; docbook.xsl

    Improve the quality of the OPF spine regression by ensuring that the spine
    elements for deeply nested refentries are in order and adjacent to their
    opening wrapper XHTML chunk.

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb; docbook.xsl; bin/spec/
    files/orm.book.00⋯

    Add more careful handling of refentries to ensure that they always appear in the opf:spine.
    This was only a problem when refentries were pushed deep into the hierarchy (like inside
    a sect2), but presented navigational problems for many reading systems (despite the
    correct NCX references). This may *not* be the best solution, but attacking a better
    chunking strategy for refentries was too big a nut to crack at this time.

  ● Keith Fahlgren: bin/spec/epub_regressions_spec.rb; bin/spec/files/
    test_cust.xsl; bin/spec/⋯

    Fix a bug when using index.on.type: an 'index symbols' section was created
    even if that typed index didn't include any symbols (they were in the other types).

Eclipse

The following changes have been made to the eclipse code since the 1.75.2
release.

  ● Mauritz Jeanson: eclipse3.xsl

    Added SVN keywords.

  ● Mauritz Jeanson: eclipse3.xsl

    Added a stylesheet module that generates plug-ins conforming to the standard (OSGi-based) Eclipse 3.x
    architecture. The main difference to the older format is that metadata is stored in a separate
    manifest file. The module imports and extends the existing eclipse.xsl module. Based on code
    contributed in patch #2624668.

Params

The following changes have been made to the params code since the 1.75.2
release.

  ● Mauritz Jeanson: docbook.css.link.xml

    Changed default value from 0 to 1.

  ● Robert Stayton: draft.watermark.image.xml

    Fix bug 2922488 draft.watermark.image pointing to web resource.
    Now the value is images/draft.png, and may require customization
    for local resolution.

  ● Mauritz Jeanson: callouts.extension.xml

    Removed camel casing.

  ● Mauritz Jeanson: tex.math.in.alt.xml; tex.math.delims.xml

    Removed obsolete "More information" section referring to DBTeXMath and PassiveTeX.

  ● Mauritz Jeanson: default.image.width.xml

    Changed link to point to DB 5 TDG.

  ● Mauritz Jeanson: equation.number.properties.xml

    Corrected refpurpose.

  ● Mauritz Jeanson: generate.css.header.xml; custom.css.source.xml

    Typo fixing.

  ● Mauritz Jeanson: make.clean.html.xml

    Fixed typo.

  ● Mauritz Jeanson: custom.css.source.xml

    Fixed typo.

  ● Mauritz Jeanson: toc.line.properties.xml

    Added missing xsl:choose in example.

  ● Norman Walsh: paper.type.xml

    Added USlegal and USlegallandscape paper types.

  ● Robert Stayton: custom.css.source.xml

    Make the default value blank, as it is documented.

  ● Jirka Kosek: highlight.xslthl.config.xml

    Added note about specifying location as URL

  ● Robert Stayton: docbook.css.source.xml; generate.css.header.xml;
    custom.css.source.xml; ma⋯

    Params to support generated CSS files.

  ● Robert Stayton: equation.number.properties.xml

    New attribute set for numbers appearing next to equations.

  ● Mauritz Jeanson: htmlhelp.hhc.folders.instead.books.xml

    Small corrections.

XSL-Xalan

The following changes have been made to the xsl-xalan code since the 1.75.2
release.

  ● dleidert: nbproject/genfiles.properties; nbproject/build-impl.xml

    Rebuild netbeans build files after adding missing Netbeans configuration to allow easier packaging for Debian.

